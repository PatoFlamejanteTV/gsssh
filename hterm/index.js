import{lib as e}from"../libdot/index.js";const t={windowType:null,initWindowType_:async function(){if(globalThis.chrome?.tabs?.getCurrent){const e=await new Promise((e=>{chrome.tabs.getCurrent(e)}));if(e&&globalThis.chrome?.windows?.get){const r=await new Promise((t=>{chrome.windows.get(e.windowId,null,t)}));t.windowType=r.type}else t.windowType="normal"}else t.windowType="normal"},os:null,initOs_:function(){const r=e=>{t.os=e};return e.f.getOs().then(r).catch(r)},desktopNotificationTitle:"♪ %(title) ♪",messageManager:null,init_:async function(){return await t.initWindowType_(),await t.initOs_(),e.i18n.getAcceptLanguages().then((r=>{t.messageManager||(t.messageManager=new e.MessageManager(r))}))}};t.initPromise=t.init_(),t.sanitizeHtml=function(e){return globalThis.trustedTypes?.createPolicy?(t.sanitizeHtml.policy||(t.sanitizeHtml.policy=trustedTypes.createPolicy("default",{createHTML:e=>e})),t.sanitizeHtml.policy.createHTML(e)):e},t.copySelectionToClipboard=function(e,t){const r=()=>{const r=e.createElement("pre");r.id="hterm:copy-to-clipboard-source",r.textContent=t,r.style.cssText="user-select: text;position: absolute;top: -99px",e.body.appendChild(r);const o=e.getSelection(),s=o.anchorNode,i=o.anchorOffset,n=o.focusNode,a=o.focusOffset;try{o.selectAllChildren(r)}catch(e){}try{e.execCommand("copy")}catch(e){}return o.extend&&(s&&o.collapse(s,i),n&&o.extend(n,a)),r.remove(),Promise.resolve()};return(navigator.permissions&&navigator.permissions.query?navigator.permissions.query({name:"clipboard-write"}).then((e=>{const t=(r,o)=>{switch(e.state){case"granted":return r();case"denied":return o();default:return new Promise(((r,o)=>{e.onchange=()=>t(r,o)}))}};return new Promise(t)})).catch((()=>Promise.resolve())):Promise.resolve()).then((()=>navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).catch(r):r()))},t.msg=function(e,r=[],o=""){return t.messageManager.get("HTERM_"+e,r,o)},t.notify=function(r){const o=(e,t)=>void 0!==e?e:t;null==r&&(r={});const s={body:r.body,icon:o(r.icon,e.resource.getDataUrl("hterm/images/icon-96"))};let i=o(r.title,globalThis.document.title);i||(i="hterm"),i=e.f.replaceVars(t.desktopNotificationTitle,{title:i});const n=new Notification(i,s);return n.onclick=function(){globalThis.focus(),n.close()},n},t.openUrl=function(t){if(globalThis.chrome?.browser?.openTab)chrome.browser.openTab({url:t});else{const r=e.f.openWindow(t,"_blank");r&&r.focus()}},t.Size=class{constructor(e,t){this.width=e,this.height=t}resize(e,t){this.width=e,this.height=t}clone(){return new this.constructor(this.width,this.height)}setTo(e){this.width=e.width,this.height=e.height}equals(e){return this.width==e.width&&this.height==e.height}toString(){return`[hterm.Size: ${this.width}, ${this.height}]`}},t.RowCol=class{constructor(e,t,r=!1){this.row=e,this.column=t,this.overflow=!!r}move(e,t,r=!1){this.row=e,this.column=t,this.overflow=!!r}clone(){return new this.constructor(this.row,this.column,this.overflow)}setTo(e){this.row=e.row,this.column=e.column,this.overflow=e.overflow}equals(e){return this.row==e.row&&this.column==e.column&&this.overflow==e.overflow}toString(){return`[hterm.RowCol: ${this.row}, ${this.column}, ${this.overflow}]`}};const r="Tue, 28 Jan 2025 07:42:19 -0800";function o(t,r){const o=r.match(/^data:([^,]+),(.*)$/);e.resource.add(t,...o.slice(1))}function s(t,r){e.resource.add(t,"text/html;utf8",r)}function i(t,r){e.resource.add(t,"image/svg+xml;utf8",r)}o("hterm/audio/bell","data:audio/ogg;base64,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"),i("hterm/images/copy",'<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 48 48" fill="currentColor">\n  <path d="M32 2H8C5.79 2 4 3.79 4 6v28h4V6h24V2zm6 8H16c-2.21 0-4 1.79-4 4v28c0 2.21 1.79 4 4 4h22c2.21 0 4-1.79 4-4V14c0-2.21-1.79-4-4-4zm0 32H16V14h22v28z"/>\n</svg>\n'),i("hterm/images/close",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>\n</svg>\n'),i("hterm/images/keyboard_arrow_down",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path d="M7.41 7.84L12 12.42l4.59-4.58L18 9.25l-6 6-6-6z"/>\n</svg>\n'),i("hterm/images/keyboard_arrow_up",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>\n</svg>\n'),s("hterm/html/find_bar","<meta charset='utf-8'/>\n<style>\n:root {\n  --hterm-grey-200-rgb: 232, 234, 237;  /* #e8eaed */\n  --hterm-grey-200: rgb(var(--hterm-grey-200-rgb));\n  --hterm-grey-400-rgb: 189, 193, 198;  /* #bdc1c6 */\n  --hterm-grey-400: rgb(var(--hterm-grey-400-rgb));\n  --hterm-grey-600-rgb: 128, 134, 139;  /* #80868b */\n  --hterm-grey-600: rgb(var(--hterm-grey-600-rgb));\n  --hterm-grey-800-rgb: 60, 64, 67;  /* #3c4043 */\n  --hterm-grey-800: rgb(var(--hterm-grey-800-rgb));\n}\n\n#hterm\\:find-bar {\n  align-items: center;\n  background: white;\n  border: 1px solid var(--hterm-grey-600);\n  border-radius: 2px;\n  box-shadow: 0 2px 2px 1px rgba(var(--hterm-grey-600-rgb), .1);\n  display: none;\n  font-family: sans-serif;\n  padding: 5px 15px;\n  position: fixed;\n  right: 16px;\n  top : 0;\n  z-index: 1;\n}\n#hterm\\:find-bar.enabled {\n  display: flex;\n}\n#hterm\\:find-bar > input {\n  border: 0;\n  margin: 8px 0;\n  outline: none;\n  width: 200px;\n}\n#hterm\\:find-bar-vertical-separator {\n  align-self: stretch;\n  border-left: 1px solid var(--hterm-grey-400);\n  margin-left: 10px;\n}\n#hterm\\:find-bar > .button {\n  align-items: center;\n  border-radius: 50%;\n  cursor: var(--hterm-mouse-cursor-pointer);\n  display: flex;\n  height: 24px;\n  justify-content: center;\n  margin-left: 8px;\n  transition: background-color 0.3s linear;\n  width: 24px;\n}\n#hterm\\:find-bar > .button.enabled:hover {\n  background-color: var(--hterm-grey-200);\n}\n#hterm\\:find-bar > .button.enabled:active {\n  background-color: var(--hterm-grey-400);\n  transition: background-color 0s;\n}\n#hterm\\:find-bar > .button.enabled > svg {\n  fill: var(--hterm-grey-800);\n}\n#hterm\\:find-bar > .button > svg {\n  height: 20px;\n  fill: var(--hterm-grey-400);\n  width: 20px;\n}\n#hterm\\:find-bar-count {\n  color: var(--hterm-grey-600);\n}\n</style>\n<input type='text'>\n<div id='hterm:find-bar-count'>0/0</div>\n<div id='hterm:find-bar-vertical-separator' tabindex='-1'></div>\n<div id='hterm:find-bar-up' class='button' role='button'></div>\n<div id='hterm:find-bar-down' class='button' role='button'></div>\n<div id='hterm:find-bar-close' class='button enabled' role='button'></div>\n"),s("hterm/html/find_screen","<meta charset='utf-8'/>\n<style>\n#hterm\\:find-result-screen {\n  height: 100%;\n  left: var(--hterm-screen-padding-size);\n  pointer-events: none;\n  position: absolute;\n  top: var(--hterm-screen-padding-size);\n  width: 100%;\n}\n#hterm\\:find-result-screen > find-row {\n  display: block;\n  height: var(--hterm-charsize-height);\n  line-height: var(--hterm-charsize-height);\n}\n#hterm\\:find-result-screen > find-row > .find-highlighter {\n  background-color: var(--hterm-find-result-color);\n  height: var(--hterm-charsize-height);\n  position: absolute;\n}\n#hterm\\:find-result-screen > find-row > .find-highlighter.selected {\n  background-color: var(--hterm-find-result-selected-color);\n}\n</style>\n"),o("hterm/images/icon-96","data:image/png;base64,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"),e.resource.add("hterm/concat/date","text/plain",r),e.resource.add("hterm/changelog/version","text/plain","1.92.1-HEAD+ge86519c"),e.resource.add("hterm/changelog/date","text/plain",r),e.resource.add("hterm/git/HEAD","text/plain","e86519c38860dd1715e7b4ba68653bf34638a93c"),t.AccessibilityReader=function(e){this.document_=e.ownerDocument;const t=this.document_.createElement("div");t.id="hterm:accessibility-live-region",t.style.cssText="position: absolute;\n                              width: 0; height: 0;\n                              overflow: hidden;\n                              left: -1000px; top: -1000px;",e.appendChild(t),this.accessibilityEnabled=!1,this.liveElement_=this.document_.createElement("p"),this.liveElement_.setAttribute("aria-live","polite"),t.appendChild(this.liveElement_),this.assertiveLiveElement_=this.document_.createElement("p"),this.assertiveLiveElement_.setAttribute("aria-live","assertive"),t.appendChild(this.assertiveLiveElement_),this.queue_=[],this.nextReadTimer_=null,this.cursorIsChanging_=!1,this.cursorChangeQueue_=[],this.lastCursorRowString_=null,this.lastCursorRow_=null,this.lastCursorColumn_=null,this.hasUserGesture=!1},t.AccessibilityReader.DELAY=50,t.AccessibilityReader.prototype.setAccessibilityEnabled=function(e){e||this.clear(),this.accessibilityEnabled=e},t.AccessibilityReader.prototype.decorate=function(e){["keydown","keypress","keyup","textInput"].forEach((t=>{e.addEventListener(t,(()=>{this.hasUserGesture=!0}))}))},t.AccessibilityReader.prototype.beforeCursorChange=function(e,t,r){this.accessibilityEnabled&&this.hasUserGesture&&!this.cursorIsChanging_&&(this.cursorIsChanging_=!0,this.lastCursorRowString_=e,this.lastCursorRow_=t,this.lastCursorColumn_=r)},t.AccessibilityReader.prototype.afterCursorChange=function(e,t,r){if(this.cursorIsChanging_){if(this.cursorIsChanging_=!1,!this.announceAction_(e,t,r))for(let e=0;e<this.cursorChangeQueue_.length;++e)this.announce(this.cursorChangeQueue_[e]);this.cursorChangeQueue_=[],this.lastCursorRowString_=null,this.lastCursorRow_=null,this.lastCursorColumn_=null,this.hasUserGesture=!1}},t.AccessibilityReader.prototype.announce=function(e){if(this.accessibilityEnabled)if(this.cursorIsChanging_)this.cursorChangeQueue_.push(e);else if("\n"==e&&this.queue_.length>0)this.queue_.push("");else{if(0==this.queue_.length)this.queue_.push(e);else{let t="";0!=this.queue_[this.queue_.length-1].length&&(t=" "),this.queue_[this.queue_.length-1]+=t+e}if(!this.nextReadTimer_){if(1!=this.queue_.length)throw new Error("Expected only one item in queue_ or nextReadTimer_ to be running.");this.nextReadTimer_=setTimeout(this.addToLiveRegion_.bind(this),t.AccessibilityReader.DELAY)}}},t.AccessibilityReader.prototype.assertiveAnnounce=function(e){this.hasUserGesture&&" "==e&&(e=t.msg("SPACE_CHARACTER",[],"Space")),(e=e.trim())==this.assertiveLiveElement_.innerText&&(e="\n"+e),this.clear(),this.assertiveLiveElement_.innerText=e},t.AccessibilityReader.prototype.newLine=function(){this.announce("\n")},t.AccessibilityReader.prototype.clear=function(){this.liveElement_.innerText="",this.assertiveLiveElement_.innerText="",clearTimeout(this.nextReadTimer_),this.nextReadTimer_=null,this.queue_=[],this.cursorIsChanging_=!1,this.cursorChangeQueue_=[],this.lastCursorRowString_=null,this.lastCursorRow_=null,this.lastCursorColumn_=null,this.hasUserGesture=!1},t.AccessibilityReader.prototype.announceAction_=function(r,o,s){if(this.lastCursorRow_!=o)return!1;if(e.notNull(this.lastCursorRowString_)===r){if(e.notNull(this.lastCursorColumn_)!==s&&""==this.cursorChangeQueue_.join("").trim()){const e=Math.min(this.lastCursorColumn_,s),r=Math.abs(s-this.lastCursorColumn_);return this.assertiveAnnounce(t.wc.substr(this.lastCursorRowString_,e,r)),!0}return!1}if(this.lastCursorRowString_!=r){if(this.lastCursorColumn_+1==s&&" "==t.wc.substr(r,s-1,1)&&this.cursorChangeQueue_.length>0&&" "==this.cursorChangeQueue_[0])return this.assertiveAnnounce(" "),!0;const e=s;if(t.wc.strWidth(r)<=t.wc.strWidth(this.lastCursorRowString_)&&t.wc.substr(this.lastCursorRowString_,0,e)==t.wc.substr(r,0,e)){let o=t.wc.strWidth(r);for(;o>0&&(o!=e&&" "==t.wc.substr(r,o-1,1));--o);const s=t.wc.strWidth(this.lastCursorRowString_)-o,i=o-e;if(t.wc.substr(this.lastCursorRowString_,e+s,i)==t.wc.substr(r,e,i)){const r=t.wc.substr(this.lastCursorRowString_,e,s);if(""!=r)return this.assertiveAnnounce(r),!0}}return!1}return!1},t.AccessibilityReader.prototype.addToLiveRegion_=function(){this.nextReadTimer_=null;let e=this.queue_.join("\n").trim();e==this.liveElement_.innerText&&(e="\n"+e),this.liveElement_.innerText=e,this.queue_=[]},t.ContextMenu=function(){this.document_=null,this.element_=null,this.menu_=[]},t.ContextMenu.Item,t.ContextMenu.SEPARATOR=Symbol("-"),t.ContextMenu.prototype.setDocument=function(e){this.element_&&(this.element_.remove(),this.element_=null),this.document_=e,this.regenerate_(),this.document_.body.appendChild(this.element_)},t.ContextMenu.prototype.regenerate_=function(){for(this.element_?this.hide():(this.element_=this.document_.createElement("menu"),this.element_.id="hterm:context-menu");this.element_.firstChild;)this.element_.removeChild(this.element_.firstChild);this.menu_.forEach((({name:e,action:r})=>{const o=this.document_.createElement("menuitem");e===t.ContextMenu.SEPARATOR?(o.innerHTML=t.sanitizeHtml("<hr>"),o.className="separator"):(o.innerText=e,o.addEventListener("mousedown",(function(e){e.preventDefault(),r(e)}))),this.element_.appendChild(o)}))},t.ContextMenu.prototype.setItems=function(e){this.menu_=e,this.regenerate_()},t.ContextMenu.prototype.show=function(e,t){if(0==this.menu_.length)return;t&&(this.element_.style.fontSize=t.getFontSize(),this.element_.style.fontFamily=t.getFontFamily()),this.element_.style.top=`${e.clientY}px`,this.element_.style.left=`${e.clientX}px`;const r=this.document_.body.getBoundingClientRect();this.element_.style.display="block";const o=this.element_.getBoundingClientRect(),s=Math.max(0,r.height-o.height),i=Math.max(0,r.width-o.width);s<e.clientY&&(this.element_.style.top=`${s}px`),i<e.clientX&&(this.element_.style.left=`${i}px`)},t.ContextMenu.prototype.hide=function(){this.element_&&(this.element_.style.display="none")},t.FindBar=function(e){this.terminal_=e,this.scrollPort_=e.getScrollPort(),this.findBar_=null,this.input_=null,this.hasFocus=!1,this.upArrowButton_=null,this.downArrowButton_=null,this.closeButton_=null,this.counterLabel_=null,this.results_={},this.pendingFind_=null,this.pendingRedraw_=null,this.pendingNotifyChanges_=null,this.changedRows_=new Set,this.searchText_="",this.batchRow_=0,this.batchNum_=0,this.batchCallbacksForTest_={},this.batchSize=500,this.isVisible=!1,this.visibleRows_=[],this.onScroll_=this.scheduleRedraw_.bind(this),this.selectedRowNum_=0,this.selectedRowIndex_=0,this.selectedOrdinal_=-1,this.resultCount_=0,this.selectedResult_=null,this.matchingRowsIndex_=[],this.selectedResultKnown_=!0},t.FindBar.RowResult,t.FindBar.Result,t.FindBar.prototype.decorate=function(r){this.findBar_=r.createElement("div"),this.findBar_.id="hterm:find-bar",this.findBar_.setAttribute("aria-hidden","true"),this.findBar_.innerHTML=t.sanitizeHtml(e.resource.getText("hterm/html/find_bar")),this.input_=this.findBar_.querySelector("input"),this.upArrowButton_=this.findBar_.querySelector("#hterm\\:find-bar-up"),this.downArrowButton_=this.findBar_.querySelector("#hterm\\:find-bar-down"),this.closeButton_=this.findBar_.querySelector("#hterm\\:find-bar-close"),this.counterLabel_=this.findBar_.querySelector("#hterm\\:find-bar-count"),this.upArrowButton_.innerHTML=t.sanitizeHtml(e.resource.getText("hterm/images/keyboard_arrow_up")),this.downArrowButton_.innerHTML=t.sanitizeHtml(e.resource.getText("hterm/images/keyboard_arrow_down")),this.closeButton_.innerHTML=t.sanitizeHtml(e.resource.getText("hterm/images/close")),this.upArrowButton_.setAttribute("aria-label",t.msg("BUTTON_PREVIOUS")),this.downArrowButton_.setAttribute("aria-label",t.msg("BUTTON_NEXT")),this.input_.setAttribute("aria-label",t.msg("BUTTON_FIND")),this.closeButton_.setAttribute("aria-label",t.msg("BUTTON_CLOSE"));const o=e=>e.bind(this);this.input_.addEventListener("input",o(this.onInput_)),this.input_.addEventListener("keydown",o(this.onKeyDown_)),this.input_.addEventListener("keypress",o(this.onKeyPressed_)),this.input_.addEventListener("textInput",o(this.onInputText_)),this.input_.addEventListener("focus",o((()=>{this.hasFocus=!0}))),this.input_.addEventListener("blur",o((()=>{this.hasFocus=!1}))),this.closeButton_.addEventListener("click",o(this.close)),this.upArrowButton_.addEventListener("click",o(this.onPrevious_)),this.downArrowButton_.addEventListener("click",o(this.onNext_)),r.body.appendChild(this.findBar_),this.resultScreen_=r.createElement("div"),this.resultScreen_.id="hterm:find-result-screen",this.resultScreen_.innerHTML=t.sanitizeHtml(e.resource.getText("hterm/html/find_screen")),this.resultScreen_.style.display="none",r.body.appendChild(this.resultScreen_)},t.FindBar.prototype.display=function(){this.scrollPort_.subscribe("scroll",this.onScroll_),this.findBar_.classList.add("enabled"),this.findBar_.removeAttribute("aria-hidden"),this.input_.focus(),this.resultScreen_.style.display="",this.isVisible=!0,this.input_.dispatchEvent(new Event("input"))},t.FindBar.prototype.close=function(){this.resultScreen_.style.display="none",this.scrollPort_.unsubscribe("scroll",this.onScroll_),this.findBar_.classList.remove("enabled"),this.findBar_.setAttribute("aria-hidden","true"),this.terminal_.focus(),this.isVisible=!1,this.stopSearch(),this.results_={},this.resultCount_=0},t.FindBar.prototype.stopSearch=function(){null!==this.pendingFind_&&(clearTimeout(this.pendingFind_),this.pendingFind_=null),this.runBatchCallbackForTest_(0)},t.FindBar.prototype.syncResults_=function(){if(this.batchRow_=0,this.batchNum_=0,this.results_={},this.resultCount_=0,this.matchingRowsIndex_.length=0,this.redraw_(),this.updateCounterLabel_(),!this.searchText_)return;const e=this.terminal_.getRowCount(),t=()=>{const r=Math.min(this.batchRow_+this.batchSize,e);for(;this.batchRow_<r;)this.findInRow_(this.batchRow_)&&this.matchingRowsIndex_.push(this.batchRow_),this.batchRow_++;this.batchRow_<e?this.pendingFind_=setTimeout(t):this.stopSearch(),++this.batchNum_,this.runBatchCallbackForTest_(this.batchNum_),this.updateCounterLabel_()};t()},t.FindBar.prototype.findInRow_=function(e,t=!1){if(!this.searchText_)return!1;const r=this.results_[e];if(r&&!t)return!0;const o=this.terminal_.getRowText(e).toLowerCase(),s=[];let i,n=0;for(;-1!=(i=o.indexOf(this.searchText_,n));)s.push({index:i,highlighter:null}),n=i+this.searchText_.length;s.length?(this.results_[e]={findRow:null,rowResult:s},0===this.resultCount_&&(this.selectedRowNum_=e,this.selectedOrdinal_=0,this.upArrowButton_.classList.add("enabled"),this.downArrowButton_.classList.add("enabled"),this.scrollToResult_())):delete this.results_[e];const a=s.length-(r?r.rowResult.length:0);return this.resultCount_+=a,e<this.selectedRowNum_&&(this.selectedOrdinal_+=a),s.length>0},t.FindBar.prototype.onInput_=function(e){this.searchText_=e.target.value.toLowerCase(),clearTimeout(this.pendingFind_),this.pendingFind_=setTimeout((()=>this.syncResults_()))},t.FindBar.prototype.onKeyPressed_=function(e){e.stopPropagation()},t.FindBar.prototype.onInputText_=function(e){e.stopPropagation()},t.FindBar.prototype.onKeyDown_=function(e){e.metaKey||e.altKey||("Escape"==e.key&&this.close(),"Enter"==e.key&&(e.shiftKey?this.onPrevious_():this.onNext_()),e.ctrlKey&&71==e.keyCode&&(e.shiftKey?this.onPrevious_():this.onNext_(),e.preventDefault()),e.ctrlKey&&70==e.keyCode&&e.preventDefault()),e.stopPropagation()},t.FindBar.prototype.setFindResultColor=function(e){void 0===e&&(e=this.terminal_.getPrefs().getString("find-result-color")),this.terminal_.setCssVar("find-result-color",e)},t.FindBar.prototype.setFindResultSelectedColor=function(e=void 0){void 0===e&&(e=this.terminal_.getPrefs().getString("find-result-selected-color")),this.terminal_.setCssVar("find-result-selected-color",e)},t.FindBar.prototype.setBatchCallbackForTest=function(e,t){this.batchCallbacksForTest_[e]=t},t.FindBar.prototype.redraw_=function(){const e=this.scrollPort_.getTopRowIndex(),t=this.scrollPort_.getBottomRowIndex(e);this.visibleRows_.forEach((e=>{e.remove()})),this.visibleRows_=[];for(let r=e;r<=t;r++){const e=this.fetchRowNode_(r);this.resultScreen_.appendChild(e),this.visibleRows_.push(e)}delete this.pendingRedraw_,this.highlightSelectedResult_()},t.FindBar.prototype.fetchRowNode_=function(e){e>=this.batchRow_&&this.findInRow_(e);const t=this.results_[e];if(t&&t.findRow)return t.findRow;const r=this.terminal_.getDocument().createElement("find-row");return t?(t.rowResult.forEach((e=>{const t=this.terminal_.getDocument().createElement("div");t.classList.add("find-highlighter"),t.style.left=`calc(var(--hterm-charsize-width) * ${e.index})`,t.style.width=`calc(var(--hterm-charsize-width) * ${this.searchText_.length})`,e.highlighter=t,r.appendChild(t)})),t.findRow=r):r},t.FindBar.prototype.scheduleRedraw_=function(){this.pendingRedraw_||(this.pendingRedraw_=setTimeout((()=>{this.redraw_()})))},t.FindBar.prototype.runBatchCallbackForTest_=function(e){const t=this.batchCallbacksForTest_[e];t&&(t(),delete this.batchCallbacksForTest_[e])},t.FindBar.prototype.updateCounterLabel_=function(){0===this.resultCount_&&(this.selectedRowNum_=0,this.selectedRowIndex_=0,this.selectedOrdinal_=-1,this.selectedResultKnown_=!0,this.upArrowButton_.classList.remove("enabled"),this.downArrowButton_.classList.remove("enabled")),this.selectedResultKnown_?this.counterLabel_.textContent=t.msg("FIND_COUNTER_LABEL",[this.selectedOrdinal_+1,this.resultCount_]):this.counterLabel_.textContent=t.msg("FIND_RESULT_COUNT",[this.resultCount_]),this.highlightSelectedResult_()},t.FindBar.indexOf=function(e,t){let r=-1,o=0,s=e.length-1;for(;o<=s;){const i=Math.floor((o+s)/2);e[i]<=t?(r=i,o=i+1):s=i-1}return r},t.FindBar.prototype.canUseMatchingRowsIndex_=function(e){const t=this.scrollPort_.getTopRowIndex(),r=this.scrollPort_.getBottomRowIndex(t),o=this.matchingRowsIndex_,s=this.selectedRowNum_;return this.batchRow_>r||e>0&&s<o[o.length-1]||e<0&&s<this.batchRow_&&s>o[0]},t.FindBar.prototype.selectNext_=function(e){const r=(e,t,r)=>(e+t+r)%r,o=(t,r)=>e>0?t:r,s=this.results_[this.selectedRowNum_];if(s&&void 0!==s.rowResult[this.selectedRowIndex_+e])this.selectedRowIndex_+=e;else{let s=this.scrollPort_.getTopRowIndex();const i=this.scrollPort_.getBottomRowIndex(s),n=this.matchingRowsIndex_,a=this.selectedRowNum_;if(this.canUseMatchingRowsIndex_(e)){let o=t.FindBar.indexOf(n,a);!this.selectedResultKnown_&&e<0&&o++,this.selectedRowNum_=n[r(o,e,n.length)]}else{let t=a+e;s=Math.max(s,this.batchRow_),(a<s||a>i)&&(t=o(s,i));const r=o(i+1,s-1);n.length>0&&(this.selectedRowNum_=n[o(0,n.length-1)]);for(let o=t;o!=r;o+=e)if(this.results_[o]){this.selectedRowNum_=o;break}}const l=this.results_[this.selectedRowNum_];this.selectedRowIndex_=o(0,l.rowResult.length-1)}const i=!this.selectedResultKnown_&&e>0?0:e;this.selectedOrdinal_=r(this.selectedOrdinal_,i,this.resultCount_),this.selectedResultKnown_=!0,this.scrollToResult_(),this.updateCounterLabel_()},t.FindBar.prototype.onNext_=function(){this.downArrowButton_.classList.contains("enabled")&&this.selectNext_(1)},t.FindBar.prototype.onPrevious_=function(){this.upArrowButton_.classList.contains("enabled")&&this.selectNext_(-1)},t.FindBar.prototype.scrollToResult_=function(){const e=this.scrollPort_.getTopRowIndex(),t=this.scrollPort_.getBottomRowIndex(e);(this.selectedRowNum_<e||this.selectedRowNum_>t)&&this.scrollPort_.scrollRowToMiddle(this.selectedRowNum_)},t.FindBar.prototype.highlightSelectedResult_=function(){this.selectedResult_&&(this.selectedResult_.classList.remove("selected"),this.selectedResult_=null),this.resultCount_&&this.selectedResultKnown_&&(this.selectedResult_=this.results_[this.selectedRowNum_].rowResult[this.selectedRowIndex_].highlighter,this.selectedResult_&&this.selectedResult_.classList.add("selected"))},t.FindBar.prototype.scheduleNotifyChanges=function(e){this.isVisible&&(this.changedRows_.add(e),this.pendingNotifyChanges_||(this.pendingNotifyChanges_=setTimeout((()=>{this.notifyChanges_()}))))},t.FindBar.prototype.notifyChanges_=function(){this.changedRows_.forEach((e=>{e+=this.scrollPort_.getTopRowIndex();const r=this.results_[e],o=this.findInRow_(e,!0);if(this.selectedRowNum_==e&&(this.selectedOrdinal_-=this.selectedRowIndex_,this.selectedRowIndex_=0,this.selectedResultKnown_=o),!!r!==o){const r=t.FindBar.indexOf(this.matchingRowsIndex_,e);o?this.matchingRowsIndex_.splice(r+1,0,e):this.matchingRowsIndex_.splice(r,1)}})),this.updateCounterLabel_(),this.redraw_(),this.changedRows_.clear(),delete this.pendingNotifyChanges_},t.Keyboard=function(e){this.terminal=e,this.keyboardElement_=null,this.handlers_=[["focusout",this.onFocusOut_.bind(this)],["keydown",this.onKeyDown_.bind(this)],["keypress",this.onKeyPress_.bind(this)],["keyup",this.onKeyUp_.bind(this)],["textInput",this.onTextInput_.bind(this)]],this.keyMap=new t.Keyboard.KeyMap(this),this.bindings=new t.Keyboard.Bindings,this.altGrMode="none",this.shiftInsertPaste=!0,this.homeKeysScroll=!1,this.pageKeysScroll=!1,this.ctrlPlusMinusZeroZoom=!0,this.ctrlCCopy=!1,this.ctrlVPaste=!1,this.applicationKeypad=!1,this.applicationCursor=!1,this.backspaceSendsBackspace=!1,this.metaSendsEscape=!0,this.passMetaV=!0,this.altSendsWhat="escape",this.altIsMeta=!1,this.altBackspaceIsMetaBackspace=!1,this.altKeyPressed=0,this.mediaKeysAreFKeys=!1,this.previousAltSendsWhat_=null},t.Keyboard.KeyActions={CANCEL:Symbol("CANCEL"),DEFAULT:Symbol("DEFAULT"),PASS:Symbol("PASS"),STRIP:Symbol("STRIP")},t.Keyboard.KeyAction,t.Keyboard.prototype.installKeyboard=function(e){if(e!=this.keyboardElement_){e&&this.keyboardElement_&&this.installKeyboard(null);for(let t=0;t<this.handlers_.length;t++){const r=this.handlers_[t];e?e.addEventListener(r[0],r[1]):this.keyboardElement_.removeEventListener(r[0],r[1])}this.keyboardElement_=e}},t.Keyboard.prototype.uninstallKeyboard=function(){this.installKeyboard(null)},t.Keyboard.prototype.onTextInput_=function(e){e.data&&this.terminal.onVTKeystroke(e.data)},t.Keyboard.prototype.onKeyPress_=function(e){const t=String.fromCharCode(e.which).toLowerCase();if((e.ctrlKey||e.metaKey)&&("c"==t||"v"==t))return;if(9==e.keyCode)return;let r;e.altKey&&"browser-key"==this.altSendsWhat&&0==e.charCode?(r=String.fromCharCode(e.keyCode),e.shiftKey||(r=r.toLowerCase())):e.charCode>=32&&(r=String.fromCharCode(e.charCode)),r&&this.terminal.onVTKeystroke(r),e.preventDefault(),e.stopPropagation()},t.Keyboard.prototype.onFocusOut_=function(e){this.altKeyPressed=0},t.Keyboard.prototype.onKeyUp_=function(e){18==e.keyCode&&(this.altKeyPressed=this.altKeyPressed&~(1<<e.location-1))},t.Keyboard.prototype.onKeyDown_=function(e){18==e.keyCode&&(this.altKeyPressed=this.altKeyPressed|1<<e.location-1);let r=this.keyMap.keyDefs[e.keyCode];r||(console.warn(`No definition for key ${e.key} (keyCode ${e.keyCode})`),r=this.keyMap.keyDefs[0],this.keyMap.addKeyDef(e.keyCode,r));let o=null;const s=t=>{o=t;let i=r[t];return"function"==typeof i&&(i=i.call(this.keyMap,e,r)),i===n&&"normal"!=t&&(i=s("normal")),i},i=t.Keyboard.KeyActions.CANCEL,n=t.Keyboard.KeyActions.DEFAULT,a=t.Keyboard.KeyActions.PASS,l=t.Keyboard.KeyActions.STRIP;let c=e.ctrlKey,h=e.shiftKey,u=!this.altIsMeta&&e.altKey,d=this.altIsMeta&&e.altKey||e.metaKey;const p=!/^\[\w+\]$/.test(r.keyCap);switch(this.altGrMode){case"ctrl-alt":p&&c&&u&&(c=!1,u=!1);break;case"right-alt":p&&2&this.terminal.keyboard.altKeyPressed&&(c=!1,u=!1);break;case"left-alt":p&&1&this.terminal.keyboard.altKeyPressed&&(c=!1,u=!1)}const f={keyCode:e.keyCode,shift:e.shiftKey,ctrl:c,alt:u,meta:d};let g;const m=this.bindings.getBinding(f);if(m)if(h=c=u=d=!1,o="normal","function"==typeof m.action){g=m.action.call(this,this.terminal,f)}else g=m.action;else g=s(c?"control":u?"alt":d?"meta":"normal"),h=!e.maskShiftKey&&e.shiftKey;if("function"==typeof g&&(g=g.call(this.keyMap,e,r)),u&&"browser-key"==this.altSendsWhat&&g==n&&(g=a),g!==a&&this.terminal.contextMenu.hide(),g!==a&&(g!==n||c||u||d)&&(g===l&&(u=c=!1,g=r.normal,"function"==typeof g&&(g=g.call(this.keyMap,e,r)),g==n&&2==r.keyCap.length&&(g=r.keyCap.substr(h?1:0,1))),e.preventDefault(),e.stopPropagation(),g!==i))if(g===n||"string"==typeof g){if("control"==o?c=!1:"alt"==o?u=!1:"meta"==o&&(d=!1),"string"==typeof g&&"["==g.substr(0,2)&&(u||c||h||d)){let e=1;h&&(e+=1),u&&(e+=2),c&&(e+=4),d&&(e+=8);const t=";"+e;g=3==g.length?"[1"+t+g.substr(2,1):g.substr(0,g.length-1)+t+g.substr(g.length-1)}else{if(g===n&&(g=r.keyCap.substr(h?1:0,1),c)){const e=r.keyCap.substr(0,1).charCodeAt(0);e>=64&&e<=95&&(g=String.fromCharCode(e-64))}if(u&&"8-bit"==this.altSendsWhat&&1==g.length){const e=g.charCodeAt(0)+128;g=String.fromCharCode(e)}(u&&"escape"==this.altSendsWhat||d&&this.metaSendsEscape)&&(g=""+g)}this.terminal.onVTKeystroke(g)}else console.warn("Invalid action: "+JSON.stringify(g))},t.Keyboard.KeyDown,t.Keyboard.KeyBindingFunction,t.Keyboard.KeyBindingAction,t.Keyboard.KeyBinding,t.Keyboard.Bindings=function(){this.bindings_={}},t.Keyboard.Bindings.OsDefaults={android:{},cros:{"Alt+Shift+I":"PASS","Ctrl+Alt+Z":"PASS","Ctrl+Space":"PASS"},linux:{},mac:{"Meta+Left":'"[H"',"Meta+Right":'"[F"'},windows:{}},t.Keyboard.Bindings.prototype.clear=function(){this.bindings_={}},t.Keyboard.Bindings.prototype.addBinding_=function(e,r){let o=null;const s=this.bindings_[e.keyCode];if(s)for(let t=0;t<s.length;t++)if(s[t].keyPattern.matchKeyPattern(e)){o=s[t];break}o?o.action=r:(o={keyPattern:e,action:r},s?(this.bindings_[e.keyCode].push(o),s.sort((function(e,r){return t.Keyboard.KeyPattern.sortCompare(e.keyPattern,r.keyPattern)}))):this.bindings_[e.keyCode]=[o])},t.Keyboard.Bindings.prototype.addBinding=function(e,r){if("string"!=typeof e)return void this.addBinding_(e,r);const o=new t.Parser;let s;o.reset(e);try{s=o.parseKeySequence()}catch(e){return void console.error(e)}if(o.isComplete()){if("string"==typeof r){o.reset(r);try{r=o.parseKeyAction()}catch(e){return void console.error(e)}}o.isComplete()?this.addBinding_(new t.Keyboard.KeyPattern(s),r):console.error(o.error("Expected end of sequence: "+s))}else console.error(o.error("Expected end of sequence: "+s))},t.Keyboard.Bindings.prototype.addBindings=function(e,r=!1){r&&this.addBindings(t.Keyboard.Bindings.OsDefaults[t.os]||{});for(const t in e)this.addBinding(t,e[t])},t.Keyboard.Bindings.prototype.getBinding=function(e){const t=this.bindings_[e.keyCode];if(!t)return null;for(let r=0;r<t.length;r++){const o=t[r];if(o.keyPattern.matchKeyDown(e))return o}return null},t.Keyboard.KeyDef,t.Keyboard.KeyDefFunction,t.Keyboard.KeyDefFunctionProvider,t.Keyboard.KeyDefAction,t.Keyboard.KeyMap=function(e){this.keyboard=e,this.keyDefs={},this.reset()},t.Keyboard.KeyMap.prototype.addKeyDef=function(e,t){e in this.keyDefs&&console.warn("Duplicate keyCode: "+e),this.keyDefs[e]=t},t.Keyboard.KeyMap.prototype.reset=function(){this.keyDefs={};const e=t.Keyboard.KeyActions.CANCEL,r=t.Keyboard.KeyActions.DEFAULT,o=t.Keyboard.KeyActions.PASS,s=t.Keyboard.KeyActions.STRIP,i=(e,t,r)=>{if("function"==typeof e){return e.call(this,t,r)}return e},n=(e,t)=>(r,o)=>{const s=r.shiftKey||r.ctrlKey||r.altKey||r.metaKey||!this.keyboard.applicationCursor?e:t;return i(s,r,o)},a=(e,t)=>(r,o)=>{const s=this.keyboard.backspaceSendsBackspace?t:e;return i(s,r,o)},l=(e,t)=>(r,o)=>{const s=r.shiftKey?t:e;return r.maskShiftKey=!0,i(s,r,o)},c=(e,t)=>(r,o)=>{const s=r.altKey?t:e;return i(s,r,o)},h=(e,t)=>(r,o)=>{const s=r.shiftKey||r.ctrlKey||r.altKey||r.metaKey?t:e;return i(s,r,o)},u=e=>String.fromCharCode(e.charCodeAt(0)-64),d=e=>(t,r)=>this[e](t,r),p=t=>(r,s)=>this.keyboard.mediaKeysAreFKeys?i(t,r,s):166==r.keyCode||167==r.keyCode||168==r.keyCode?e:o,f=(e,t,r,o,s,i)=>{this.addKeyDef(e,{keyCap:t,normal:r,control:o,alt:s,meta:i})};let g,m,b;globalThis.navigator?.userAgent&&globalThis.navigator.userAgent.includes("Firefox")?(g=59,m=61,b=173,f(171,"+*",r,d("onZoom_"),r,d("onZoom_"))):(g=186,m=187,b=189);f(0,"[UNKNOWN]",o,o,o,o),f(27,"[ESC]","",r,r,r),f(112,"[F1]",h("OP","[P"),r,"[23~",r),f(113,"[F2]",h("OQ","[Q"),r,"[24~",r),f(114,"[F3]",h("OR","[R"),r,"[25~",r),f(115,"[F4]",h("OS","[S"),r,"[26~",r),f(116,"[F5]","[15~",r,"[28~",r),f(117,"[F6]","[17~",r,"[29~",r),f(118,"[F7]","[18~",r,"[31~",r),f(119,"[F8]","[19~",r,"[32~",r),f(120,"[F9]","[20~",r,"[33~",r),f(121,"[F10]","[21~",r,"[34~",r),f(122,"[F11]",d("onF11_"),r,"[42~",r),f(123,"[F12]","[24~",r,"[43~",r),f(192,"`~",r,l(u("@"),u("^")),r,o),f(49,"1!",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(50,"2@",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(51,"3#",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(52,"4$",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(53,"5%",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(54,"6^",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(55,"7&",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(56,"8*",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(57,"9(",r,d("onCtrlNum_"),d("onAltNum_"),d("onMetaNum_")),f(48,"0)",r,d("onZoom_"),d("onAltNum_"),d("onZoom_")),f(b,"-_",r,d("onZoom_"),r,d("onZoom_")),f(m,"=+",r,d("onZoom_"),r,d("onZoom_")),f(8,"[BKSP]",a("","\b"),a("\b",""),r,r),f(9,"[TAB]",l("\t","[Z"),d("onCtrlTab_"),o,r),f(81,"qQ",r,u("Q"),r,r),f(87,"wW",r,d("onCtrlW_"),r,r),f(69,"eE",r,u("E"),r,r),f(82,"rR",r,u("R"),r,r),f(84,"tT",r,d("onCtrlT_"),r,r),f(89,"yY",r,u("Y"),r,r),f(85,"uU",r,u("U"),r,r),f(73,"iI",r,u("I"),r,r),f(79,"oO",r,u("O"),r,r),f(80,"pP",r,u("P"),r,r),f(219,"[{",r,u("["),r,r),f(221,"]}",r,u("]"),r,r),f(220,"\\|",r,u("\\"),r,r),f(20,"[CAPS]",o,o,o,r),f(65,"aA",r,l(u("A"),d("onCtrlShiftA_")),r,r),f(83,"sS",r,u("S"),r,r),f(68,"dD",r,u("D"),r,r),f(70,"fF",r,l(u("F"),d("onCtrlShiftF_")),r,r),f(71,"gG",r,u("G"),r,r),f(72,"hH",r,u("H"),r,r),f(74,"jJ",r,l(u("J"),o),r,r),f(75,"kK",r,l(u("K"),d("onClear_")),r,r),f(76,"lL",r,l(u("L"),o),r,r),f(g,";:",r,s,r,r),f(222,"'\"",r,s,r,r),f(13,"[ENTER]","\r",r,r,r),f(16,"[SHIFT]",o,o,o,r),f(90,"zZ",r,u("Z"),r,r),f(88,"xX",r,u("X"),r,r),f(67,"cC",r,d("onCtrlC_"),r,d("onMetaC_")),f(86,"vV",r,d("onCtrlV_"),r,d("onMetaV_")),f(66,"bB",r,u("B"),r,r),f(78,"nN",r,d("onCtrlN_"),r,d("onMetaN_")),f(77,"mM",r,u("M"),r,r),f(188,",<",r,c(s,o),r,r),f(190,".>",r,c(s,o),r,r),f(191,"/?",r,l(u("_"),u("?")),r,r),f(17,"[CTRL]",o,o,o,o),f(18,"[ALT]",o,o,o,o),f(91,"[LAPL]",o,o,o,o),f(32," ",r,u("@"),r,r),f(92,"[RAPL]",o,o,o,o),f(93,"[RMENU]",o,o,o,o),f(42,"[PRTSCR]",o,o,o,o),f(145,"[SCRLK]",o,o,o,o),f(19,"[BREAK]",o,o,o,o),f(45,"[INSERT]",d("onKeyInsert_"),r,r,r),f(36,"[HOME]",d("onKeyHome_"),r,r,r),f(33,"[PGUP]",d("onKeyPageUp_"),r,r,r),f(46,"[DEL]",d("onKeyDel_"),r,r,r),f(35,"[END]",d("onKeyEnd_"),r,r,r),f(34,"[PGDOWN]",d("onKeyPageDown_"),r,r,r),f(38,"[UP]",d("onKeyArrowUp_"),r,r,r),f(40,"[DOWN]",d("onKeyArrowDown_"),r,r,r),f(39,"[RIGHT]",n("[C","OC"),r,r,r),f(37,"[LEFT]",n("[D","OD"),r,r,r),f(144,"[NUMLOCK]",o,o,o,o),f(12,"[CLEAR]",o,o,o,o),f(96,"[KP0]",r,r,r,r),f(97,"[KP1]",r,r,r,r),f(98,"[KP2]",r,r,r,r),f(99,"[KP3]",r,r,r,r),f(100,"[KP4]",r,r,r,r),f(101,"[KP5]",r,r,r,r),f(102,"[KP6]",r,r,r,r),f(103,"[KP7]",r,r,r,r),f(104,"[KP8]",r,r,r,r),f(105,"[KP9]",r,r,r,r),f(107,"[KP+]",r,d("onZoom_"),r,d("onZoom_")),f(109,"[KP-]",r,d("onZoom_"),r,d("onZoom_")),f(106,"[KP*]",r,r,r,r),f(111,"[KP/]",r,r,r,r),f(110,"[KP.]",r,r,r,r),"cros"==t.os&&(f(166,"[BACK]",p(h("OP","[P")),r,"[23~",r),f(167,"[FWD]",p(h("OQ","[Q")),r,"[24~",r),f(168,"[RELOAD]",p(h("OR","[R")),r,"[25~",r),f(183,"[FSCR]",p(h("OS","[S")),r,"[26~",r),f(182,"[WINS]",p("[15~"),r,"[28~",r),f(216,"[BRIT-]",p("[17~"),r,"[29~",r),f(217,"[BRIT+]",p("[18~"),r,"[31~",r),f(173,"[MUTE]",p("[19~"),r,"[32~",r),f(174,"[VOL-]",p("[20~"),r,"[33~",r),f(175,"[VOL+]",p("[21~"),r,"[34~",r),f(152,"[POWER]",r,r,r,r),f(179,"[PLAY]",p("[18~"),r,"[31~",r),f(154,"[DOGS]",p("[23~"),r,"[42~",r),f(153,"[ASSIST]",r,r,r,r))},t.Keyboard.KeyMap.prototype.onKeyInsert_=function(e){return this.keyboard.shiftInsertPaste&&e.shiftKey?t.Keyboard.KeyActions.PASS:"[2~"},t.Keyboard.KeyMap.prototype.onKeyHome_=function(e){return this.keyboard.homeKeysScroll===e.shiftKey?e.altKey||e.ctrlKey||e.shiftKey||!this.keyboard.applicationCursor?"[H":"OH":(this.keyboard.terminal.scrollHome(),t.Keyboard.KeyActions.CANCEL)},t.Keyboard.KeyMap.prototype.onKeyEnd_=function(e){return this.keyboard.homeKeysScroll===e.shiftKey?e.altKey||e.ctrlKey||e.shiftKey||!this.keyboard.applicationCursor?"[F":"OF":(this.keyboard.terminal.scrollEnd(),t.Keyboard.KeyActions.CANCEL)},t.Keyboard.KeyMap.prototype.onKeyPageUp_=function(e){return this.keyboard.pageKeysScroll===e.shiftKey?"[5~":(this.keyboard.terminal.scrollPageUp(),t.Keyboard.KeyActions.CANCEL)},t.Keyboard.KeyMap.prototype.onKeyDel_=function(e){return this.keyboard.altBackspaceIsMetaBackspace&&this.keyboard.altKeyPressed&&!e.altKey?"":"[3~"},t.Keyboard.KeyMap.prototype.onKeyPageDown_=function(e){return this.keyboard.pageKeysScroll===e.shiftKey?"[6~":(this.keyboard.terminal.scrollPageDown(),t.Keyboard.KeyActions.CANCEL)},t.Keyboard.KeyMap.prototype.onKeyArrowUp_=function(e){return!this.keyboard.applicationCursor&&e.shiftKey?(this.keyboard.terminal.scrollLineUp(),t.Keyboard.KeyActions.CANCEL):e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||!this.keyboard.applicationCursor?"[A":"OA"},t.Keyboard.KeyMap.prototype.onKeyArrowDown_=function(e){return!this.keyboard.applicationCursor&&e.shiftKey?(this.keyboard.terminal.scrollLineDown(),t.Keyboard.KeyActions.CANCEL):e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||!this.keyboard.applicationCursor?"[B":"OB"},t.Keyboard.KeyMap.prototype.onClear_=function(e){return this.keyboard.terminal.wipeContents(),t.Keyboard.KeyActions.CANCEL},t.Keyboard.KeyMap.prototype.onF11_=function(e){return"popup"===t.windowType||"app"===t.windowType||e.shiftKey?"[23~":t.Keyboard.KeyActions.PASS},t.Keyboard.KeyMap.prototype.onCtrlNum_=function(e,r){function o(e){return String.fromCharCode(e.charCodeAt(0)-64)}if(this.keyboard.terminal.passCtrlNumber&&!e.shiftKey)return t.Keyboard.KeyActions.PASS;switch(r.keyCap.substr(0,1)){case"1":return"1";case"2":return o("@");case"3":return o("[");case"4":return o("\\");case"5":return o("]");case"6":return o("^");case"7":return o("_");case"8":return"";case"9":return"9"}return t.Keyboard.KeyActions.PASS},t.Keyboard.KeyMap.prototype.onAltNum_=function(e){return this.keyboard.terminal.passAltNumber&&!e.shiftKey?t.Keyboard.KeyActions.PASS:t.Keyboard.KeyActions.DEFAULT},t.Keyboard.KeyMap.prototype.onMetaNum_=function(e){return this.keyboard.terminal.passMetaNumber&&!e.shiftKey?t.Keyboard.KeyActions.PASS:t.Keyboard.KeyActions.DEFAULT},t.Keyboard.KeyMap.prototype.onCtrlTab_=function(e){return this.keyboard.terminal.passCtrlTab?t.Keyboard.KeyActions.PASS:t.Keyboard.KeyActions.STRIP},t.Keyboard.KeyMap.prototype.onCtrlW_=function(e){return this.keyboard.terminal.passCtrlW?t.Keyboard.KeyActions.PASS:""},t.Keyboard.KeyMap.prototype.onCtrlT_=function(e){return this.keyboard.terminal.passCtrlT?t.Keyboard.KeyActions.PASS:""},t.Keyboard.KeyMap.prototype.onCtrlShiftA_=function(e){return this.keyboard.terminal.getScrollPort().selectAll(),t.Keyboard.KeyActions.CANCEL},t.Keyboard.KeyMap.prototype.onCtrlShiftF_=function(e){return this.keyboard.terminal.findBar.display(),t.Keyboard.KeyActions.CANCEL},t.Keyboard.KeyMap.prototype.onCtrlC_=function(e){const r=this.keyboard.terminal.getDocument().getSelection();if(!r.isCollapsed){if(this.keyboard.ctrlCCopy&&!e.shiftKey)return this.keyboard.terminal.clearSelectionAfterCopy&&setTimeout(r.collapseToEnd.bind(r),50),t.Keyboard.KeyActions.PASS;if(!this.keyboard.ctrlCCopy&&e.shiftKey)return this.keyboard.terminal.clearSelectionAfterCopy&&setTimeout(r.collapseToEnd.bind(r),50),this.keyboard.terminal.copySelectionToClipboard(),t.Keyboard.KeyActions.CANCEL}return""},t.Keyboard.KeyMap.prototype.onCtrlN_=function(e){return this.keyboard.terminal.passCtrlN?t.Keyboard.KeyActions.PASS:e.shiftKey?(this.keyboard.terminal.onOpenNewSession(),t.Keyboard.KeyActions.CANCEL):""},t.Keyboard.KeyMap.prototype.onCtrlV_=function(e){return!e.shiftKey&&this.keyboard.ctrlVPaste||e.shiftKey&&!this.keyboard.ctrlVPaste?!1!==this.keyboard.terminal.paste()?t.Keyboard.KeyActions.CANCEL:t.Keyboard.KeyActions.PASS:""},t.Keyboard.KeyMap.prototype.onMetaN_=function(e){return e.shiftKey?(this.keyboard.terminal.onOpenNewSession(),t.Keyboard.KeyActions.CANCEL):t.Keyboard.KeyActions.DEFAULT},t.Keyboard.KeyMap.prototype.onMetaC_=function(e,r){const o=this.keyboard.terminal.getDocument();return e.shiftKey||o.getSelection().isCollapsed?r.keyCap.substr(e.shiftKey?1:0,1):(this.keyboard.terminal.clearSelectionAfterCopy&&setTimeout((function(){o.getSelection().collapseToEnd()}),50),t.Keyboard.KeyActions.PASS)},t.Keyboard.KeyMap.prototype.onMetaV_=function(e){return e.shiftKey||this.keyboard.passMetaV?t.Keyboard.KeyActions.PASS:t.Keyboard.KeyActions.DEFAULT},t.Keyboard.KeyMap.prototype.onZoom_=function(e,r){if(this.keyboard.ctrlPlusMinusZeroZoom===e.shiftKey)return"-_"==r.keyCap?"":t.Keyboard.KeyActions.CANCEL;const o=r.keyCap.substr(0,1);if("0"==o)this.keyboard.terminal.setFontSize(0);else{let e=this.keyboard.terminal.getFontSize();"-"==o||"[KP-]"==r.keyCap?e-=1:e+=1,this.keyboard.terminal.setFontSize(e)}return t.Keyboard.KeyActions.CANCEL},t.Keyboard.KeyPattern=function(e){this.wildcardCount=0,this.keyCode=e.keyCode,t.Keyboard.KeyPattern.modifiers.forEach(function(t){this[t]=e[t]||!1,"*"==this[t]&&this.wildcardCount++}.bind(this))},t.Keyboard.KeyPattern.modifiers=["shift","ctrl","alt","meta"],t.Keyboard.KeyPattern.sortCompare=function(e,t){return e.wildcardCount<t.wildcardCount?-1:e.wildcardCount>t.wildcardCount?1:0},t.Keyboard.KeyPattern.prototype.match_=function(e,r){if(this.keyCode!=e.keyCode)return!1;let o=!0;return t.Keyboard.KeyPattern.modifiers.forEach(function(t){const s=t in e&&e[t];o&&(r||"*"!=this[t])&&this[t]!=s&&(o=!1)}.bind(this)),o},t.Keyboard.KeyPattern.prototype.matchKeyDown=function(e){return this.match_(e,!1)},t.Keyboard.KeyPattern.prototype.matchKeyPattern=function(e){return this.match_(e,!0)},t.NotificationCenter=class{constructor(e,t=void 0){this.parent_=e,this.reader_=t,this.container_=this.newContainer_(),this.timeout_=null,this.fadeout_=200}newContainer_(){const e=this.parent_.ownerDocument.createElement("div");return e.setAttribute("role","dialog"),e.style.cssText='color: rgb(var(--hterm-background-color));background-color: rgb(var(--hterm-foreground-color));border-radius: 12px;font: 500 var(--hterm-font-size) "Noto Sans", sans-serif;opacity: 0.75;padding: 0.923em 1.846em;position: absolute;user-select: none;transition: opacity 180ms ease-in;z-index: 10;',e.addEventListener("mousedown",(function(e){e.preventDefault(),e.stopPropagation()}),!0),e}show(e,{timeout:t=1500}={}){const r="string"==typeof e?new Text(e):e;if(this.container_.parentNode&&null===this.timeout_&&null!==t)return;this.container_.textContent="",this.container_.appendChild(r),this.container_.style.opacity="0.75",this.container_.parentNode||this.parent_.appendChild(this.container_);const o=this.container_.getBoundingClientRect();this.container_.style.top=`calc(50% - ${o.height/2}px)`,this.container_.style.left=`calc(50% - ${o.width/2}px)`,this.reader_&&this.reader_.assertiveAnnounce(this.container_.textContent),this.timeout_&&(clearTimeout(this.timeout_),this.timeout_=null),null!==t&&(this.timeout_=setTimeout((()=>{this.container_.style.opacity="0",this.timeout_=setTimeout((()=>this.hide()),this.fadeout_)}),t))}hide(){this.timeout_&&(clearTimeout(this.timeout_),this.timeout_=null),this.container_.remove(),this.container_.textContent=""}},t.Options=function(e=void 0){this.wraparound=!e||e.wraparound,this.reverseWraparound=!!e&&e.reverseWraparound,this.originMode=!!e&&e.originMode,this.autoCarriageReturn=!!e&&e.autoCarriageReturn,this.cursorVisible=!!e&&e.cursorVisible,this.cursorBlink=!!e&&e.cursorBlink,this.insertMode=!!e&&e.insertMode,this.reverseVideo=!!e&&e.reverseVideo,this.bracketedPaste=!!e&&e.bracketedPaste},t.Parser=function(){this.source="",this.pos=0,this.ch=null},t.Parser.prototype.error=function(e){return new Error("Parse error at "+this.pos+": "+e)},t.Parser.prototype.isComplete=function(){return this.pos==this.source.length},t.Parser.prototype.reset=function(e,t=0){this.source=e,this.pos=t,this.ch=e.substr(0,1)},t.Parser.prototype.parseKeySequence=function(){const e={keyCode:null};for(const r in t.Parser.identifiers.modifierKeys)e[t.Parser.identifiers.modifierKeys[r]]=!1;for(;this.pos<this.source.length;){this.skipSpace();const r=this.parseToken();if("integer"==r.type)e.keyCode=r.value;else if("identifier"==r.type){const o=r.value.toUpperCase();if(o in t.Parser.identifiers.modifierKeys&&t.Parser.identifiers.modifierKeys.hasOwnProperty(o)){const s=t.Parser.identifiers.modifierKeys[o];if(e[s]&&"*"!=e[s])throw this.error("Duplicate modifier: "+r.value);e[s]=!0}else{if(!(o in t.Parser.identifiers.keyCodes)||!t.Parser.identifiers.keyCodes.hasOwnProperty(o))throw this.error("Unknown key: "+r.value);e.keyCode=t.Parser.identifiers.keyCodes[o]}}else{if("symbol"!=r.type)throw this.error("Expected integer or identifier");if("*"!=r.value)throw this.error("Unexpected symbol: "+r.value);for(const r in t.Parser.identifiers.modifierKeys){const o=t.Parser.identifiers.modifierKeys[r];e[o]||(e[o]="*")}}if(this.skipSpace(),"-"!==this.ch&&"+"!==this.ch)break;if(null!=e.keyCode)throw this.error("Extra definition after target key");this.advance(1)}if(null==e.keyCode)throw this.error("Missing target key");return e},t.Parser.prototype.parseKeyAction=function(){this.skipSpace();const e=this.parseToken();if("string"==e.type)return e.value;if("identifier"==e.type){if(e.value in t.Parser.identifiers.actions&&t.Parser.identifiers.actions.hasOwnProperty(e.value))return t.Parser.identifiers.actions[e.value];throw this.error("Unknown key action: "+e.value)}throw this.error("Expected string or identifier")},t.Parser.prototype.peekString=function(){return"'"==this.ch||'"'==this.ch},t.Parser.prototype.peekIdentifier=function(){return!!this.ch.match(/[a-z_]/i)},t.Parser.prototype.peekInteger=function(){return!!this.ch.match(/[0-9]/)},t.Parser.prototype.parseToken=function(){if("*"==this.ch){const e={type:"symbol",value:this.ch};return this.advance(1),e}if(this.peekIdentifier())return{type:"identifier",value:this.parseIdentifier()};if(this.peekString())return{type:"string",value:this.parseString()};if(this.peekInteger())return{type:"integer",value:this.parseInteger()};throw this.error("Unexpected token")},t.Parser.prototype.parseIdentifier=function(){if(!this.peekIdentifier())throw this.error("Expected identifier");return this.parsePattern(/[a-z0-9_]+/gi)},t.Parser.prototype.parseInteger=function(){return"0"==this.ch&&this.pos<this.source.length-1&&"x"==this.source.substr(this.pos+1,1)?parseInt(this.parsePattern(/0x[0-9a-f]+/gi),void 0):parseInt(this.parsePattern(/\d+/g),10)},t.Parser.prototype.parseString=function(){let e="";const t=this.ch;if('"'!=t&&"'"!=t)throw this.error("String expected");this.advance(1);const r=new RegExp("[\\\\"+t+"]","g");for(;this.pos<this.source.length;){if(r.lastIndex=this.pos,!r.exec(this.source))throw this.error("Unterminated string literal");if(e+=this.source.substring(this.pos,r.lastIndex-1),this.advance(r.lastIndex-this.pos-1),'"'!=t||"\\"!=this.ch)if("'"!=t||"\\"!=this.ch){if(this.ch==t)return this.advance(1),e}else e+=this.ch,this.advance(1);else this.advance(1),e+=this.parseEscape()}throw this.error("Unterminated string literal")},t.Parser.prototype.parseEscape=function(){const e={'"':'"',"'":"'","\\":"\\",a:"",b:"\b",e:"",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v",x:function(){const e=this.parsePattern(/[a-z0-9]{2}/gi);return String.fromCharCode(parseInt(e,16))},u:function(){const e=this.parsePattern(/[a-z0-9]{4}/gi);return String.fromCharCode(parseInt(e,16))}};if(!(this.ch in e)||!e.hasOwnProperty(this.ch))throw this.error("Unknown escape: "+this.ch);let t=e[this.ch];return this.advance(1),"function"==typeof t&&(t=t.call(this)),t},t.Parser.prototype.parsePattern=function(e){if(!e.global)throw this.error("Internal error: Span patterns must be global");e.lastIndex=this.pos;const t=e.exec(this.source);if(!t||e.lastIndex-t[0].length!=this.pos)throw this.error("Expected match for: "+e);return this.pos=e.lastIndex-1,this.advance(1),t[0]},t.Parser.prototype.advance=function(e){this.pos+=e,this.ch=this.source.substr(this.pos,1)},t.Parser.prototype.skipSpace=function(e=void 0){if(!/\s/.test(this.ch))return;const t=/\s+/gm;t.lastIndex=this.pos;const r=this.source;if(t.exec(r)&&(this.pos=t.lastIndex),this.ch=this.source.substr(this.pos,1),e&&-1==this.ch.indexOf(e))throw this.error(`Expected one of ${e}, found: ${this.ch}`)},t.Parser.identifiers={},t.Parser.identifiers.modifierKeys={SHIFT:"shift",CTRL:"ctrl",CONTROL:"ctrl",ALT:"alt",META:"meta"},t.Parser.identifiers.keyCodes={ESCAPE:27,ESC:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,ZERO:48,MINUS:189,EQUAL:187,BACKSPACE:8,BKSP:8,BS:8,TAB:9,Q:81,W:87,E:69,R:82,T:84,Y:89,U:85,I:73,O:79,P:80,BRACKET_LEFT:219,BRACKET_RIGHT:221,CAPS_LOCK:20,CAPSLOCK:20,CAPS:20,A:65,S:83,D:68,F:70,G:71,H:72,J:74,K:75,L:76,ENTER:13,ENT:13,RETURN:13,RET:13,Z:90,X:88,C:67,V:86,B:66,N:78,M:77,SPACE:32,SP:32,PRINT_SCREEN:42,PRTSC:42,SCROLL_LOCK:145,SCRLK:145,BREAK:19,BRK:19,INSERT:45,INS:45,HOME:36,PAGE_UP:33,PGUP:33,DELETE:46,DEL:46,END:35,PAGE_DOWN:34,PGDOWN:34,PGDN:34,UP:38,DOWN:40,RIGHT:39,LEFT:37,NUMLOCK:144,KP0:96,KP1:97,KP2:98,KP3:99,KP4:100,KP5:101,KP6:102,KP7:103,KP8:104,KP9:105,KP_PLUS:107,KP_ADD:107,KP_MINUS:109,KP_SUBTRACT:109,KP_STAR:106,KP_MULTIPLY:106,KP_DIVIDE:111,KP_DECIMAL:110,KP_PERIOD:110,NAVIGATE_BACK:166,NAVIGATE_FORWARD:167,RELOAD:168,FULL_SCREEN:183,WINDOW_OVERVIEW:182,BRIGHTNESS_UP:216,BRIGHTNESS_DOWN:217},t.Parser.identifiers.actions={CANCEL:t.Keyboard.KeyActions.CANCEL,DEFAULT:t.Keyboard.KeyActions.DEFAULT,PASS:t.Keyboard.KeyActions.PASS,scrollLineUp:function(e){return e.scrollLineUp(),t.Keyboard.KeyActions.CANCEL},scrollLineDown:function(e){return e.scrollLineDown(),t.Keyboard.KeyActions.CANCEL},scrollPageUp:function(e){return e.scrollPageUp(),t.Keyboard.KeyActions.CANCEL},scrollPageDown:function(e){return e.scrollPageDown(),t.Keyboard.KeyActions.CANCEL},scrollToTop:function(e){return e.scrollHome(),t.Keyboard.KeyActions.CANCEL},scrollToBottom:function(e){return e.scrollEnd(),t.Keyboard.KeyActions.CANCEL},selectAll:function(e){return e.getScrollPort().selectAll(),t.Keyboard.KeyActions.CANCEL},clearScreen:function(e){return e.clearHome(),t.Keyboard.KeyActions.CANCEL},clearScrollback:function(e){return e.clearScrollback(),t.Keyboard.KeyActions.CANCEL},clearTerminal:function(e){return e.wipeContents(),t.Keyboard.KeyActions.CANCEL},fullReset:function(e){return e.reset(),t.Keyboard.KeyActions.CANCEL},softReset:function(e){return e.softReset(),t.Keyboard.KeyActions.CANCEL},copyCurrentSelection:function(e){return e.copySelectionToClipboard(),t.Keyboard.KeyActions.CANCEL},pasteClipboard:function(e){return e.paste(),t.Keyboard.KeyActions.CANCEL}},t.PreferenceManager=class extends e.PreferenceManager{constructor(e,r=t.Terminal.DEFAULT_PROFILE_ID){super(e,t.PreferenceManager.prefix_+r),Object.entries(t.PreferenceManager.defaultPreferences).forEach((([e,t])=>{this.definePreference(e,t.default)}))}setProfile(e){return this.setPrefix(t.PreferenceManager.prefix_+e)}},t.PreferenceManager.prefix_="/hterm/profiles/",t.PreferenceManager.listProfiles=async function(e){const r=await e.getItems(null),o={};for(const e of Object.keys(r))if(e.startsWith(t.PreferenceManager.prefix_)){o[e.slice(t.PreferenceManager.prefix_.length).split("/",1)[0]]=!0}return Object.keys(o)},t.PreferenceManager.Categories={Keyboard:"Keyboard",Appearance:"Appearance",CopyPaste:"CopyPaste",Sounds:"Sounds",Scrolling:"Scrolling",Encoding:"Encoding",Extensions:"Extensions",Miscellaneous:"Miscellaneous"},t.PreferenceManager.categoryDefinitions=[{id:t.PreferenceManager.Categories.Appearance,text:"Appearance (fonts, colors, images)"},{id:t.PreferenceManager.Categories.CopyPaste,text:"Copy & Paste"},{id:t.PreferenceManager.Categories.Encoding,text:"Encoding"},{id:t.PreferenceManager.Categories.Keyboard,text:"Keyboard"},{id:t.PreferenceManager.Categories.Scrolling,text:"Scrolling"},{id:t.PreferenceManager.Categories.Sounds,text:"Sounds"},{id:t.PreferenceManager.Categories.Extensions,text:"Extensions"},{id:t.PreferenceManager.Categories.Miscellaneous,text:"Miscellaneous"}],t.PreferenceManager.definePref_=function(e,t,r,o,s){return{name:e,category:t,default:r,type:o,help:s}},t.PreferenceManager.defaultPreferences={"alt-gr-mode":t.PreferenceManager.definePref_("AltGr key mode",t.PreferenceManager.Categories.Keyboard,null,[null,"none","ctrl-alt","left-alt","right-alt"],"Select an AltGr detection heuristic.\n\n'null': Autodetect based on navigator.language:\n      'en-us' => 'none', else => 'right-alt'\n'none': Disable any AltGr emulation.\n'ctrl-alt': Assume Ctrl+Alt means AltGr.\n'left-alt': Assume left Alt means AltGr.\n'right-alt': Assume right Alt means AltGr."),"alt-backspace-is-meta-backspace":t.PreferenceManager.definePref_("Alt+Backspace is Meta+Backspace",t.PreferenceManager.Categories.Keyboard,!1,"bool","If set, undoes the ChromeOS Alt+Backspace->Delete remap, so that Alt+Backspace indeed is Alt+Backspace."),"alt-is-meta":t.PreferenceManager.definePref_("Treat Alt key as Meta key",t.PreferenceManager.Categories.Keyboard,!1,"bool","Whether the Alt key acts as a Meta key or as a distinct Alt key."),"alt-sends-what":t.PreferenceManager.definePref_("Alt key modifier handling",t.PreferenceManager.Categories.Keyboard,"escape",["escape","8-bit","browser-key"],"Controls how the Alt key is handled.\n\n  escape: Send an ESC prefix.\n  8-bit: Add 128 to the typed character as in xterm.\n  browser-key: Wait for the keypress event and see what the browser\n    says. (This won't work well on platforms where the browser\n    performs a default action for some Alt sequences.)"),"audible-bell-sound":t.PreferenceManager.definePref_("Alert bell sound (URI)",t.PreferenceManager.Categories.Sounds,"lib-resource:hterm/audio/bell","url","URL of the terminal bell sound. Leave it blank for no audible bell."),"desktop-notification-bell":t.PreferenceManager.definePref_("Create desktop notifications for alert bells",t.PreferenceManager.Categories.Sounds,!1,"bool",'If true, terminal bells in the background will create a Web Notification. https://www.w3.org/TR/notifications/\n\nDisplaying notifications requires permission from the user. When this option is set to true, hterm will attempt to ask the user for permission if necessary. Browsers might not show this permission request if it was not triggered by a user action.\n\nChrome extensions with the "notifications" permission have permission to display notifications.'),"background-color":t.PreferenceManager.definePref_("Background color",t.PreferenceManager.Categories.Appearance,"rgb(16, 16, 16)","color","The background color for text with no other color attributes."),"background-image":t.PreferenceManager.definePref_("Background image",t.PreferenceManager.Categories.Appearance,"","string","CSS value of the background image. Leave it blank for no image.\n\nFor example:\n  url(https://hterm.org/x/example/bg-img)\n  linear-gradient(top bottom, blue, red)"),"background-size":t.PreferenceManager.definePref_("Background image size",t.PreferenceManager.Categories.Appearance,"","string","CSS value of the background image size."),"background-position":t.PreferenceManager.definePref_("Background image position",t.PreferenceManager.Categories.Appearance,"","string","CSS value of the background image position.\n\nFor example:\n  10% 10%\n  center"),"backspace-sends-backspace":t.PreferenceManager.definePref_("Backspace key behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool","If true, the Backspace key will send BS ('\\x08', aka ^H). Otherwise the Backspace key will send '\\x7f'."),"character-map-overrides":t.PreferenceManager.definePref_("Character map overrides",t.PreferenceManager.Categories.Appearance,null,"value",'This is specified as an object. It is a sparse array, where each property is the character set code and the value is an object that is a sparse array itself. In that sparse array, each property is the received character and the value is the displayed character.\n\nFor example:\n{ "0": {\n  "+": "\\u2192",\n  ",": "\\u2190",\n  "-": "\\u2191",\n  ".": "\\u2193",\n  "0": "\\u2588"\n} }'),"close-on-exit":t.PreferenceManager.definePref_("Close window on exit",t.PreferenceManager.Categories.Miscellaneous,!0,"bool","Whether to close the window when the command finishes executing."),"cursor-blink":t.PreferenceManager.definePref_("Cursor blink",t.PreferenceManager.Categories.Appearance,!1,"bool","Whether the text cursor blinks by default. This can be toggled at runtime via terminal escape sequences."),"cursor-blink-cycle":t.PreferenceManager.definePref_("Cursor blink rate",t.PreferenceManager.Categories.Appearance,[1e3,500],"value","The text cursor blink rate in milliseconds.\n\nA two element array, the first of which is how long the text cursor should be on, second is how long it should be off."),"cursor-shape":t.PreferenceManager.definePref_("Text cursor shape",t.PreferenceManager.Categories.Appearance,"BLOCK",["BLOCK","BEAM","UNDERLINE"],"The shape of the visible text cursor. This can be changed at runtime via terminal escape sequences."),"cursor-color":t.PreferenceManager.definePref_("Text cursor color",t.PreferenceManager.Categories.Appearance,"rgba(255, 0, 0, 0.5)","color","The color of the visible text cursor."),"color-palette-overrides":t.PreferenceManager.definePref_("Initial color palette",t.PreferenceManager.Categories.Appearance,null,"value",'Override colors in the default palette.\n\nThis can be specified as an array or an object. If specified as an object it is assumed to be a sparse array, where each property is a numeric index into the color palette.\n\nValues can be specified as almost any CSS color value. This includes #RGB, #RRGGBB, rgb(...), rgba(...), and any color names that are also part of the standard X11 rgb.txt file.\n\nYou can use \'null\' to specify that the default value should be not be changed. This is useful for skipping a small number of indices when the value is specified as an array.\n\nFor example, these both set color index 1 to blue:\n  {1: "#0000ff"}\n  [null, "#0000ff"]'),"copy-on-select":t.PreferenceManager.definePref_("Automatically copy selected content",t.PreferenceManager.Categories.CopyPaste,!0,"bool","Automatically copy mouse selection to the clipboard."),"use-default-window-copy":t.PreferenceManager.definePref_("Let the browser handle text copying",t.PreferenceManager.Categories.CopyPaste,!1,"bool","Whether to use the default browser/OS's copy behavior.\n\nAllow the browser/OS to handle the copy event directly which might improve compatibility with some systems (where copying doesn't work at all), but makes the text selection less robust.\n\nFor example, long lines that were automatically line wrapped will be copied with the newlines still in them."),"clear-selection-after-copy":t.PreferenceManager.definePref_("Automatically clear text selection",t.PreferenceManager.Categories.CopyPaste,!0,"bool","Whether to clear the selection after copying."),"ctrl-plus-minus-zero-zoom":t.PreferenceManager.definePref_("Ctrl++/-/0 zoom behavior",t.PreferenceManager.Categories.Keyboard,!0,"bool","If true, Ctrl+Plus/Minus/Zero controls zoom.\nIf false, Ctrl+Shift+Plus/Minus/Zero controls zoom, Ctrl+Minus sends ^_, Ctrl+Plus/Zero do nothing."),"ctrl-c-copy":t.PreferenceManager.definePref_("Ctrl+C copy behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool","Ctrl+C copies if true, send ^C to host if false.\nCtrl+Shift+C sends ^C to host if true, copies if false."),"ctrl-v-paste":t.PreferenceManager.definePref_("Ctrl+V paste behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool","Ctrl+V pastes if true, send ^V to host if false.\nCtrl+Shift+V sends ^V to host if true, pastes if false."),"east-asian-ambiguous-as-two-column":t.PreferenceManager.definePref_("East Asian Ambiguous use two columns",t.PreferenceManager.Categories.Keyboard,!1,"bool","Whether East Asian Ambiguous characters have two column width."),"enable-8-bit-control":t.PreferenceManager.definePref_("Support non-UTF-8 C1 control characters",t.PreferenceManager.Categories.Keyboard,!1,"bool","True to enable 8-bit control characters, false to ignore them.\n\nWe'll respect the two-byte versions of these control characters regardless of this setting."),"enable-bold":t.PreferenceManager.definePref_("Bold text behavior",t.PreferenceManager.Categories.Appearance,null,"tristate","If true, use bold weight font for text with the bold/bright attribute. False to use the normal weight font. Null to autodetect."),"enable-bold-as-bright":t.PreferenceManager.definePref_("Use bright colors with bold text",t.PreferenceManager.Categories.Appearance,!0,"bool","If true, use bright colors (8-15 on a 16 color palette) for any text with the bold attribute. False otherwise."),"enable-blink":t.PreferenceManager.definePref_("Enable blinking text",t.PreferenceManager.Categories.Appearance,!0,"bool","If true, respect the blink attribute. False to ignore it."),"enable-clipboard-notice":t.PreferenceManager.definePref_("Show notification when copying content",t.PreferenceManager.Categories.CopyPaste,!0,"bool","Whether to show a message in the terminal when the host writes to the clipboard."),"enable-clipboard-write":t.PreferenceManager.definePref_("Allow remote clipboard writes",t.PreferenceManager.Categories.CopyPaste,!0,"bool","Allow the remote host to write directly to the local system clipboard.\nRead access is never granted regardless of this setting.\n\nThis is used to control access to features like OSC-52."),"enable-dec12":t.PreferenceManager.definePref_("Allow changing of text cursor blinking",t.PreferenceManager.Categories.Miscellaneous,!1,"bool","Respect the host's attempt to change the text cursor blink status using DEC Private Mode 12."),"enable-csi-j-3":t.PreferenceManager.definePref_("Allow clearing of scrollback buffer (CSI-J-3)",t.PreferenceManager.Categories.Miscellaneous,!0,"bool","Whether the Erase Saved Lines function (mode 3) of the Erase Display command (CSI-J) may clear the terminal scrollback buffer.\n\nEnabling this by default is safe."),environment:t.PreferenceManager.definePref_("Environment variables",t.PreferenceManager.Categories.Miscellaneous,{NCURSES_NO_UTF8_ACS:"1",TERM:"xterm-256color",COLORTERM:"truecolor"},"value","The initial set of environment variables, as an object."),"find-result-color":t.PreferenceManager.definePref_("Find results highlight color",t.PreferenceManager.Categories.Appearance,"rgba(102, 204, 255, 0.4)","color","The background color to highlight find results."),"find-result-selected-color":t.PreferenceManager.definePref_("Find results selected highlight color",t.PreferenceManager.Categories.Appearance,"rgba(102, 204, 255, 0.8)","color","The background color to highlight the selected find result."),"font-family":t.PreferenceManager.definePref_("Text font family",t.PreferenceManager.Categories.Appearance,'"DejaVu Sans Mono", "Noto Sans Mono", "Everson Mono", FreeMono, Menlo, Terminal, monospace',"string","Default font family for the terminal text."),"font-size":t.PreferenceManager.definePref_("Text font size",t.PreferenceManager.Categories.Appearance,15,"int","The default font size in pixels."),"font-smoothing":t.PreferenceManager.definePref_("Text font smoothing",t.PreferenceManager.Categories.Appearance,"antialiased","string","CSS font-smoothing property."),"line-height-padding-size":t.PreferenceManager.definePref_("Line height padding size",t.PreferenceManager.Categories.Appearance,0,"int","The padding size in pixels between each row of the terminal screen."),"foreground-color":t.PreferenceManager.definePref_("Text color",t.PreferenceManager.Categories.Appearance,"rgb(240, 240, 240)","color","The foreground color for text with no other color attributes."),"enable-resize-status":t.PreferenceManager.definePref_("Show terminal dimensions when resized",t.PreferenceManager.Categories.Appearance,!1,"bool","Whether to show terminal dimensions when the terminal changes size."),"hide-mouse-while-typing":t.PreferenceManager.definePref_("Hide mouse cursor while typing",t.PreferenceManager.Categories.Keyboard,null,"tristate","Whether to automatically hide the mouse cursor when typing. By default, autodetect whether the platform/OS handles this.\n\nNote: Your operating system might override this setting and thus you might not be able to always disable it."),"home-keys-scroll":t.PreferenceManager.definePref_("Home/End key scroll behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool","If true, Home/End controls the terminal scrollbar and Shift+Home/Shift+End are sent to the remote host. If false, then Home/End are sent to the remote host and Shift+Home/Shift+End scrolls."),keybindings:t.PreferenceManager.definePref_("Keyboard bindings/shortcuts",t.PreferenceManager.Categories.Keyboard,null,"value",'A map of key sequence to key actions. Key sequences include zero or more modifier keys followed by a key code. Key codes can be decimal or hexadecimal numbers, or a key identifier. Key actions can be specified as a string to send to the host, or an action identifier. For a full explanation of the format, see https://hterm.org/x/docs/keyboard-bindings.\n\nSample keybindings:\n{\n  "Ctrl+Alt+K": "clearTerminal",\n  "Ctrl+Shift+L": "PASS",\n  "Ctrl+H": "\'Hello World\'"\n}'),"keybindings-os-defaults":t.PreferenceManager.definePref_("Use default OS Keyboard bindings/shortcuts",t.PreferenceManager.Categories.Keyboard,!1,"bool","Whether common OS keyboard bindings should be respected instead of always capturing for hterm's own use."),"media-keys-are-fkeys":t.PreferenceManager.definePref_("Media keys are Fkeys",t.PreferenceManager.Categories.Keyboard,!1,"bool","If true, convert media keys to their Fkey equivalent. If false, let the browser handle the keys."),"meta-sends-escape":t.PreferenceManager.definePref_("Meta key modifier handling",t.PreferenceManager.Categories.Keyboard,!0,"bool","Send an ESC prefix when pressing a key while holding the Meta key.\n\nFor example, when enabled, pressing Meta+K will send ^[k as if you typed Escape then k. When disabled, only k will be sent."),"mouse-right-click-paste":t.PreferenceManager.definePref_("Mouse right clicks paste content",t.PreferenceManager.Categories.CopyPaste,!0,"bool",'Paste on right mouse button clicks.\n\nThis option is independent of the "mouse-paste-button" setting.\n\nNote: The primary & secondary buttons are handled for you with left & right handed mice.'),"mouse-paste-button":t.PreferenceManager.definePref_("Mouse button paste",t.PreferenceManager.Categories.CopyPaste,null,[null,0,1,2,3,4,5,6],"The mouse button to use for pasting.\n\nFor autodetect, we'll use the middle mouse button for non-X11 platforms (including ChromeOS). On X11, we'll use the right mouse button (since the window manager should handle pasting via the middle mouse button).\n\n0 == left (primary) button.\n1 == middle (auxiliary) button.\n2 == right (secondary) button.\n\nThis option is independent of the setting for right-click paste.\n\nNote: The primary & secondary buttons are handled for you with left & right handed mice."),"screen-padding-size":t.PreferenceManager.definePref_("Screen padding size",t.PreferenceManager.Categories.Appearance,8,"int","The padding size in pixels around the border of the terminal screen.\n\nThis controls the size of the border around the terminal screen so the user can add some visible padding to the edges of the screen."),"screen-border-size":t.PreferenceManager.definePref_("Screen border size",t.PreferenceManager.Categories.Appearance,0,"int","The border size in pixels around the terminal screen.\n\nThis controls the size of the border around the terminal screen to create a visible line at the edges of the screen."),"screen-border-color":t.PreferenceManager.definePref_("Screen border color",t.PreferenceManager.Categories.Appearance,"rgb(128, 128, 128)","color","The color for the border around the terminal screen.\n\nThis controls the color of the border around the terminal screen to create a visible line at the edges of the screen."),"word-break-match-left":t.PreferenceManager.definePref_("Automatic selection halting (to the left)",t.PreferenceManager.Categories.CopyPaste,"[^\\s[\\](){}<>\"'^!@#$%&*,;:`‘“‹«]","string",'Regular expression to halt matching to the left (start) of a selection.\n\nNormally this is a character class to reject specific characters.\nWe allow "~" and "." by default as paths frequently start with those.'),"word-break-match-right":t.PreferenceManager.definePref_("Automatic selection halting (to the right)",t.PreferenceManager.Categories.CopyPaste,"[^\\s[\\](){}<>\"'^!@#$%&*,;:~.`’”›»]","string","Regular expression to halt matching to the right (end) of a selection.\n\nNormally this is a character class to reject specific characters."),"word-break-match-middle":t.PreferenceManager.definePref_("Word break characters",t.PreferenceManager.Categories.CopyPaste,"[^\\s[\\](){}<>\"'^]*","string","Regular expression to match all the characters in the middle.\n\nNormally this is a character class to reject specific characters.\n\nUsed to expand the selection surrounding the starting point."),"page-keys-scroll":t.PreferenceManager.definePref_("Page Up/Down key scroll behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool","If true, Page Up/Page Down controls the terminal scrollbar and Shift+Page Up/Shift+Page Down are sent to the remote host. If false, then Page Up/Page Down are sent to the remote host and Shift+Page Up/Shift+Page Down scrolls."),"pass-alt-number":t.PreferenceManager.definePref_("Alt+1..9 switch tab/app behavior",t.PreferenceManager.Categories.Keyboard,null,"tristate","Whether Alt+1..9 is passed to the browser.\n\nThis is handy when running hterm in a browser tab, so that you don't lose Chrome's \"switch to tab/app\" keyboard shortcuts. When not running in a tab it's better to send these keys to the host so they can be used in vim or emacs.\n\nIf true, Alt+1..9 will be handled by the browser. If false, Alt+1..9 will be sent to the host. If null, autodetect based on browser platform and window type."),"pass-ctrl-number":t.PreferenceManager.definePref_("Ctrl+1..9 switch tab behavior",t.PreferenceManager.Categories.Keyboard,null,"tristate","Whether Ctrl+1..9 is passed to the browser.\n\nThis is handy when running hterm in a browser tab, so that you don't lose Chrome's \"switch to tab\" keyboard shortcuts. When not running in a tab it's better to send these keys to the host so they can be used in vim or emacs.\n\nIf true, Ctrl+1..9 will be handled by the browser. If false, Ctrl+1..9 will be sent to the host. If null, autodetect based on browser platform and window type."),"pass-ctrl-n":t.PreferenceManager.definePref_("Ctrl+N new window behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool",'Whether Ctrl+N is passed to the browser.\n\nIf true, Ctrl+N will be handled by the browser as the "new window" keyboard shortcut. If false, Ctrl+N will be sent to the host.'),"pass-ctrl-t":t.PreferenceManager.definePref_("Ctrl+T new tab behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool",'Whether Ctrl+T is passed to the browser.\n\nIf true, Ctrl+T will be handled by the browser as the "new tab" keyboard shortcut. If false, Ctrl+T will be sent to the host.'),"pass-ctrl-tab":t.PreferenceManager.definePref_("Ctrl+Tab switch tab behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool",'Whether Ctrl+Tab and Ctrl+Shift+Tab are passed to the browser.\n\nIf true, Ctrl+Tab and Ctrl+Shift+Tab will be handled by the browser as the "next/previous tab" keyboard shortcut. If false, the Tab key is sent to the host without Ctrl or Shift.'),"pass-ctrl-w":t.PreferenceManager.definePref_("Ctrl+W close tab behavior",t.PreferenceManager.Categories.Keyboard,!1,"bool",'Whether Ctrl+W is passed to the browser.\n\nIf true, Ctrl+W will be handled by the browser as the "close tab" keyboard shortcut. If false, Ctrl+W will be sent to the host.'),"pass-meta-number":t.PreferenceManager.definePref_("Meta+1..9 switch tab behavior",t.PreferenceManager.Categories.Keyboard,null,"tristate","Whether Meta+1..9 is passed to the browser.\n\nThis is handy when running hterm in a browser tab, so that you don't lose Chrome's \"switch to tab\" keyboard shortcuts. When not running in a tab it's better to send these keys to the host so they can be used in vim or emacs.\n\nIf true, Meta+1..9 will be handled by the browser. If false, Meta+1..9 will be sent to the host. If null, autodetect based on browser platform and window type."),"pass-meta-v":t.PreferenceManager.definePref_("Meta+V paste behavior",t.PreferenceManager.Categories.Keyboard,!0,"bool","Whether Meta+V gets passed to the browser.\n\nOn some systems, this is used to paste content."),"paste-on-drop":t.PreferenceManager.definePref_("Allow drag & drop to paste",t.PreferenceManager.Categories.CopyPaste,!0,"bool","If true, Drag and dropped text will paste into terminal.\nIf false, dropped text will be ignored."),"scroll-on-keystroke":t.PreferenceManager.definePref_("Scroll to bottom after keystroke",t.PreferenceManager.Categories.Scrolling,!0,"bool","Whether to scroll to the bottom on any keystroke."),"scroll-on-output":t.PreferenceManager.definePref_("Scroll to bottom after new output",t.PreferenceManager.Categories.Scrolling,!1,"bool","Whether to scroll to the bottom on terminal output."),"scrollbar-visible":t.PreferenceManager.definePref_("Scrollbar visibility",t.PreferenceManager.Categories.Scrolling,!0,"bool","The vertical scrollbar mode."),"scroll-wheel-may-send-arrow-keys":t.PreferenceManager.definePref_("Emulate arrow keys with scroll wheel",t.PreferenceManager.Categories.Scrolling,!1,"bool","When using the alternative screen buffer, and DECCKM (Application Cursor Keys) is active, mouse scroll wheel events will emulate arrow keys.\n\nIt can be temporarily disabled by holding the Shift key.\n\nThis frequently comes up when using pagers (less) or reading man pages or text editors (vi/nano) or using screen/tmux."),"scroll-wheel-move-multiplier":t.PreferenceManager.definePref_("Mouse scroll wheel multiplier",t.PreferenceManager.Categories.Scrolling,1,"int","The multiplier for mouse scroll wheel events when measured in pixels.\n\nAlters how fast the page scrolls."),"terminal-encoding":t.PreferenceManager.definePref_("Terminal encoding",t.PreferenceManager.Categories.Encoding,"utf-8",["iso-2022","utf-8","utf-8-locked"],"The default terminal encoding (DOCS).\n\nISO-2022 enables character map translations (like graphics maps).\nUTF-8 disables support for those.\n\nThe locked variant means the encoding cannot be changed at runtime via terminal escape sequences.\n\nYou should stick with UTF-8 unless you notice broken rendering with legacy applications."),"shift-insert-paste":t.PreferenceManager.definePref_("Shift+Insert paste",t.PreferenceManager.Categories.Keyboard,!0,"bool","Whether Shift+Insert is used for pasting or is sent to the remote host."),"user-css":t.PreferenceManager.definePref_("Custom CSS (URI)",t.PreferenceManager.Categories.Appearance,"","url","URL of user stylesheet to include in the terminal document."),"user-css-text":t.PreferenceManager.definePref_("Custom CSS (inline text)",t.PreferenceManager.Categories.Appearance,"","multiline-string","Custom CSS text for styling the terminal."),"allow-images-inline":t.PreferenceManager.definePref_("Allow inline image display",t.PreferenceManager.Categories.Extensions,null,"tristate","Whether to allow the remote host to display images in the terminal.\n\nBy default, we prompt until a choice is made.")},t.PubSub=function(){this.observers_={}},t.PubSub.addBehavior=function(e){const r=new t.PubSub;for(const o in t.PubSub.prototype)e[o]=t.PubSub.prototype[o].bind(r)},t.PubSub.prototype.subscribe=function(e,t){e in this.observers_||(this.observers_[e]=[]),this.observers_[e].push(t)},t.PubSub.prototype.unsubscribe=function(e,t){const r=this.observers_[e];if(!r)throw new Error(`Invalid subject: ${e}`);const o=r.indexOf(t);if(o<0)throw new Error(`Not subscribed: ${e}`);r.splice(o,1)},t.PubSub.prototype.publish=function(e,t,r=void 0){let o=this.observers_[e];o&&(o=[].concat(o)),r&&(o?o.push(r):o=[r]),o&&setTimeout((function e(r){r<o.length-1&&setTimeout(e,0,r+1),o[r](t)}),0,0)},t.Screen=function(e=0){this.rowsArray=[],this.columnCount_=e,this.textAttributes=new t.TextAttributes(globalThis.document),this.cursorPosition=new t.RowCol(0,0),this.cursorState_=new t.Screen.CursorState(this),this.cursorRowNode_=null,this.cursorNode_=null,this.cursorOffset_=0,this.wordBreakMatchLeft=null,this.wordBreakMatchRight=null,this.wordBreakMatchMiddle=null},t.Screen.prototype.getSize=function(){return new t.Size(this.columnCount_,this.rowsArray.length)},t.Screen.prototype.getHeight=function(){return this.rowsArray.length},t.Screen.prototype.getWidth=function(){return this.columnCount_},t.Screen.prototype.setColumnCount=function(e){this.columnCount_=e,this.cursorPosition.column>=e&&this.setCursorPosition(this.cursorPosition.row,e-1)},t.Screen.prototype.shiftRow=function(){return this.shiftRows(1)[0]},t.Screen.prototype.shiftRows=function(e){return this.rowsArray.splice(0,e)},t.Screen.prototype.unshiftRow=function(e){this.rowsArray.splice(0,0,e)},t.Screen.prototype.unshiftRows=function(e){this.rowsArray.unshift.apply(this.rowsArray,e)},t.Screen.prototype.popRow=function(){return this.popRows(1)[0]},t.Screen.prototype.popRows=function(e){return this.rowsArray.splice(this.rowsArray.length-e,e)},t.Screen.prototype.pushRow=function(e){this.rowsArray.push(e)},t.Screen.prototype.pushRows=function(e){e.push.apply(this.rowsArray,e)},t.Screen.prototype.insertRow=function(e,t){this.rowsArray.splice(e,0,t)},t.Screen.prototype.insertRows=function(e,t){for(let r=0;r<t.length;r++)this.rowsArray.splice(e+r,0,t[r])},t.Screen.prototype.removeRow=function(e){return this.rowsArray.splice(e,1)[0]},t.Screen.prototype.removeRows=function(e,t){return this.rowsArray.splice(e,t)},t.Screen.prototype.invalidateCursorPosition=function(){this.cursorPosition.move(0,0),this.cursorRowNode_=null,this.cursorNode_=null,this.cursorOffset_=0},t.Screen.prototype.clearCursorRow=function(){let e;this.cursorRowNode_.innerText="",this.cursorRowNode_.removeAttribute("line-overflow"),this.cursorOffset_=0,this.cursorPosition.column=0,this.cursorPosition.overflow=!1,e=this.textAttributes.isDefault()?"":" ".repeat(this.columnCount_);const t=this.textAttributes.inverse;this.textAttributes.inverse=!1,this.textAttributes.syncColors();const r=this.textAttributes.createContainer(e);this.cursorRowNode_.appendChild(r),this.cursorNode_=r,this.textAttributes.inverse=t,this.textAttributes.syncColors()},t.Screen.prototype.commitLineOverflow=function(){this.cursorRowNode_.setAttribute("line-overflow",!0)},t.Screen.prototype.setCursorPosition=function(e,r){if(!this.rowsArray.length)return void console.warn("Attempt to set cursor position on empty screen.");e>=this.rowsArray.length?(console.error("Row out of bounds: "+e),e=this.rowsArray.length-1):e<0&&(console.error("Row out of bounds: "+e),e=0),r>=this.columnCount_?(console.error("Column out of bounds: "+r),r=this.columnCount_-1):r<0&&(console.error("Column out of bounds: "+r),r=0),this.cursorPosition.overflow=!1;const o=this.rowsArray[e];let s=o.firstChild;s||(s=o.ownerDocument.createTextNode(""),o.appendChild(s));let i=0;for(o==this.cursorRowNode_?r>=this.cursorPosition.column-this.cursorOffset_&&(s=this.cursorNode_,i=this.cursorPosition.column-this.cursorOffset_):this.cursorRowNode_=o,this.cursorPosition.move(e,r);s;){const e=r-i,o=t.TextAttributes.nodeWidth(s);if(!s.nextSibling||o>e)return this.cursorNode_=s,void(this.cursorOffset_=e);i+=o,s=s.nextSibling}},t.Screen.prototype.syncSelectionCaret=function(e){try{e.collapse(this.cursorNode_,this.cursorOffset_)}catch(e){}},t.Screen.prototype.splitNode_=function(e,r){const o=e.cloneNode(!1),s=e.textContent;e.textContent=t.TextAttributes.nodeSubstr(e,0,r),o.textContent=t.wc.substr(s,r),o.textContent&&e.parentNode.insertBefore(o,e.nextSibling),e.textContent||e.remove()},t.Screen.prototype.maybeClipCurrentRow=function(){let r=t.TextAttributes.nodeWidth(e.notNull(this.cursorRowNode_));if(r<=this.columnCount_)return void(this.cursorPosition.column>=this.columnCount_&&(this.setCursorPosition(this.cursorPosition.row,this.columnCount_-1),this.cursorPosition.overflow=!0));const o=this.cursorPosition.column;this.setCursorPosition(this.cursorPosition.row,this.columnCount_-1),r=t.TextAttributes.nodeWidth(e.notNull(this.cursorNode_)),this.cursorOffset_<r-1&&(this.cursorNode_.textContent=t.TextAttributes.nodeSubstr(this.cursorNode_,0,this.cursorOffset_+1));const s=this.cursorRowNode_;let i=this.cursorNode_.nextSibling;for(;i;)s.removeChild(i),i=this.cursorNode_.nextSibling;o<this.columnCount_?this.setCursorPosition(this.cursorPosition.row,o):this.cursorPosition.overflow=!0},t.Screen.prototype.insertString=function(e,r=void 0){let o=this.cursorNode_,s=o.textContent;this.cursorRowNode_.removeAttribute("line-overflow"),void 0===r&&(r=t.wc.strWidth(e)),this.cursorPosition.column+=r;let i=this.cursorOffset_,n=t.TextAttributes.nodeWidth(o)-i;if(n<0){const t=" ".repeat(-n);if(this.textAttributes.underline||this.textAttributes.strikethrough||this.textAttributes.background||this.textAttributes.wcNode||!this.textAttributes.asciiNode||null!=this.textAttributes.tileData)if(o.nodeType!=Node.TEXT_NODE&&(o.wcNode||!o.asciiNode||o.tileNode||o.style.textDecoration||o.style.textDecorationStyle||o.style.textDecorationLine||o.style.backgroundColor)){const e=o.ownerDocument.createTextNode(t);this.cursorRowNode_.insertBefore(e,o.nextSibling),this.cursorNode_=o=e,this.cursorOffset_=i=-n,s=t}else o.textContent=s+=t;else e=t+e;n=0}if(this.textAttributes.matchesContainer(o))return o.textContent=0==n?s+e:0==i?e+s:t.TextAttributes.nodeSubstr(o,0,i)+e+t.TextAttributes.nodeSubstr(o,i),void(this.cursorOffset_+=r);if(0==i){const s=o.previousSibling;if(s&&this.textAttributes.matchesContainer(s))return s.textContent+=e,this.cursorNode_=s,void(this.cursorOffset_=t.wc.strWidth(s.textContent));const i=this.textAttributes.createContainer(e);return this.cursorRowNode_.insertBefore(i,o),this.cursorNode_=i,void(this.cursorOffset_=r)}if(0==n){const r=o.nextSibling;if(r&&this.textAttributes.matchesContainer(r))return r.textContent=e+r.textContent,this.cursorNode_=r,void(this.cursorOffset_=t.wc.strWidth(e));const s=this.textAttributes.createContainer(e);return this.cursorRowNode_.insertBefore(s,r),this.cursorNode_=s,void(this.cursorOffset_=t.TextAttributes.nodeWidth(s))}this.splitNode_(o,i);const a=this.textAttributes.createContainer(e);this.cursorRowNode_.insertBefore(a,o.nextSibling),this.cursorNode_=a,this.cursorOffset_=r},t.Screen.prototype.overwriteString=function(r,o=void 0){const s=this.columnCount_-this.cursorPosition.column;if(s){if(void 0===o&&(o=t.wc.strWidth(r)),this.textAttributes.matchesContainer(e.notNull(this.cursorNode_))&&this.cursorNode_.textContent.substr(this.cursorOffset_)==r)return this.cursorOffset_+=o,void(this.cursorPosition.column+=o);this.deleteChars(Math.min(o,s)),this.insertString(r,o)}},t.Screen.prototype.deleteChars=function(e){let r=this.cursorNode_,o=this.cursorOffset_;const s=this.cursorPosition.column;if(!(e=Math.min(e,this.columnCount_-s)))return 0;const i=e;let n,a;for(;r&&e;){if(e<0){console.error(`Deleting ${i} chars went negative: ${e}`);break}if(n=t.TextAttributes.nodeWidth(r),r.textContent=t.TextAttributes.nodeSubstr(r,0,o)+t.TextAttributes.nodeSubstr(r,o+e),a=t.TextAttributes.nodeWidth(r),r.wcNode&&o<n&&(a&&n==a||!a&&1==o)){const t=this.textAttributes.createContainer(" ");r.parentNode.insertBefore(t,o?r:r.nextSibling),r.textContent="",a=0,e-=1}else e-=n-a;const s=r.nextSibling;0==a&&r!=this.cursorNode_&&r.remove(),r=s,o=0}if(this.cursorNode_.nodeType!=Node.TEXT_NODE&&!this.cursorNode_.textContent){const e=this.cursorNode_;if(e.previousSibling)this.cursorNode_=e.previousSibling,this.cursorOffset_=t.TextAttributes.nodeWidth(e.previousSibling);else if(e.nextSibling)this.cursorNode_=e.nextSibling,this.cursorOffset_=0;else{const e=this.cursorRowNode_.ownerDocument.createTextNode("");this.cursorRowNode_.appendChild(e),this.cursorNode_=e,this.cursorOffset_=0}this.cursorRowNode_.removeChild(e)}return i},t.Screen.prototype.getLineStartRow_=function(e){for(;e.previousSibling&&e.previousSibling.hasAttribute("line-overflow");)e=e.previousSibling;return e},t.Screen.prototype.getLineText_=function(e){let t="",r=e;for(;r&&(t+=r.textContent,r.hasAttribute("line-overflow"));)r=r.nextSibling;return t},t.Screen.prototype.getXRowAncestor_=function(e){let t=e;for(;t&&"X-ROW"!==t.nodeName;)t=t.parentNode;return t},t.Screen.prototype.getPositionWithOverflow_=function(e,r,o){if(!r)return-1;const s=this.getXRowAncestor_(r);if(!s)return-1;let i=0;for(;s!=e;){if(i+=t.TextAttributes.nodeWidth(e),!e.hasAttribute("line-overflow")||!e.nextSibling)return-1;e=e.nextSibling}return i+this.getPositionWithinRow_(e,r,o)},t.Screen.prototype.getPositionWithinRow_=function(e,r,o){if(r.parentNode!=e)return null==r.parentNode?-1:this.getPositionWithinRow_(r.parentNode,r,o)+this.getPositionWithinRow_(e,r.parentNode,0);let s=0;for(let i=0;i<e.childNodes.length;i++){const n=e.childNodes[i];if(n==r)return s+o;s+=t.TextAttributes.nodeWidth(n)}return-1},t.Screen.prototype.getNodeAndOffsetWithOverflow_=function(e,r){for(;e&&r>t.TextAttributes.nodeWidth(e);){if(!e.hasAttribute("line-overflow")||!e.nextSibling)return[null,-1];r-=t.TextAttributes.nodeWidth(e),e=e.nextSibling}return this.getNodeAndOffsetWithinRow_(e,r)},t.Screen.prototype.getNodeAndOffsetWithinRow_=function(e,r){for(let o=0;o<e.childNodes.length;o++){const s=e.childNodes[o],i=t.TextAttributes.nodeWidth(s);if(r<=i)return"SPAN"===s.nodeName?this.getNodeAndOffsetWithinRow_(s,r):[s,r];r-=i}return null},t.Screen.prototype.setRange_=function(e,t,r,o){const s=this.getNodeAndOffsetWithOverflow_(e,t);if(null==s)return;const i=this.getNodeAndOffsetWithOverflow_(e,r);null!=i&&(o.setStart(s[0],s[1]),o.setEnd(i[0],i[1]))},t.Screen.prototype.expandSelectionWithWordBreakMatches_=function(r,o,s,i){if(!r)return;const n=r.getRangeAt(0);if(!n||n.toString().match(/\s/))return;const a=this.getXRowAncestor_(e.notNull(n.startContainer));if(!a)return;const l=this.getLineStartRow_(a);if(!l)return;const c=this.getPositionWithOverflow_(l,e.notNull(n.startContainer),n.startOffset);if(-1==c)return;const h=this.getPositionWithOverflow_(l,e.notNull(n.endContainer),n.endOffset);if(-1==h)return;const u=this.getLineText_(l),d=t.wc.substring(u,0,h),p=new RegExp(o+i+"$"),f=d.search(p);if(-1==f||f>c)return;const g=t.wc.substring(u,c,t.wc.strWidth(u)),m=new RegExp("^"+i+s),b=g.match(m);if(!b)return;const _=c+t.wc.strWidth(b[0]);-1==_||_<h||(this.setRange_(l,f,_,n),r.addRange(n))},t.Screen.prototype.expandSelection=function(t){this.expandSelectionWithWordBreakMatches_(t,e.notNull(this.wordBreakMatchLeft),e.notNull(this.wordBreakMatchRight),e.notNull(this.wordBreakMatchMiddle))},t.Screen.prototype.expandSelectionForUrl=function(e){this.expandSelectionWithWordBreakMatches_(e,"[^\\s[\\](){}<>\"'^!@#$%&*,;:`‘“‹«]","[^\\s[\\](){}<>\"'^!@#$%&*,;:~.`’”›»]","[^\\s[\\](){}<>\"'^]*")},t.Screen.prototype.saveCursorAndState=function(e){this.cursorState_.save(e)},t.Screen.prototype.restoreCursorAndState=function(e){this.cursorState_.restore(e)},t.Screen.CursorState=function(e){this.screen_=e,this.cursor=null,this.textAttributes=null,this.GL=this.GR=this.G0=this.G1=this.G2=this.G3=null},t.Screen.CursorState.prototype.save=function(e){this.cursor=e.terminal.saveCursor(),this.textAttributes=this.screen_.textAttributes.clone(),this.GL=e.GL,this.GR=e.GR,this.G0=e.G0,this.G1=e.G1,this.G2=e.G2,this.G3=e.G3},t.Screen.CursorState.prototype.restore=function(e){e.terminal.restoreCursor(this.cursor);const t=this.textAttributes.clone();t.colorPaletteOverrides=this.screen_.textAttributes.colorPaletteOverrides,t.syncColors(),this.screen_.textAttributes=t,e.GL=this.GL,e.GR=this.GR,e.G0=this.G0,e.G1=this.G1,e.G2=this.G2,e.G3=this.G3},t.RowProvider=function(){},t.RowProvider.prototype.getRowCount=function(){},t.RowProvider.prototype.getRowNode=function(e){},t.ScrollPort=function(e){t.PubSub.addBehavior(this),this.rowProvider_=e,this.characterSize=new t.Size(10,10),this.ruler_=null,this.selection=new t.ScrollPort.Selection(this),this.currentRowNodeCache_=null,this.previousRowNodeCache_={},this.lastScreenWidth_=0,this.lastScreenHeight_=0,this.selectionEnabled_=!0,this.lastRowCount_=0,this.scrollWheelMultiplier_=1,this.lastTouch_={},this.screenPaddingSize=0,this.lineHeightPaddingSize=0,this.isScrolledEnd=!0,this.currentScrollbarWidthPx=t.ScrollPort.DEFAULT_SCROLLBAR_WIDTH,this.ctrlVPaste=!1,this.pasteOnDrop=!0,this.div_=null,this.document_=null,this.screen_=null,this.timeouts_={},this.observers_={},this.ariaHiddenSelectionRows_=[],this.DEBUG_=!1},t.ScrollPort.DEFAULT_SCROLLBAR_WIDTH=12,t.ScrollPort.Selection=function(e){this.scrollPort_=e,this.startRow=null,this.startNode=null,this.startOffset=0,this.endRow=null,this.endNode=null,this.endOffset=0,this.isMultiline=!1,this.isCollapsed=!0,this.autoScrollOnMouseMoveBound_=this.autoScrollOnMouseMove_.bind(this),this.autoScrollEnabled_=!1,this.autoScrollDirection_=1,this.autoScrollInterval_=null,this.autoScrollDelta_=1},t.ScrollPort.Selection.prototype.findFirstChild=function(e,t){let r=e.firstChild;for(;r;){if(-1!=t.indexOf(r))return r;if(r.childNodes.length){const e=this.findFirstChild(r,t);if(e)return e}r=r.nextSibling}return null},t.ScrollPort.Selection.prototype.autoScrollOnMouseMove_=function(e){const t=this.scrollPort_.lastScreenHeight_;this.autoScrollDirection_=2*e.pageY<t?-1:1;const r=this.scrollPort_.screenPaddingSize;e.pageY<r?this.startAutoScroll_():e.pageY<this.scrollPort_.visibleRowsHeight+r?this.stopAutoScroll_():this.startAutoScroll_()},t.ScrollPort.Selection.prototype.setAutoScrollEnabled=function(e){this.autoScrollEnabled_=e;const t=this.scrollPort_.getDocument();e?t.addEventListener("mousemove",this.autoScrollOnMouseMoveBound_):(t.removeEventListener("mousemove",this.autoScrollOnMouseMoveBound_),this.stopAutoScroll_())},t.ScrollPort.Selection.prototype.autoScroll_=function(){this.autoScrollDelta_*=1.2;const e=Math.floor(this.autoScrollDelta_)*this.autoScrollDirection_;this.scrollPort_.scrollRowToTop(this.scrollPort_.getTopRowIndex()+e)},t.ScrollPort.Selection.prototype.startAutoScroll_=function(){this.autoScrollEnabled_&&null===this.autoScrollInterval_&&(this.autoScrollInterval_=setInterval(this.autoScroll_.bind(this),200))},t.ScrollPort.Selection.prototype.stopAutoScroll_=function(){clearInterval(this.autoScrollInterval_),this.autoScrollInterval_=null,this.autoScrollDelta_=1},t.ScrollPort.Selection.prototype.sync=function(){const e=()=>{this.startRow=s,this.startNode=r.anchorNode,this.startOffset=r.anchorOffset,this.endRow=i,this.endNode=n,this.endOffset=a},t=()=>{this.startRow=i,this.startNode=n,this.startOffset=a,this.endRow=s,this.endNode=r.anchorNode,this.endOffset=r.anchorOffset},r=this.scrollPort_.getDocument().getSelection(),o=()=>{this.startRow=null,this.startNode=null,this.startOffset=0,this.endRow=null,this.endNode=null,this.endOffset=0,this.isMultiline=!1,this.isCollapsed=!0};if(!r)return void o();this.isCollapsed=!r||r.isCollapsed;let s=r.anchorNode;for(;s&&"X-ROW"!=s.nodeName;)s=s.parentNode;if(!s)return void o();let i=r.focusNode,n=i,a=r.focusOffset;const l=()=>{i=this.scrollPort_.topFold_.nextSibling,n=i,a=0},c=()=>{for(i=this.scrollPort_.bottomFold_.previousSibling,n=i;n.lastChild;)n=n.lastChild;a=n.length||0};for(i===this.scrollPort_.topFold_?l():i===this.scrollPort_.bottomFold_&&c();i&&"X-ROW"!=i.nodeName;)i=i.parentNode;if(i){if(this.scrollPort_.autoScrollEnabled_){let e=this.scrollPort_.topFold_;for(;null!==(e=e.previousSibling);)e===i&&l();for(e=this.scrollPort_.bottomFold_;null!==(e=e.nextSibling);)e===i&&c()}if(s.rowIndex<i.rowIndex)e();else if(s.rowIndex>i.rowIndex)t();else if(n==r.anchorNode)r.anchorOffset<a?e():t();else{const o=this.findFirstChild(s,[r.anchorNode,n]);if(!o)throw new Error("Unexpected error syncing selection.");o==r.anchorNode?e():t()}this.isMultiline=s.rowIndex!=i.rowIndex}},t.ScrollPort.prototype.decorate=function(e,t){this.div_=e,this.iframe_=e.ownerDocument.createElement("iframe"),this.iframe_.style.cssText="border: 0;height: 100%;position: absolute;width: 100%",e.appendChild(this.iframe_);const r=()=>{this.paintIframeContents_(),t&&t()};"mozInnerScreenX"in globalThis?this.iframe_.addEventListener("load",(()=>r())):r()},t.ScrollPort.prototype.paintIframeContents_=function(){this.iframe_.contentWindow.addEventListener("resize",this.onResize_.bind(this));const e=this.document_=this.iframe_.contentDocument;e.body.style.cssText="margin: 0px;padding: 0px;height: 100%;width: 100%;overflow: hidden;cursor: var(--hterm-mouse-cursor-style);user-select: none;";const r=e.createElement("meta");r.setAttribute("charset","utf-8"),e.head.appendChild(r),this.DEBUG_&&(this.document_.body.style.paddingTop=this.document_.body.style.paddingBottom="calc(var(--hterm-charsize-height) * 3)");const o=e.createElement("style");o.textContent="x-row {  display: block;  height: var(--hterm-charsize-height);  line-height: var(--hterm-charsize-height);}",e.head.appendChild(o),this.userCssLink_=e.createElement("link"),this.userCssLink_.setAttribute("rel","stylesheet"),this.userCssText_=e.createElement("style"),e.head.appendChild(this.userCssText_),this.screen_=e.createElement("x-screen"),this.screen_.setAttribute("contenteditable","true"),this.screen_.setAttribute("spellcheck","false"),this.screen_.setAttribute("autocomplete","off"),this.screen_.setAttribute("autocorrect","off"),this.screen_.setAttribute("autocapitalize","none"),this.screen_.setAttribute("role","log"),this.screen_.setAttribute("aria-live","off"),this.screen_.setAttribute("aria-roledescription","Terminal"),this.screen_.setAttribute("aria-readonly","true"),this.screen_.setAttribute("tabindex","-1"),this.screen_.style.cssText="\n      background-color: rgb(var(--hterm-background-color));\n      caret-color: transparent;\n      color: rgb(var(--hterm-foreground-color));\n      display: block;\n      font-family: monospace;\n      font-size: 15px;\n      font-variant-ligatures: none;\n      height: 100%;\n      overflow-y: scroll; overflow-x: hidden;\n      white-space: pre;\n      width: 100%;\n      outline: none !important;\n  ";this.screen_.addEventListener("scroll",this.onScroll_.bind(this)),this.screen_.addEventListener("wheel",this.onScrollWheel_.bind(this)),this.screen_.addEventListener("touchstart",this.onTouch_.bind(this)),this.screen_.addEventListener("touchmove",this.onTouch_.bind(this)),this.screen_.addEventListener("touchend",this.onTouch_.bind(this)),this.screen_.addEventListener("touchcancel",this.onTouch_.bind(this)),this.screen_.addEventListener("copy",this.onCopy_.bind(this)),this.screen_.addEventListener("paste",this.onPaste_.bind(this)),this.screen_.addEventListener("drop",this.onDragAndDrop_.bind(this)),e.body.addEventListener("keydown",this.onBodyKeyDown_.bind(this));const s="\n    border-style: solid;\n    border-width: 1px;\n    color: rgb(var(--hterm-foreground-color));\n    cursor: pointer;\n    font-family: monospace;\n    font-weight: bold;\n    height: 30px;\n    line-height: 30px;\n    padding: 0 8px;\n    position: fixed;\n    right: var(--hterm-screen-padding-size);\n    text-align: center;\n    z-index: 1;\n  ";this.scrollUpButton_=this.document_.createElement("div"),this.scrollUpButton_.id="hterm:a11y:page-up",this.scrollUpButton_.innerText=t.msg("BUTTON_PAGE_UP",[],"Page up"),this.scrollUpButton_.setAttribute("role","button"),this.scrollUpButton_.style.cssText=s,this.scrollUpButton_.style.top="-32px",this.scrollUpButton_.addEventListener("click",this.scrollPageUp.bind(this)),this.scrollDownButton_=this.document_.createElement("div"),this.scrollDownButton_.id="hterm:a11y:page-down",this.scrollDownButton_.innerText=t.msg("BUTTON_PAGE_DOWN",[],"Page down"),this.scrollDownButton_.setAttribute("role","button"),this.scrollDownButton_.style.cssText=s,this.scrollDownButton_.style.bottom="-32px",this.scrollDownButton_.addEventListener("click",this.scrollPageDown.bind(this)),this.optionsButton_=this.document_.createElement("div"),this.optionsButton_.id="hterm:a11y:options",this.optionsButton_.innerText=t.msg("OPTIONS_BUTTON_LABEL",[],"Options"),this.optionsButton_.setAttribute("role","button"),this.optionsButton_.style.cssText=s,this.optionsButton_.style.bottom="-64px",this.optionsButton_.addEventListener("click",this.publish.bind(this,"options")),e.body.appendChild(this.scrollUpButton_),e.body.appendChild(this.screen_),e.body.appendChild(this.scrollDownButton_),e.body.appendChild(this.optionsButton_),this.allowA11yButtonsToDisplay_=!1,setTimeout((()=>{this.allowA11yButtonsToDisplay_=!0}),500),this.document_.addEventListener("selectionchange",(()=>{if(this.selection.sync(),!this.allowA11yButtonsToDisplay_)return;const e=this.accessibilityReader_&&this.accessibilityReader_.accessibilityEnabled,t=this.document_.getSelection();let r;t.anchorNode&&t.anchorNode.parentElement&&(r=t.anchorNode.parentElement),e&&r==this.scrollUpButton_?this.scrollUpButton_.style.top=`${this.screenPaddingSize}px`:this.scrollUpButton_.style.top="-32px",e&&r==this.scrollDownButton_?this.scrollDownButton_.style.bottom=`${this.screenPaddingSize}px`:this.scrollDownButton_.style.bottom="-32px",e&&r==this.optionsButton_?this.optionsButton_.style.bottom=`${this.screenPaddingSize}px`:this.optionsButton_.style.bottom="-64px"})),this.rowNodes_=e.createElement("div"),this.rowNodes_.id="hterm:row-nodes",this.rowNodes_.style.cssText="display: block;position: fixed;overflow: hidden;user-select: text;",this.screen_.appendChild(this.rowNodes_),this.topSelectBag_=e.createElement("x-select-bag"),this.topSelectBag_.style.cssText="display: block;overflow: hidden;height: var(--hterm-charsize-height);white-space: pre;",this.bottomSelectBag_=this.topSelectBag_.cloneNode(),this.topFold_=e.createElement("x-fold"),this.topFold_.id="hterm:top-fold-for-row-selection",this.topFold_.style.cssText="\n    display: block;\n    height: var(--hterm-screen-padding-size);\n  ",this.rowNodes_.appendChild(this.topFold_),this.bottomFold_=this.topFold_.cloneNode(),this.bottomFold_.id="hterm:bottom-fold-for-row-selection",this.rowNodes_.appendChild(this.bottomFold_),this.scrollArea_=e.createElement("div"),this.scrollArea_.id="hterm:scrollarea",this.scrollArea_.style.cssText="visibility: hidden",this.screen_.appendChild(this.scrollArea_),this.pasteTarget_=e.createElement("textarea"),this.pasteTarget_.id="hterm:ctrl-v-paste-target",this.pasteTarget_.setAttribute("tabindex","-1"),this.pasteTarget_.setAttribute("aria-hidden","true"),this.pasteTarget_.style.cssText="position: absolute;height: 1px;width: 1px;left: 0px; bottom: 0px;opacity: 0",this.pasteTarget_.contentEditable=!0,this.screen_.appendChild(this.pasteTarget_),this.pasteTarget_.addEventListener("textInput",this.handlePasteTargetTextInput_.bind(this)),this.resize()},t.ScrollPort.prototype.setAccessibilityReader=function(e){this.accessibilityReader_=e},t.ScrollPort.prototype.scrollPageUp=function(){if(0==this.getTopRowIndex())return;const e=this.getTopRowIndex();this.scrollRowToTop(e-this.visibleRowCount+1),this.assertiveAnnounce_()},t.ScrollPort.prototype.scrollPageDown=function(){if(this.isScrolledEnd)return;const e=this.getTopRowIndex();this.scrollRowToTop(e+this.visibleRowCount-1),this.assertiveAnnounce_()},t.ScrollPort.prototype.setFontFamily=function(e,t=""){this.screen_.style.fontFamily=e,this.screen_.style.webkitFontSmoothing=t,this.syncCharacterSize()},t.ScrollPort.prototype.getFontFamily=function(){return this.screen_.style.fontFamily},t.ScrollPort.prototype.setUserCssUrl=function(e){e?(this.userCssLink_.setAttribute("href",e),this.userCssLink_.parentNode||this.document_.head.appendChild(this.userCssLink_)):this.userCssLink_.parentNode&&this.document_.head.removeChild(this.userCssLink_)},t.ScrollPort.prototype.setUserCssText=function(e){this.userCssText_.textContent=e},t.ScrollPort.prototype.focus=function(){this.iframe_.focus(),this.screen_.focus(),this.publish("focus")},t.ScrollPort.prototype.blur=function(){this.screen_.blur()},t.ScrollPort.prototype.setBackgroundImage=function(e){this.screen_.style.backgroundImage=e},t.ScrollPort.prototype.setBackgroundSize=function(e){this.screen_.style.backgroundSize=e},t.ScrollPort.prototype.setBackgroundPosition=function(e){this.screen_.style.backgroundPosition=e},t.ScrollPort.prototype.setScreenPaddingSize=function(e){this.screenPaddingSize=e,this.resize()},t.ScrollPort.prototype.setLineHeightPaddingSize=function(e){this.lineHeightPaddingSize=e,this.syncCharacterSize()},t.ScrollPort.prototype.setCtrlVPaste=function(e){this.ctrlVPaste=e},t.ScrollPort.prototype.setPasteOnDrop=function(e){this.pasteOnDrop=e},t.ScrollPort.prototype.getScreenSize=function(){const e=this.screen_.getBoundingClientRect(),t=Math.max(this.screenPaddingSize,this.currentScrollbarWidthPx);return{height:e.height-2*this.screenPaddingSize,width:e.width-this.screenPaddingSize-t}},t.ScrollPort.prototype.getScreenWidth=function(){return this.getScreenSize().width},t.ScrollPort.prototype.getScreenHeight=function(){return this.getScreenSize().height},t.ScrollPort.prototype.getScrollbarX=function(){return this.screen_.getBoundingClientRect().width-this.currentScrollbarWidthPx},t.ScrollPort.prototype.getDocument=function(){return this.document_},t.ScrollPort.prototype.getScreenNode=function(){return this.screen_},t.ScrollPort.prototype.resetCache=function(){this.currentRowNodeCache_=null,this.previousRowNodeCache_={}},t.ScrollPort.prototype.setRowProvider=function(e){this.resetCache(),this.rowProvider_=e,this.scheduleRedraw()},t.ScrollPort.prototype.invalidate=function(){let e=this.topFold_.nextSibling;for(;e!=this.bottomFold_;){const t=e.nextSibling;e.remove(),e=t}this.previousRowNodeCache_=null;const t=this.getTopRowIndex(),r=this.getBottomRowIndex(t);this.drawVisibleRows_(t,r)},t.ScrollPort.prototype.scheduleInvalidate=function(){this.timeouts_.invalidate||(this.timeouts_.invalidate=setTimeout((()=>{delete this.timeouts_.invalidate,this.invalidate()})))},t.ScrollPort.prototype.setFontSize=function(e){this.screen_.style.fontSize=e+"px",this.syncCharacterSize()},t.ScrollPort.prototype.getFontSize=function(){return parseInt(this.screen_.style.fontSize,10)},t.ScrollPort.prototype.measureCharacterSize=function(e=""){let r=this.ruler_;r||(r=this.ruler_=this.document_.createElement("canvas"));const o=r.getContext("2d");o.font=`${e} ${this.getFontSize()}px ${this.getFontFamily()}`;const s=o.measureText("X█"),i=s.actualBoundingBoxAscent||s.fontBoundingBoxAscent,n=s.actualBoundingBoxDescent||s.fontBoundingBoxDescent,a=o.measureText("X");return new t.Size(a.width,i+n+this.lineHeightPaddingSize)},t.ScrollPort.prototype.syncCharacterSize=function(){this.characterSize=this.measureCharacterSize(),this.resize()},t.ScrollPort.prototype.resize=function(){this.syncScrollbarWidth_(),this.syncScrollHeight(),this.syncRowNodesDimensions_(),this.publish("resize",{scrollPort:this},(()=>this.scheduleRedraw()))},t.ScrollPort.prototype.assertiveAnnounce_=function(){if(!this.accessibilityReader_)return;const e=this.getTopRowIndex(),r=this.getBottomRowIndex(e);let o=100*e/Math.max(1,this.rowProvider_.getRowCount()-this.visibleRowCount);o=Math.min(100,Math.round(o));let s=t.msg("ANNOUNCE_CURRENT_SCREEN_HEADER",[o],"$1% scrolled,");s+="\n";for(let t=e;t<=r;++t){s+=this.fetchRowNode_(t).textContent+"\n"}this.accessibilityReader_.assertiveAnnounce(s)},t.ScrollPort.prototype.syncRowNodesDimensions_=function(){const t=this.getScreenSize();this.lastScreenWidth_=t.width,this.lastScreenHeight_=t.height,this.visibleRowCount=e.f.smartFloorDivide(t.height,this.characterSize.height),this.visibleRowsHeight=this.visibleRowCount*this.characterSize.height,this.visibleRowTopMargin=0,this.visibleRowBottomMargin=t.height-this.visibleRowsHeight,this.topFold_.style.marginBottom=this.visibleRowTopMargin+"px";let r=0,o=this.topFold_.previousSibling;for(;o;)r+=o.getBoundingClientRect().height,o=o.previousSibling;this.rowNodes_.style.width=t.width+"px",this.rowNodes_.style.height=this.visibleRowsHeight+r+this.screenPaddingSize+"px",this.rowNodes_.style.left=this.screen_.offsetLeft+this.screenPaddingSize+"px",this.rowNodes_.style.top=this.screen_.offsetTop-r+"px"},t.ScrollPort.prototype.syncScrollbarWidth_=function(){const e=this.screen_.getBoundingClientRect().width-this.screen_.clientWidth;e>0&&(this.currentScrollbarWidthPx=e)},t.ScrollPort.prototype.syncScrollHeight=function(){this.lastRowCount_=this.rowProvider_.getRowCount(),this.scrollArea_.style.height=this.characterSize.height*this.lastRowCount_+2*this.screenPaddingSize+this.visibleRowTopMargin+this.visibleRowBottomMargin+"px"},t.ScrollPort.prototype.scheduleRedraw=function(){this.timeouts_.redraw||(this.timeouts_.redraw=setTimeout((()=>{delete this.timeouts_.redraw,this.redraw_()})))},t.ScrollPort.prototype.updateScrollButtonState_=function(){const e=(e,t)=>{e.setAttribute("aria-disabled",t?"true":"false"),e.style.opacity=t?.5:1};e(this.scrollUpButton_,0==this.getTopRowIndex()),e(this.scrollDownButton_,this.isScrolledEnd)},t.ScrollPort.prototype.redraw_=function(){this.resetSelectBags_(),this.selection.sync(),this.syncScrollHeight(),this.currentRowNodeCache_={};const e=this.getTopRowIndex(),t=this.getBottomRowIndex(e);this.drawTopFold_(e),this.drawBottomFold_(t),this.drawVisibleRows_(e,t),this.ariaHideOffscreenSelectionRows_(e,t),this.syncRowNodesDimensions_(),this.previousRowNodeCache_=this.currentRowNodeCache_,this.currentRowNodeCache_=null,this.isScrolledEnd=this.getTopRowIndex()+this.visibleRowCount>=this.lastRowCount_,this.updateScrollButtonState_()},t.ScrollPort.prototype.drawTopFold_=function(e){if(!this.selection.startRow||this.selection.startRow.rowIndex>=e)this.rowNodes_.firstChild!=this.topFold_&&this.rowNodes_.insertBefore(this.topFold_,this.rowNodes_.firstChild);else{if(!this.selection.isMultiline||this.selection.endRow.rowIndex>=e)this.selection.startRow.nextSibling!=this.topFold_&&this.rowNodes_.insertBefore(this.topFold_,this.selection.startRow.nextSibling);else for(this.selection.endRow.nextSibling!=this.topFold_&&this.rowNodes_.insertBefore(this.topFold_,this.selection.endRow.nextSibling);this.selection.startRow.nextSibling!=this.selection.endRow;)this.rowNodes_.removeChild(this.selection.startRow.nextSibling);for(;this.rowNodes_.firstChild!=this.selection.startRow;)this.rowNodes_.removeChild(this.rowNodes_.firstChild)}},t.ScrollPort.prototype.drawBottomFold_=function(e){if(!this.selection.endRow||this.selection.endRow.rowIndex<=e)this.rowNodes_.lastChild!=this.bottomFold_&&this.rowNodes_.appendChild(this.bottomFold_);else{if(!this.selection.isMultiline||this.selection.startRow.rowIndex<=e)this.bottomFold_.nextSibling!=this.selection.endRow&&this.rowNodes_.insertBefore(this.bottomFold_,this.selection.endRow);else for(this.bottomFold_.nextSibling!=this.selection.startRow&&this.rowNodes_.insertBefore(this.bottomFold_,this.selection.startRow);this.selection.startRow.nextSibling!=this.selection.endRow;)this.rowNodes_.removeChild(this.selection.startRow.nextSibling);for(;this.rowNodes_.lastChild!=this.selection.endRow;)this.rowNodes_.removeChild(this.rowNodes_.lastChild)}},t.ScrollPort.prototype.drawVisibleRows_=function(e,t){const r=(e,t)=>{for(;e!=t;){if(!e)throw new Error("Did not encounter target node");if(e==this.bottomFold_)throw new Error("Encountered bottom fold before target node");const t=e;e=e.nextSibling,t.remove()}},o=this.selection.startRow,s=this.selection.endRow,i=this.bottomFold_;let n=this.topFold_.nextSibling;const a=Math.min(this.visibleRowCount,this.rowProvider_.getRowCount());for(let t=0;t<a;t++){const a=e+t;if(n==i){const e=this.fetchRowNode_(a);if(!e){console.log("Couldn't fetch row index: "+a);break}this.rowNodes_.insertBefore(e,n);continue}if(n.rowIndex==a){n=n.nextSibling;continue}if(o&&o.rowIndex==a){r(n,o),n=o.nextSibling;continue}if(s&&s.rowIndex==a){r(n,s),n=s.nextSibling;continue}if(n==o||n==s){const e=this.fetchRowNode_(a);if(!e){console.log("Couldn't fetch row index: "+a);break}this.rowNodes_.insertBefore(e,n);continue}const l=this.fetchRowNode_(a);if(!l){console.log("Couldn't fetch row index: "+a);break}n!=l?(this.rowNodes_.insertBefore(l,n),this.rowNodes_.removeChild(n),n=l.nextSibling):n=n.nextSibling}n!=this.bottomFold_&&r(n,i)},t.ScrollPort.prototype.ariaHideOffscreenSelectionRows_=function(e,t){const r=this.ariaHiddenSelectionRows_;let o;for(;o=r.pop();)o.removeAttribute("aria-hidden");function s(o){o&&(o.rowIndex<e||o.rowIndex>t)&&(o.setAttribute("aria-hidden","true"),r.push(o))}s(this.selection.startRow),s(this.selection.endRow)},t.ScrollPort.prototype.resetSelectBags_=function(){this.topSelectBag_.parentNode&&(this.topSelectBag_.textContent="",this.topSelectBag_.remove()),this.bottomSelectBag_.parentNode&&(this.bottomSelectBag_.textContent="",this.bottomSelectBag_.remove())},t.ScrollPort.prototype.cacheRowNode_=function(e){this.currentRowNodeCache_[e.rowIndex]=e},t.ScrollPort.prototype.fetchRowNode_=function(e){let t;return t=this.previousRowNodeCache_&&e in this.previousRowNodeCache_?this.previousRowNodeCache_[e]:this.rowProvider_.getRowNode(e),this.currentRowNodeCache_&&this.cacheRowNode_(t),t},t.ScrollPort.prototype.selectAll=function(){let e;if(0!=this.topFold_.nextSibling.rowIndex){for(;this.topFold_.previousSibling;)this.topFold_.previousSibling.remove();e=this.fetchRowNode_(0),this.rowNodes_.insertBefore(e,this.topFold_),this.syncRowNodesDimensions_()}else e=this.topFold_.nextSibling;const t=this.rowProvider_.getRowCount()-1;let r;if(this.bottomFold_.previousSibling.rowIndex!=t){for(;this.bottomFold_.nextSibling;)this.bottomFold_.nextSibling.remove();r=this.fetchRowNode_(t),this.rowNodes_.appendChild(r)}else r=this.bottomFold_.previousSibling;let o=r;for(;o.lastChild;)o=o.lastChild;const s=this.document_.getSelection();s.collapse(e,0),s.extend(o,o.length||0),this.selection.sync()},t.ScrollPort.prototype.getScrollMax_=function(){return this.scrollArea_.getBoundingClientRect().height+this.visibleRowTopMargin+this.visibleRowBottomMargin-this.screen_.getBoundingClientRect().height},t.ScrollPort.prototype.scrollRowToTop=function(e){e<0&&(e=0),this.syncScrollHeight(),this.isScrolledEnd=e+this.visibleRowCount>=this.lastRowCount_;let t=e*this.characterSize.height+this.visibleRowTopMargin;const r=this.getScrollMax_();t>r&&(t=r),this.screen_.scrollTop!=t&&(this.screen_.scrollTop=t,this.scheduleRedraw())},t.ScrollPort.prototype.scrollRowToBottom=function(e){this.scrollRowToTop(e-this.visibleRowCount)},t.ScrollPort.prototype.scrollRowToMiddle=function(e){this.scrollRowToTop(e-Math.floor(this.visibleRowCount/2))},t.ScrollPort.prototype.getTopRowIndex=function(){return Math.round(this.screen_.scrollTop/this.characterSize.height)},t.ScrollPort.prototype.getBottomRowIndex=function(e){return e+this.visibleRowCount-1},t.ScrollPort.prototype.onScroll_=function(e){const t=this.getScreenSize();t.width==this.lastScreenWidth_&&t.height==this.lastScreenHeight_?(this.redraw_(),this.publish("scroll",{scrollPort:this})):this.resize()},t.ScrollPort.prototype.onScrollWheel=function(e){},t.ScrollPort.prototype.onScrollWheel_=function(e){if(this.onScrollWheel(e),e.defaultPrevented)return;const t=this.scrollWheelDelta(e);let r=this.screen_.scrollTop-t.y;r<0&&(r=0);const o=this.getScrollMax_();r>o&&(r=o),r!=this.screen_.scrollTop?(this.screen_.scrollTop=r,e.preventDefault()):e.ctrlKey&&e.preventDefault()},t.ScrollPort.prototype.scrollWheelDelta=function(e){const t={x:0,y:0};switch(e.deltaMode){case WheelEvent.DOM_DELTA_PIXEL:t.x=e.deltaX*this.scrollWheelMultiplier_,t.y=e.deltaY*this.scrollWheelMultiplier_;break;case WheelEvent.DOM_DELTA_LINE:t.x=e.deltaX*this.characterSize.width,t.y=e.deltaY*this.characterSize.height;break;case WheelEvent.DOM_DELTA_PAGE:{const{width:r,height:o}=this.screen_.getBoundingClientRect();t.x=e.deltaX*this.characterSize.width*r,t.y=e.deltaY*this.characterSize.height*o;break}}return t.y*=-1,t},t.ScrollPort.prototype.onTouch=function(e){},t.ScrollPort.prototype.onTouch_=function(e){if(this.onTouch(e),e.defaultPrevented)return;const r=function(e){return{id:e.identifier,y:e.clientY,x:e.clientX}};let o,s;switch(e.type){case"touchstart":for("cros"==t.os&&globalThis.chrome?.windows?.getCurrent&&chrome.windows.getCurrent((e=>{e.focused||chrome.windows.update(e.id,{focused:!0})})),o=0;o<e.changedTouches.length;++o)s=r(e.changedTouches[o]),this.lastTouch_[s.id]=s;break;case"touchcancel":case"touchend":for(o=0;o<e.changedTouches.length;++o)delete this.lastTouch_[e.changedTouches[o].identifier];break;case"touchmove":{let t=0;for(o=0;o<e.changedTouches.length;++o)s=r(e.changedTouches[o]),t+=this.lastTouch_[s.id].y-s.y,this.lastTouch_[s.id]=s;t*=-1;let i=this.screen_.scrollTop-t;i<0&&(i=0);const n=this.getScrollMax_();i>n&&(i=n),i!=this.screen_.scrollTop&&(this.screen_.scrollTop=i);break}}e.preventDefault()},t.ScrollPort.prototype.onResize_=function(e){this.syncCharacterSize()},t.ScrollPort.prototype.onCopy=function(e){},t.ScrollPort.prototype.onCopy_=function(e){if(this.onCopy(e),e.defaultPrevented)return;if(this.resetSelectBags_(),this.selection.sync(),this.selection.isCollapsed||this.selection.endRow.rowIndex-this.selection.startRow.rowIndex<2)return;const t=this.getTopRowIndex(),r=this.getBottomRowIndex(t);if(this.selection.startRow.rowIndex<t){let e;e=this.selection.endRow.rowIndex<t?this.selection.endRow.rowIndex:this.topFold_.nextSibling.rowIndex,this.topSelectBag_.textContent=this.rowProvider_.getRowsText(this.selection.startRow.rowIndex+1,e),this.rowNodes_.insertBefore(this.topSelectBag_,this.selection.startRow.nextSibling),this.syncRowNodesDimensions_()}if(this.selection.endRow.rowIndex>r){let e;e=this.selection.startRow.rowIndex>r?this.selection.startRow.rowIndex+1:this.bottomFold_.previousSibling.rowIndex+1,this.bottomSelectBag_.textContent=this.rowProvider_.getRowsText(e,this.selection.endRow.rowIndex),this.rowNodes_.insertBefore(this.bottomSelectBag_,this.selection.endRow)}},t.ScrollPort.prototype.onBodyKeyDown_=function(e){this.ctrlVPaste&&(e.ctrlKey||e.metaKey)&&86==e.keyCode&&this.pasteTarget_.focus()},t.ScrollPort.prototype.onPaste_=function(e){this.pasteTarget_.focus(),setTimeout((()=>{this.publish("paste",{text:this.pasteTarget_.value}),this.pasteTarget_.value="",this.focus()}))},t.ScrollPort.prototype.handlePasteTargetTextInput_=function(e){e.stopPropagation()},t.ScrollPort.prototype.onDragAndDrop_=function(e){if(!this.pasteOnDrop)return;let t,r;e.preventDefault(),e.shiftKey&&(e.dataTransfer.types.forEach((e=>{!r&&"text/plain"!=e&&e.startsWith("text/")&&(r=e)})),r&&(t=e.dataTransfer.getData(r))),t||(t=e.dataTransfer.getData("text/plain")),t&&this.publish("paste",{text:t})},t.ScrollPort.prototype.setScrollbarVisible=function(e){e?(this.screen_.style.overflowY="scroll",this.currentScrollbarWidthPx=t.ScrollPort.DEFAULT_SCROLLBAR_WIDTH,this.syncScrollbarWidth_()):(this.screen_.style.overflowY="hidden",this.currentScrollbarWidthPx=0)},t.ScrollPort.prototype.setScrollWheelMoveMultipler=function(e){this.scrollWheelMultiplier_=e},t.Terminal=function({profileId:r,storage:o}={}){this.ready_=!1,this.profileId_=null,this.storage_=o||new e.Storage.Local,this.prefs_=null,this.primaryScreen_=new t.Screen,this.alternateScreen_=new t.Screen,this.screen_=this.primaryScreen_,this.screenSize=new t.Size(0,0),this.scrollPort_=new t.ScrollPort(this),this.scrollPort_.subscribe("resize",this.onResize_.bind(this)),this.scrollPort_.subscribe("scroll",this.onScroll_.bind(this)),this.scrollPort_.subscribe("paste",this.onPaste_.bind(this)),this.scrollPort_.subscribe("focus",this.onScrollportFocus_.bind(this)),this.scrollPort_.subscribe("options",this.onOpenOptionsPage_.bind(this)),this.scrollPort_.onCopy=this.onCopy_.bind(this),this.div_=null,this.notifications_=null,this.document_=globalThis.document,this.scrollbackRows_=[],this.tabStops_=[],this.defaultTabStops=!0,this.vtScrollTop_=null,this.vtScrollBottom_=null,this.cursorNode_=null,this.cursorShape_=t.Terminal.cursorShape.BLOCK,this.cursorBlinkCycle_=[100,100],this.cursorBlinkPause_=!1,this.cursorOffScreen_=!1,this.myOnCursorBlink_=this.onCursorBlink_.bind(this),this.backgroundColor_=null,this.foregroundColor_=null,this.colorPaletteOverrides_=new Map,this.screenBorderSize_=0,this.scrollOnOutput_=null,this.scrollOnKeystroke_=null,this.scrollWheelArrowKeys_=null,this.defeatMouseReports_=!1,this.setAutomaticMouseHiding(),this.mouseHideDelay_=null,this.bellAudio_=this.document_.createElement("audio"),this.bellAudio_.id="hterm:bell-audio",this.bellAudio_.setAttribute("preload","auto"),this.accessibilityReader_=null,this.contextMenu=new t.ContextMenu,this.bellNotificationList_=[],this.bellSquelchTimeout_=null,this.desktopNotificationBell_=!1,this.savedOptions_={},this.options_=new t.Options,this.timeouts_={},this.vt=new t.VT(this),this.saveCursorAndState(!0),this.keyboard=new t.Keyboard(this),this.io=new t.Terminal.IO(this),this.enableMouseDragScroll=!0,this.copyOnSelect=null,this.mouseRightClickPaste=null,this.mousePasteButton=null,this.useDefaultWindowCopy=!1,this.clearSelectionAfterCopy=!0,this.realizeSize_(80,24),this.setDefaultTabStops(),this.allowImagesInline=null,this.reportFocus=!1,this.alwaysUseLegacyPasting=!1,this.setProfile(r||t.Terminal.DEFAULT_PROFILE_ID,(()=>{t.initPromise.then((()=>this.onTerminalReady()))})),this.findBar=new t.FindBar(this)},t.Terminal.DEFAULT_PROFILE_ID="default",t.Terminal.cursorShape={BLOCK:"BLOCK",BEAM:"BEAM",UNDERLINE:"UNDERLINE"},t.Terminal.prototype.onTerminalReady=function(){},t.Terminal.prototype.tabWidth=8,t.Terminal.prototype.setProfile=function(r,o=void 0){if(r=r.replace(/\//g,""),this.profileId_===r)return void(o&&o());if(this.profileId_=r,this.prefs_)return void this.prefs_.setProfile(r).then(o);this.prefs_=new t.PreferenceManager(this.storage_,this.profileId_);const s=(e=null,t=!1)=>{this.keyboard.bindings.clear(),null===e&&(e={}),e instanceof Object||(console.error("Error in keybindings preference: Expected object"),e={});try{this.keyboard.bindings.addBindings(e,!!t)}catch(e){console.error("Error in keybindings preference: "+e)}};this.prefs_.addObservers(null,{"alt-gr-mode":e=>{e=null==e?"en-us"==navigator.language.toLowerCase()?"none":"right-alt":"string"==typeof e?e.toLowerCase():"none",/^(none|ctrl-alt|left-alt|right-alt)$/.test(e)||(e="none"),this.keyboard.altGrMode=e},"alt-backspace-is-meta-backspace":e=>{this.keyboard.altBackspaceIsMetaBackspace=e},"alt-is-meta":e=>{this.keyboard.altIsMeta=e},"alt-sends-what":e=>{/^(escape|8-bit|browser-key)$/.test(e)||(e="escape"),this.keyboard.altSendsWhat=e},"audible-bell-sound":t=>{const r=t.match(/^lib-resource:(\S+)/);if(r){const t=r[1];if(void 0===e.resource.get(t))return console.warn(`Invalid resource name '${t}'`),void this.prefs_.reset("audible-bell-sound");this.bellAudio_.setAttribute("src",e.resource.getDataUrl(t))}else this.bellAudio_.setAttribute("src",t)},"desktop-notification-bell":e=>{e&&Notification?(this.desktopNotificationBell_="granted"===Notification.permission,this.desktopNotificationBell_||console.warn("desktop-notification-bell is true but we do not have permission to display notifications.")):this.desktopNotificationBell_=!1},"background-color":e=>{this.setBackgroundColor(e)},"background-image":e=>{this.scrollPort_.setBackgroundImage(e)},"background-size":e=>{this.scrollPort_.setBackgroundSize(e)},"background-position":e=>{this.scrollPort_.setBackgroundPosition(e)},"backspace-sends-backspace":e=>{this.keyboard.backspaceSendsBackspace=e},"character-map-overrides":e=>{null==e||e instanceof Object?(this.vt.characterMaps.reset(),this.vt.characterMaps.setOverrides(e)):console.warn("Preference character-map-modifications is not an object: "+e)},"cursor-blink":e=>{this.setCursorBlink(!!e)},"cursor-shape":e=>{this.setCursorShape(e)},"cursor-blink-cycle":e=>{e instanceof Array&&"number"==typeof e[0]&&"number"==typeof e[1]?this.cursorBlinkCycle_=e:this.cursorBlinkCycle_="number"==typeof e?[e,e]:[100,100]},"cursor-color":e=>{this.setCursorColor(e)},"color-palette-overrides":t=>{if(null==t||t instanceof Object||t instanceof Array){if(e.colors.stockPalette.forEach(((e,t)=>this.setColorPalette(t,e))),this.colorPaletteOverrides_.clear(),t)for(const r in t){const o=parseInt(r,10);if(isNaN(o)||o<0||o>255)console.log("Invalid value in palette: "+r+": "+t[r]);else if(t[o]){const r=e.colors.normalizeCSS(t[o]);r&&(this.setColorPalette(o,r),this.colorPaletteOverrides_.set(o,r))}}this.primaryScreen_.textAttributes.colorPaletteOverrides=[],this.alternateScreen_.textAttributes.colorPaletteOverrides=[]}else console.warn("Preference color-palette-overrides is not an array or object: "+t)},"copy-on-select":e=>{this.copyOnSelect=!!e},"use-default-window-copy":e=>{this.useDefaultWindowCopy=!!e},"clear-selection-after-copy":e=>{this.clearSelectionAfterCopy=!!e},"ctrl-plus-minus-zero-zoom":e=>{this.keyboard.ctrlPlusMinusZeroZoom=e},"ctrl-c-copy":e=>{this.keyboard.ctrlCCopy=e},"ctrl-v-paste":e=>{this.keyboard.ctrlVPaste=e,this.scrollPort_.setCtrlVPaste(e)},"paste-on-drop":e=>{this.scrollPort_.setPasteOnDrop(e)},"east-asian-ambiguous-as-two-column":e=>{t.wc.regardCjkAmbiguous=e},"enable-8-bit-control":e=>{this.vt.enable8BitControl=!!e},"enable-bold":e=>{this.syncBoldSafeState()},"enable-bold-as-bright":e=>{this.primaryScreen_.textAttributes.enableBoldAsBright=!!e,this.alternateScreen_.textAttributes.enableBoldAsBright=!!e},"enable-blink":e=>{this.setTextBlink(!!e)},"enable-clipboard-write":e=>{this.vt.enableClipboardWrite=!!e},"enable-dec12":e=>{this.vt.enableDec12=!!e},"enable-csi-j-3":e=>{this.vt.enableCsiJ3=!!e},"find-result-color":e=>{this.findBar.setFindResultColor(e)},"find-result-selected-color":e=>{this.findBar.setFindResultSelectedColor(e)},"font-family":e=>{this.syncFontFamily()},"font-size":e=>{e=parseInt(e,10),isNaN(e)||e<=0?console.error(`Invalid font size: ${e}`):this.setFontSize(e)},"font-smoothing":e=>{this.syncFontFamily()},"foreground-color":e=>{this.setForegroundColor(e)},"hide-mouse-while-typing":e=>{this.setAutomaticMouseHiding(e)},"home-keys-scroll":e=>{this.keyboard.homeKeysScroll=e},keybindings:e=>{s(e,this.prefs_.get("keybindings-os-defaults"))},"keybindings-os-defaults":e=>{s(this.prefs_.get("keybindings"),e)},"line-height-padding-size":e=>{e=parseFloat(e),isNaN(e)?console.error(`Invalid line height padding size: ${e}`):this.setLineHeightPaddingSize(e)},"media-keys-are-fkeys":e=>{this.keyboard.mediaKeysAreFKeys=e},"meta-sends-escape":e=>{this.keyboard.metaSendsEscape=e},"mouse-right-click-paste":e=>{this.mouseRightClickPaste=e},"mouse-paste-button":e=>{this.syncMousePasteButton()},"page-keys-scroll":e=>{this.keyboard.pageKeysScroll=e},"pass-alt-number":e=>{null==e&&(e="mac"!==t.os&&"popup"!==t.windowType&&"app"!==t.windowType),this.passAltNumber=e},"pass-ctrl-number":e=>{null==e&&(e="mac"!==t.os&&"popup"!==t.windowType&&"app"!==t.windowType),this.passCtrlNumber=e},"pass-ctrl-n":e=>{this.passCtrlN=e},"pass-ctrl-t":e=>{this.passCtrlT=e},"pass-ctrl-tab":e=>{this.passCtrlTab=e},"pass-ctrl-w":e=>{this.passCtrlW=e},"pass-meta-number":e=>{null==e&&(e="mac"===t.os&&"popup"!==t.windowType&&"app"!==t.windowType),this.passMetaNumber=e},"pass-meta-v":e=>{this.keyboard.passMetaV=e},"screen-padding-size":e=>{e=parseInt(e,10),isNaN(e)||e<0?console.error(`Invalid screen padding size: ${e}`):this.setScreenPaddingSize(e)},"screen-border-size":e=>{e=parseInt(e,10),isNaN(e)||e<0?console.error(`Invalid screen border size: ${e}`):this.setScreenBorderSize(e)},"screen-border-color":e=>{this.div_.style.borderColor=e},"scroll-on-keystroke":e=>{this.scrollOnKeystroke_=e},"scroll-on-output":e=>{this.scrollOnOutput_=e},"scrollbar-visible":e=>{this.setScrollbarVisible(e)},"scroll-wheel-may-send-arrow-keys":e=>{this.scrollWheelArrowKeys_=e},"scroll-wheel-move-multiplier":e=>{this.setScrollWheelMoveMultipler(e)},"shift-insert-paste":e=>{this.keyboard.shiftInsertPaste=e},"terminal-encoding":e=>{this.vt.setEncoding(e)},"user-css":e=>{this.scrollPort_.setUserCssUrl(e)},"user-css-text":e=>{this.scrollPort_.setUserCssText(e)},"word-break-match-left":e=>{this.primaryScreen_.wordBreakMatchLeft=e,this.alternateScreen_.wordBreakMatchLeft=e},"word-break-match-right":e=>{this.primaryScreen_.wordBreakMatchRight=e,this.alternateScreen_.wordBreakMatchRight=e},"word-break-match-middle":e=>{this.primaryScreen_.wordBreakMatchMiddle=e,this.alternateScreen_.wordBreakMatchMiddle=e},"allow-images-inline":e=>{this.allowImagesInline=e}}),this.prefs_.readStorage().then((()=>{this.prefs_.notifyAll(),o&&(this.ready_=!0,setTimeout((()=>o())))}))},t.Terminal.prototype.getPrefs=function(){return e.notNull(this.prefs_)},t.Terminal.prototype.setBracketedPaste=function(e){this.options_.bracketedPaste=e},t.Terminal.prototype.setCursorColor=function(e){void 0===e&&(e=this.prefs_.getString("cursor-color")),this.setCssVar("cursor-color",e)},t.Terminal.prototype.getCursorColor=function(){return this.getCssVar("cursor-color")},t.Terminal.prototype.setSelectionEnabled=function(e){this.enableMouseDragScroll=e},t.Terminal.prototype.setBackgroundImage=function(e){void 0===e&&(e=this.prefs_.getString("background-image")),this.scrollPort_.setBackgroundImage(e)},t.Terminal.prototype.setBackgroundColor=function(t){void 0===t&&(t=this.prefs_.getString("background-color")),this.backgroundColor_=e.colors.normalizeCSS(t),this.setRgbColorCssVar("background-color",this.backgroundColor_)},t.Terminal.prototype.getBackgroundColor=function(){return this.backgroundColor_},t.Terminal.prototype.setForegroundColor=function(t){void 0===t&&(t=this.prefs_.getString("foreground-color")),this.foregroundColor_=e.colors.normalizeCSS(t),this.setRgbColorCssVar("foreground-color",this.foregroundColor_)},t.Terminal.prototype.getForegroundColor=function(){return this.foregroundColor_},t.Terminal.prototype.isPrimaryScreen=function(){return this.screen_==this.primaryScreen_},t.Terminal.prototype.installKeyboard=function(){this.keyboard.installKeyboard(this.scrollPort_.getDocument().body)},t.Terminal.prototype.uninstallKeyboard=function(){this.keyboard.installKeyboard(null)},t.Terminal.prototype.setCssVar=function(e,t,r="--hterm-"){this.document_.documentElement.style.setProperty(`${r}${e}`,t.toString())},t.Terminal.prototype.setRgbColorCssVar=function(t,r){const o=r?e.colors.crackRGB(r):null;o&&this.setCssVar(t,o.slice(0,3).join(","))},t.Terminal.prototype.setColorPalette=function(e,t){e>=0&&e<256&&null!=t&&t!=this.getColorPalette[e]&&(this.setRgbColorCssVar(`color-${e}`,t),this.screen_.textAttributes.colorPaletteOverrides[e]=t)},t.Terminal.prototype.getColorPalette=function(t){return this.screen_.textAttributes.colorPaletteOverrides[t]||this.colorPaletteOverrides_.get(t)||e.colors.stockPalette[t]},t.Terminal.prototype.resetColor=function(t){this.setColorPalette(t,this.colorPaletteOverrides_.get(t)||e.colors.stockPalette[t]),delete this.screen_.textAttributes.colorPaletteOverrides[t]},t.Terminal.prototype.resetColorPalette=function(){this.screen_.textAttributes.colorPaletteOverrides.forEach(((e,t)=>this.resetColor(t)))},t.Terminal.prototype.getCssVar=function(e,t="--hterm-"){return this.document_.documentElement.style.getPropertyValue(`${t}${e}`)},t.Terminal.prototype.getScrollPort=function(){return this.scrollPort_},t.Terminal.prototype.updateCssCharsize_=function(){this.setCssVar("charsize-width",this.scrollPort_.characterSize.width+"px"),this.setCssVar("charsize-height",this.scrollPort_.characterSize.height+"px")},t.Terminal.prototype.setFontSize=function(e){e<=0&&(e=this.prefs_.getNumber("font-size")),this.scrollPort_.setFontSize(e),this.setCssVar("font-size",`${e}px`),this.updateCssCharsize_()},t.Terminal.prototype.getFontSize=function(){return this.scrollPort_.getFontSize()},t.Terminal.prototype.getFontFamily=function(){return this.scrollPort_.getFontFamily()},t.Terminal.prototype.syncFontFamily=function(){this.scrollPort_.setFontFamily(this.prefs_.getString("font-family"),this.prefs_.getString("font-smoothing")),this.updateCssCharsize_(),this.syncBoldSafeState()},t.Terminal.prototype.syncMousePasteButton=function(){const e=this.prefs_.get("mouse-paste-button");"number"!=typeof e?"linux"!=t.os?this.mousePasteButton=1:this.mousePasteButton=2:this.mousePasteButton=e},t.Terminal.prototype.syncBoldSafeState=function(){const e=this.prefs_.get("enable-bold");if(null!==e)return this.primaryScreen_.textAttributes.enableBold=e,void(this.alternateScreen_.textAttributes.enableBold=e);const t=this.scrollPort_.measureCharacterSize(),r=this.scrollPort_.measureCharacterSize("bold"),o=t.equals(r);o||console.warn("Bold characters disabled: Size of bold weight differs from normal.  Font family is: "+this.scrollPort_.getFontFamily()),this.primaryScreen_.textAttributes.enableBold=o,this.alternateScreen_.textAttributes.enableBold=o},t.Terminal.prototype.setTextBlink=function(e){void 0===e&&(e=this.prefs_.getBoolean("enable-blink")),this.setCssVar("blink-node-duration",e?"0.7s":"0")},t.Terminal.prototype.syncMouseStyle=function(){this.setCssVar("mouse-cursor-style",this.vt.mouseReport==this.vt.MOUSE_REPORT_DISABLED?"var(--hterm-mouse-cursor-text)":"var(--hterm-mouse-cursor-default)")},t.Terminal.prototype.saveCursor=function(){return this.screen_.cursorPosition.clone()},t.Terminal.prototype.getTextAttributes=function(){return this.screen_.textAttributes},t.Terminal.prototype.setTextAttributes=function(e){this.screen_.textAttributes=e},t.Terminal.prototype.setWindowTitle=function(e){globalThis.document.title=e},t.Terminal.prototype.setWindowName=function(e){},t.Terminal.prototype.restoreCursor=function(t){const r=e.f.clamp(t.row,0,this.screenSize.height-1),o=e.f.clamp(t.column,0,this.screenSize.width-1);this.screen_.setCursorPosition(r,o),(t.column>o||t.column==o&&t.overflow)&&(this.screen_.cursorPosition.overflow=!0)},t.Terminal.prototype.clearCursorOverflow=function(){this.screen_.cursorPosition.overflow=!1},t.Terminal.prototype.saveCursorAndState=function(e){e?(this.primaryScreen_.saveCursorAndState(this.vt),this.alternateScreen_.saveCursorAndState(this.vt)):this.screen_.saveCursorAndState(this.vt)},t.Terminal.prototype.restoreCursorAndState=function(e){e?(this.primaryScreen_.restoreCursorAndState(this.vt),this.alternateScreen_.restoreCursorAndState(this.vt)):this.screen_.restoreCursorAndState(this.vt)},t.Terminal.prototype.setCursorShape=function(e){this.cursorShape_=e,this.restyleCursor_()},t.Terminal.prototype.getCursorShape=function(){return this.cursorShape_},t.Terminal.prototype.setLineHeightPaddingSize=function(e){this.scrollPort_.setLineHeightPaddingSize(e)},t.Terminal.prototype.setScreenPaddingSize=function(e){this.setCssVar("screen-padding-size",`${e}px`),this.scrollPort_.setScreenPaddingSize(e)},t.Terminal.prototype.setScreenBorderSize=function(e){this.div_.style.borderWidth=`${e}px`,this.screenBorderSize_=e,this.scrollPort_.resize()},t.Terminal.prototype.setWidth=function(e){if(null==e)return void(this.div_.style.width="100%");const t=Math.max(this.scrollPort_.screenPaddingSize,this.scrollPort_.currentScrollbarWidthPx);this.div_.style.width=Math.ceil(this.scrollPort_.characterSize.width*e+this.scrollPort_.screenPaddingSize+t+2*this.screenBorderSize_)+"px",this.realizeSize_(e,this.screenSize.height),this.scheduleSyncCursorPosition_()},t.Terminal.prototype.setHeight=function(e){null!=e?(this.div_.style.height=this.scrollPort_.characterSize.height*e+2*this.scrollPort_.screenPaddingSize+2*this.screenBorderSize_+"px",this.realizeSize_(this.screenSize.width,e),this.scheduleSyncCursorPosition_()):this.div_.style.height="100%"},t.Terminal.prototype.realizeSize_=function(e,t){let r=!1;e!=this.screenSize.width&&(r=!0,this.realizeWidth_(e)),t!=this.screenSize.height&&(r=!0,this.realizeHeight_(t)),r&&this.io.onTerminalResize_(e,t)},t.Terminal.prototype.realizeWidth_=function(e){if(e<=0)throw new Error("Attempt to realize bad width: "+e);const t=e-this.screen_.getWidth();if(0!=t){if(this.screenSize.width=e,this.screen_.setColumnCount(e),t>0)this.defaultTabStops&&this.setDefaultTabStops(this.screenSize.width-t);else for(let t=this.tabStops_.length-1;t>=0&&!(this.tabStops_[t]<e);t--)this.tabStops_.pop();this.screen_.setColumnCount(this.screenSize.width)}},t.Terminal.prototype.realizeHeight_=function(e){if(e<=0)throw new Error("Attempt to realize bad height: "+e);let t=e-this.screen_.getHeight();if(0==t)return;this.screenSize.height=e;const r=this.saveCursor();if(t<0){for(t*=-1;t;){const e=this.getRowCount()-1;if(e-this.scrollbackRows_.length==r.row)break;if(this.getRowText(e))break;this.screen_.popRow(),t--}const e=this.screen_.shiftRows(t);this.scrollbackRows_.push.apply(this.scrollbackRows_,e),r.row=Math.max(r.row-t,0)}else if(t>0){if(t<=this.scrollbackRows_.length){const e=Math.min(t,this.scrollbackRows_.length),o=this.scrollbackRows_.splice(this.scrollbackRows_.length-e,e);this.screen_.unshiftRows(o),t-=e,r.row+=e}t&&this.appendRows_(t)}this.setVTScrollRegion(null,null),this.restoreCursor(r)},t.Terminal.prototype.scrollHome=function(){this.scrollPort_.scrollRowToTop(0)},t.Terminal.prototype.scrollEnd=function(){this.scrollPort_.scrollRowToBottom(this.getRowCount())},t.Terminal.prototype.scrollPageUp=function(){this.scrollPort_.scrollPageUp()},t.Terminal.prototype.scrollPageDown=function(){this.scrollPort_.scrollPageDown()},t.Terminal.prototype.scrollLineUp=function(){const e=this.scrollPort_.getTopRowIndex();this.scrollPort_.scrollRowToTop(e-1)},t.Terminal.prototype.scrollLineDown=function(){const e=this.scrollPort_.getTopRowIndex();this.scrollPort_.scrollRowToTop(e+1)},t.Terminal.prototype.wipeContents=function(){this.clearHome(this.primaryScreen_),this.clearHome(this.alternateScreen_),this.clearScrollback()},t.Terminal.prototype.clearScrollback=function(){this.scrollEnd(),this.scrollbackRows_.length=0,this.scrollPort_.resetCache(),[this.primaryScreen_,this.alternateScreen_].forEach((e=>{const t=e.getHeight();this.renumberRows_(0,t,e)})),this.syncCursorPosition_(),this.scrollPort_.invalidate()},t.Terminal.prototype.reset=function(){this.vt.reset(),this.clearAllTabStops(),this.setDefaultTabStops(),this.resetColorPalette();const e=e=>{e.textAttributes.reset(),e.textAttributes.colorPaletteOverrides=[],this.clearHome(e),e.saveCursorAndState(this.vt)};e(this.primaryScreen_),e(this.alternateScreen_),this.options_=new t.Options,this.setCursorBlink(!!this.prefs_.get("cursor-blink")),this.setVTScrollRegion(null,null),this.setCursorVisible(!0)},t.Terminal.prototype.softReset=function(){this.vt.reset(),this.options_=new t.Options,this.options_.cursorBlink=!!this.timeouts_.cursorBlink,this.resetColorPalette();const e=e=>{e.textAttributes.reset(),e.textAttributes.colorPaletteOverrides=[],e.saveCursorAndState(this.vt)};e(this.primaryScreen_),e(this.alternateScreen_),this.setVTScrollRegion(null,null),this.setCursorVisible(!0)},t.Terminal.prototype.forwardTabStop=function(){const e=this.screen_.cursorPosition.column;for(let t=0;t<this.tabStops_.length;t++)if(this.tabStops_[t]>e)return void this.setCursorColumn(this.tabStops_[t]);const t=this.screen_.cursorPosition.overflow;this.setCursorColumn(this.screenSize.width-1),this.screen_.cursorPosition.overflow=t},t.Terminal.prototype.backwardTabStop=function(){const e=this.screen_.cursorPosition.column;for(let t=this.tabStops_.length-1;t>=0;t--)if(this.tabStops_[t]<e)return void this.setCursorColumn(this.tabStops_[t]);this.setCursorColumn(1)},t.Terminal.prototype.setTabStop=function(e){for(let t=this.tabStops_.length-1;t>=0;t--){if(this.tabStops_[t]==e)return;if(this.tabStops_[t]<e)return void this.tabStops_.splice(t+1,0,e)}this.tabStops_.splice(0,0,e)},t.Terminal.prototype.clearTabStopAtCursor=function(){const e=this.screen_.cursorPosition.column,t=this.tabStops_.indexOf(e);-1!=t&&this.tabStops_.splice(t,1)},t.Terminal.prototype.clearAllTabStops=function(){this.tabStops_.length=0,this.defaultTabStops=!1},t.Terminal.prototype.setDefaultTabStops=function(e=0){const t=this.tabWidth;for(let r=e=e-1-(e-1)%t+t;r<this.screenSize.width;r+=t)this.setTabStop(r);this.defaultTabStops=!0},t.Terminal.prototype.interpret=function(e){this.scheduleSyncCursorPosition_(),this.vt.interpret(e)},t.Terminal.prototype.decorate=function(e){const r=e.ownerDocument.characterSet.toLowerCase();"utf-8"!=r&&console.warn(`Document encoding should be set to utf-8, not "${r}"; Add <meta charset='utf-8'/> to your HTML <head> to fix.`),this.div_=e,this.div_.style.borderStyle="solid",this.div_.style.borderWidth=0,this.div_.style.boxSizing="border-box",this.accessibilityReader_=new t.AccessibilityReader(e),this.scrollPort_.decorate(e,(()=>this.setupScrollPort_()))},t.Terminal.prototype.setupScrollPort_=function(){this.scrollPort_.setBackgroundImage(this.prefs_.getString("background-image")),this.scrollPort_.setBackgroundSize(this.prefs_.getString("background-size")),this.scrollPort_.setBackgroundPosition(this.prefs_.getString("background-position")),this.scrollPort_.setUserCssUrl(this.prefs_.getString("user-css")),this.scrollPort_.setUserCssText(this.prefs_.getString("user-css-text")),this.scrollPort_.setAccessibilityReader(e.notNull(this.accessibilityReader_)),this.div_.focus=this.focus.bind(this),this.setFontSize(this.prefs_.getNumber("font-size")),this.syncFontFamily(),this.setScrollbarVisible(this.prefs_.getBoolean("scrollbar-visible")),this.setScrollWheelMoveMultipler(this.prefs_.getNumber("scroll-wheel-move-multiplier")),this.document_=this.scrollPort_.getDocument(),this.accessibilityReader_.decorate(this.document_),this.findBar.decorate(this.document_),this.notifications_=new t.NotificationCenter(e.notNull(this.document_.body),this.accessibilityReader_),this.document_.body.oncontextmenu=function(){return!1},this.contextMenu.setDocument(this.document_);const r=this.onMouse_.bind(this),o=this.scrollPort_.getScreenNode();o.addEventListener("mousedown",r),o.addEventListener("mouseup",r),o.addEventListener("mousemove",r),this.scrollPort_.onScrollWheel=r,o.addEventListener("keydown",this.onKeyboardActivity_.bind(this)),o.addEventListener("focus",this.onFocusChange_.bind(this,!0)),o.addEventListener("mousedown",function(){setTimeout(this.onFocusChange_.bind(this,!0))}.bind(this)),o.addEventListener("blur",this.onFocusChange_.bind(this,!1));const s=this.document_.createElement("style");s.textContent=`\n.cursor-node[focus="false"] {\n  box-sizing: border-box;\n  background-color: transparent !important;\n  border-width: 2px;\n  border-style: solid;\n}\n.cursor-node[shape="block"] {\n}\n.cursor-node[shape="beam"] {\n  background-color: transparent !important;\n  border-left-style: solid;\n}\n.cursor-node[shape="underline"] {\n  background-color: transparent !important;\n  border-bottom-style: solid;\n}\n.cursor-node[bell="true"] {\n  background-color: rgb(var(--hterm-foreground-color)) !important;\n}\n.cursor-node[visible="false"] {\n  opacity: 0;\n}\nmenu {\n  background: #fff;\n  border-radius: 4px;\n  color: #202124;\n  cursor: var(--hterm-mouse-cursor-pointer);\n  display: none;\n  filter: drop-shadow(0 1px 3px #3C40434D) drop-shadow(0 4px 8px #3C404326);\n  margin: 0;\n  padding: 8px 0;\n  position: absolute;\n  transition-duration: 200ms;\n}\nmenuitem {\n  display: block;\n  font: var(--hterm-font-size) 'Roboto', 'Noto Sans', sans-serif;\n  padding: 0.5em 1em;\n  white-space: nowrap;\n}\nmenuitem.separator {\n  border-bottom: none;\n  height: 0.5em;\n  padding: 0;\n}\nmenuitem:hover {\n  background-color: #e2e4e6;\n}\n.wc-node {\n  display: inline-block;\n  text-align: center;\n  width: calc(var(--hterm-charsize-width) * 2);\n  line-height: var(--hterm-charsize-height);\n}\n:root {\n  --hterm-charsize-width: ${this.scrollPort_.characterSize.width}px;\n  --hterm-charsize-height: ${this.scrollPort_.characterSize.height}px;\n  --hterm-blink-node-duration: 0.7s;\n  --hterm-mouse-cursor-default: default;\n  --hterm-mouse-cursor-text: text;\n  --hterm-mouse-cursor-pointer: pointer;\n  --hterm-mouse-cursor-style: var(--hterm-mouse-cursor-text);\n  --hterm-screen-padding-size: 0;\n\n${e.colors.stockPalette.map(((t,r)=>`\n  --hterm-color-${r}: ${e.colors.crackRGB(t).slice(0,3).join(",")};\n`)).join("")}\n}\n.uri-node:hover {\n  text-decoration: underline;\n  cursor: var(--hterm-mouse-cursor-pointer);\n}\n@keyframes blink {\n  from { opacity: 1.0; }\n  to { opacity: 0.0; }\n}\n.blink-node {\n  animation-name: blink;\n  animation-duration: var(--hterm-blink-node-duration);\n  animation-iteration-count: infinite;\n  animation-timing-function: ease-in-out;\n  animation-direction: alternate;\n}`,this.document_.head.insertBefore(s,this.document_.head.firstChild),this.cursorNode_=this.document_.createElement("div"),this.cursorNode_.id="hterm:terminal-cursor",this.cursorNode_.className="cursor-node",this.cursorNode_.style.cssText=`\nposition: absolute;\nleft: calc(var(--hterm-screen-padding-size) +\n    var(--hterm-charsize-width) * var(--hterm-cursor-offset-col));\ntop: calc(var(--hterm-screen-padding-size) +\n    var(--hterm-charsize-height) * var(--hterm-cursor-offset-row));\ndisplay: ${this.options_.cursorVisible?"":"none"};\nwidth: var(--hterm-charsize-width);\nheight: var(--hterm-charsize-height);\nbackground-color: var(--hterm-cursor-color);\nborder-color: var(--hterm-cursor-color);\ntransition: opacity, background-color 100ms linear;`,this.setCursorColor(),this.setCursorBlink(!!this.prefs_.get("cursor-blink")),this.restyleCursor_(),this.document_.body.appendChild(this.cursorNode_),this.scrollBlockerNode_=this.document_.createElement("div"),this.scrollBlockerNode_.id="hterm:mouse-drag-scroll-blocker",this.scrollBlockerNode_.setAttribute("aria-hidden","true"),this.scrollBlockerNode_.style.cssText="position: absolute;top: -99px;display: block;width: 10px;height: 10px;",this.document_.body.appendChild(this.scrollBlockerNode_),this.scrollPort_.onScrollWheel=r,["mousedown","mouseup","mousemove","click","dblclick"].forEach(function(e){this.scrollBlockerNode_.addEventListener(e,r),this.cursorNode_.addEventListener(e,r),this.document_.addEventListener(e,r)}.bind(this)),this.cursorNode_.addEventListener("mousedown",function(){setTimeout(this.focus.bind(this))}.bind(this)),this.setReverseVideo(!1),this.document_.fonts.addEventListener("loadingdone",(()=>this.syncFontFamily())),this.scrollPort_.focus(),this.scrollPort_.scheduleRedraw()},t.Terminal.prototype.getDocument=function(){return this.document_},t.Terminal.prototype.focus=function(){this.scrollPort_.focus()},t.Terminal.prototype.blur=function(){this.scrollPort_.blur()},t.Terminal.prototype.getRowNode=function(e){if(e<this.scrollbackRows_.length)return this.scrollbackRows_[e];const t=e-this.scrollbackRows_.length;return this.screen_.rowsArray[t]},t.Terminal.prototype.getRowsText=function(e,t){const r=[];for(let o=e;o<t;o++){const e=this.getRowNode(o);r.push(e.textContent),o<t-1&&!e.getAttribute("line-overflow")&&r.push("\n")}return r.join("")},t.Terminal.prototype.getRowText=function(e){return this.getRowNode(e).textContent},t.Terminal.prototype.getRowCount=function(){return this.scrollbackRows_.length+this.screen_.rowsArray.length},t.Terminal.prototype.appendRows_=function(e){let t=this.screen_.rowsArray.length;const r=this.scrollbackRows_.length+t;for(let t=0;t<e;t++){const e=this.document_.createElement("x-row");e.appendChild(this.document_.createTextNode("")),e.rowIndex=r+t,this.screen_.pushRow(e)}const o=this.screen_.rowsArray.length-this.screenSize.height;if(o>0){const e=this.screen_.shiftRows(o);Array.prototype.push.apply(this.scrollbackRows_,e),this.scrollPort_.isScrolledEnd&&this.scheduleScrollDown_()}t>=this.screen_.rowsArray.length&&(t=this.screen_.rowsArray.length-1),this.setAbsoluteCursorPosition(t,0)},t.Terminal.prototype.insertRow_=function(){const e=this.document_.createElement("x-row");e.appendChild(this.document_.createTextNode("")),this.scrollbackRows_.push(this.screen_.shiftRow());const t=this.screen_.cursorPosition.row;this.screen_.insertRow(t,e),this.renumberRows_(t,this.screen_.rowsArray.length),this.setAbsoluteCursorPosition(t,0),this.scrollPort_.isScrolledEnd&&this.scheduleScrollDown_()},t.Terminal.prototype.moveRows_=function(e,t,r){const o=this.screen_.removeRows(e,t);let s,i;this.screen_.insertRows(r,o),e<r?(s=e,i=r+t):(s=r,i=e+t),this.renumberRows_(s,i),this.scrollPort_.scheduleInvalidate()},t.Terminal.prototype.renumberRows_=function(e,t,r=void 0){r||(r=this.screen_);const o=this.scrollbackRows_.length;for(let s=e;s<t;s++)r.rowsArray[s].rowIndex=o+s},t.Terminal.prototype.print=function(e){this.scheduleSyncCursorPosition_(),this.accessibilityReader_.announce(e);let r=0,o=t.wc.strWidth(e);for(0==o&&e&&(o=1);r<o;){this.options_.wraparound&&this.screen_.cursorPosition.overflow&&(this.screen_.commitLineOverflow(),this.newLine(!0));let s,i=o-r,n=!1;this.screen_.cursorPosition.column+i>=this.screenSize.width&&(n=!0,i=this.screenSize.width-this.screen_.cursorPosition.column),n&&!this.options_.wraparound?(s=t.wc.substr(e,r,i-1)+t.wc.substr(e,o-1),i=o):s=t.wc.substr(e,r,i);const a=t.TextAttributes.splitWidecharString(s);for(let e=0;e<a.length;e++)this.screen_.textAttributes.wcNode=a[e].wcNode,this.screen_.textAttributes.asciiNode=a[e].asciiNode,this.options_.insertMode?this.screen_.insertString(a[e].str,a[e].wcStrWidth):this.screen_.overwriteString(a[e].str,a[e].wcStrWidth),this.screen_.textAttributes.wcNode=!1,this.screen_.textAttributes.asciiNode=!0;this.screen_.maybeClipCurrentRow(),r+=i,this.findBar.scheduleNotifyChanges(this.scrollbackRows_.length+this.screen_.cursorPosition.row)}this.scrollOnOutput_&&this.scrollPort_.scrollRowToBottom(this.getRowCount())},t.Terminal.prototype.setVTScrollRegion=function(e,t){this.vtScrollTop_=e,this.vtScrollBottom_=t,t==this.screenSize.height-1&&(this.vtScrollBottom_=null,0==e&&(this.vtScrollTop_=null))},t.Terminal.prototype.getVTScrollTop=function(){return null!=this.vtScrollTop_?this.vtScrollTop_:0},t.Terminal.prototype.getVTScrollBottom=function(){return null!=this.vtScrollBottom_?this.vtScrollBottom_:this.screenSize.height-1},t.Terminal.prototype.newLine=function(e=!1){e||this.accessibilityReader_.newLine();const t=this.screen_.cursorPosition.row==this.screen_.rowsArray.length-1,r=this.screen_.cursorPosition.row==this.getVTScrollBottom();null!=this.vtScrollTop_&&r?(this.vtScrollUp(1),this.setAbsoluteCursorPosition(this.screen_.cursorPosition.row,0)):t?this.appendRows_(1):r?this.insertRow_():this.setAbsoluteCursorPosition(this.screen_.cursorPosition.row+1,0)},t.Terminal.prototype.lineFeed=function(){const e=this.screen_.cursorPosition.column;this.newLine(),this.setCursorColumn(e)},t.Terminal.prototype.formFeed=function(){this.options_.autoCarriageReturn?this.newLine():this.lineFeed()},t.Terminal.prototype.reverseLineFeed=function(){const e=this.getVTScrollTop(),t=this.screen_.cursorPosition.row;t==e?this.insertLines(1):this.setAbsoluteCursorRow(t-1)},t.Terminal.prototype.eraseToLeft=function(){const e=this.saveCursor();this.setCursorColumn(0);const t=e.column+1;this.screen_.overwriteString(" ".repeat(t),t),this.findBar.scheduleNotifyChanges(this.scrollbackRows_.length+this.screen_.cursorPosition.row),this.restoreCursor(e)},t.Terminal.prototype.eraseToRight=function(e=void 0){if(this.screen_.cursorPosition.overflow)return;const r=this.screenSize.width-this.screen_.cursorPosition.column;if(e=e?Math.min(e,r):r,this.findBar.scheduleNotifyChanges(this.scrollbackRows_.length+this.screen_.cursorPosition.row),this.screen_.textAttributes.background===this.screen_.textAttributes.DEFAULT_COLOR){const r=this.screen_.rowsArray[this.screen_.cursorPosition.row];if(t.TextAttributes.nodeWidth(r)<=this.screen_.cursorPosition.column+e)return this.screen_.deleteChars(e),void this.clearCursorOverflow()}const o=this.saveCursor();this.screen_.overwriteString(" ".repeat(e),e),this.restoreCursor(o),this.clearCursorOverflow()},t.Terminal.prototype.eraseLine=function(){const e=this.saveCursor();this.screen_.clearCursorRow(),this.restoreCursor(e),this.clearCursorOverflow()},t.Terminal.prototype.eraseAbove=function(){const e=this.saveCursor();this.eraseToLeft();for(let t=0;t<e.row;t++)this.setAbsoluteCursorPosition(t,0),this.screen_.clearCursorRow();this.restoreCursor(e),this.clearCursorOverflow()},t.Terminal.prototype.eraseBelow=function(){const e=this.saveCursor();this.eraseToRight();const t=this.screenSize.height-1;for(let r=e.row+1;r<=t;r++)this.setAbsoluteCursorPosition(r,0),this.screen_.clearCursorRow();this.restoreCursor(e),this.clearCursorOverflow()},t.Terminal.prototype.fill=function(e){const t=this.saveCursor();this.setAbsoluteCursorPosition(0,0);for(let t=0;t<this.screenSize.height;t++){for(let r=0;r<this.screenSize.width;r++)this.setAbsoluteCursorPosition(t,r),this.screen_.overwriteString(e,1);this.findBar.scheduleNotifyChanges(this.scrollbackRows_.length+t)}this.restoreCursor(t)},t.Terminal.prototype.clearHome=function(e=void 0){e||(e=this.screen_);const t=e.getHeight();if(this.accessibilityReader_.clear(),0!=t){for(let r=0;r<t;r++)e.setCursorPosition(r,0),e.clearCursorRow();e.setCursorPosition(0,0)}},t.Terminal.prototype.clear=function(e=void 0){e||(e=this.screen_);const t=e.cursorPosition.clone();this.clearHome(e),e.setCursorPosition(t.row,t.column)},t.Terminal.prototype.insertLines=function(e){const t=this.screen_.cursorPosition.row,r=this.getVTScrollBottom(),o=r-t-(e=Math.min(e,r-t))+1;o&&this.moveRows_(t,o,t+e);for(let r=e-1;r>=0;r--)this.setAbsoluteCursorPosition(t+r,0),this.screen_.clearCursorRow()},t.Terminal.prototype.deleteLines=function(e){const t=this.saveCursor(),r=t.row,o=this.getVTScrollBottom(),s=o-r+1,i=o-(e=Math.min(e,s))+1;e!=s&&this.moveRows_(r,e,i);for(let t=0;t<e;t++)this.setAbsoluteCursorPosition(i+t,0),this.screen_.clearCursorRow();this.restoreCursor(t),this.clearCursorOverflow()},t.Terminal.prototype.insertSpace=function(e){const t=this.saveCursor(),r=" ".repeat(e||1);this.screen_.insertString(r,r.length),this.screen_.maybeClipCurrentRow(),this.findBar.scheduleNotifyChanges(this.scrollbackRows_.length+this.screen_.cursorPosition.row),this.restoreCursor(t),this.clearCursorOverflow()},t.Terminal.prototype.deleteChars=function(e){const t=this.screen_.deleteChars(e);if(t&&!this.screen_.textAttributes.isDefault()){const e=this.saveCursor();this.setCursorColumn(this.screenSize.width-t),this.screen_.insertString(" ".repeat(t)),this.restoreCursor(e)}this.findBar.scheduleNotifyChanges(this.scrollbackRows_.length+this.screen_.cursorPosition.row),this.clearCursorOverflow()},t.Terminal.prototype.vtScrollUp=function(e){const t=this.saveCursor();this.setAbsoluteCursorRow(this.getVTScrollTop()),this.deleteLines(e),this.restoreCursor(t)},t.Terminal.prototype.vtScrollDown=function(e){const t=this.saveCursor();this.setAbsoluteCursorPosition(this.getVTScrollTop(),0),this.insertLines(e),this.restoreCursor(t)},t.Terminal.prototype.setAccessibilityEnabled=function(e){this.accessibilityReader_.setAccessibilityEnabled(e)},t.Terminal.prototype.setCursorPosition=function(e,t){this.options_.originMode?this.setRelativeCursorPosition(e,t):this.setAbsoluteCursorPosition(e,t)},t.Terminal.prototype.setRelativeCursorPosition=function(t,r){const o=this.getVTScrollTop();t=e.f.clamp(t+o,o,this.getVTScrollBottom()),r=e.f.clamp(r,0,this.screenSize.width-1),this.screen_.setCursorPosition(t,r)},t.Terminal.prototype.setAbsoluteCursorPosition=function(t,r){t=e.f.clamp(t,0,this.screenSize.height-1),r=e.f.clamp(r,0,this.screenSize.width-1),this.screen_.setCursorPosition(t,r)},t.Terminal.prototype.setCursorColumn=function(e){this.setAbsoluteCursorPosition(this.screen_.cursorPosition.row,e)},t.Terminal.prototype.getCursorColumn=function(){return this.screen_.cursorPosition.column},t.Terminal.prototype.setAbsoluteCursorRow=function(e){this.setAbsoluteCursorPosition(e,this.screen_.cursorPosition.column)},t.Terminal.prototype.getCursorRow=function(){return this.screen_.cursorPosition.row},t.Terminal.prototype.scheduleRedraw_=function(){this.timeouts_.redraw||(this.timeouts_.redraw=setTimeout((()=>{delete this.timeouts_.redraw,this.scrollPort_.redraw_()})))},t.Terminal.prototype.scheduleScrollDown_=function(){this.timeouts_.scrollDown||(this.timeouts_.scrollDown=setTimeout((()=>{delete this.timeouts_.scrollDown,this.scrollPort_.scrollRowToBottom(this.getRowCount())}),10))},t.Terminal.prototype.cursorUp=function(e){this.cursorDown(-(e||1))},t.Terminal.prototype.cursorDown=function(t){t=t||1;const r=this.options_.originMode?this.getVTScrollTop():0,o=this.options_.originMode?this.getVTScrollBottom():this.screenSize.height-1,s=e.f.clamp(this.screen_.cursorPosition.row+t,r,o);this.setAbsoluteCursorRow(s)},t.Terminal.prototype.cursorLeft=function(e){if((e=e||1)<1)return;const t=this.screen_.cursorPosition.column;if(this.options_.reverseWraparound){if(this.screen_.cursorPosition.overflow&&(e--,this.clearCursorOverflow(),!e))return;let r=this.screen_.cursorPosition.row,o=t-e;o<0&&(r=r-Math.floor(e/this.screenSize.width)-1,r<0&&(r=this.screenSize.height+r%this.screenSize.height),o=this.screenSize.width+o%this.screenSize.width),this.setCursorPosition(Math.max(r,0),o)}else{const r=Math.max(t-e,0);this.setCursorColumn(r)}},t.Terminal.prototype.cursorRight=function(t){if((t=t||1)<1)return;const r=e.f.clamp(this.screen_.cursorPosition.column+t,0,this.screenSize.width-1);this.setCursorColumn(r)},t.Terminal.prototype.setReverseVideo=function(e){this.options_.reverseVideo=e,e?(this.setRgbColorCssVar("foreground-color",this.backgroundColor_),this.setRgbColorCssVar("background-color",this.foregroundColor_)):(this.setRgbColorCssVar("foreground-color",this.foregroundColor_),this.setRgbColorCssVar("background-color",this.backgroundColor_))},t.Terminal.prototype.ringBell=function(){if(this.cursorNode_.setAttribute("bell","true"),setTimeout((()=>this.cursorNode_.removeAttribute("bell")),200),!this.bellSquelchTimeout_&&(this.bellAudio_.getAttribute("src")?(this.bellAudio_.play(),this.bellSequelchTimeout_=setTimeout((()=>{this.bellSquelchTimeout_=null}),500)):this.bellSquelchTimeout_=null,this.desktopNotificationBell_&&!this.document_.hasFocus())){const e=t.notify();this.bellNotificationList_.push(e),e.onclick=()=>this.closeBellNotifications_()}},t.Terminal.prototype.setOriginMode=function(e){this.options_.originMode=e,this.setCursorPosition(0,0)},t.Terminal.prototype.setInsertMode=function(e){this.options_.insertMode=e},t.Terminal.prototype.setAutoCarriageReturn=function(e){this.options_.autoCarriageReturn=e},t.Terminal.prototype.setWraparound=function(e){this.options_.wraparound=e},t.Terminal.prototype.setReverseWraparound=function(e){this.options_.reverseWraparound=e},t.Terminal.prototype.setAlternateMode=function(e){if(e==(this.screen_==this.alternateScreen_))return;const t=this.screen_.textAttributes.colorPaletteOverrides,r=this.saveCursor();this.screen_=e?this.alternateScreen_:this.primaryScreen_;const o=this.screen_.textAttributes.colorPaletteOverrides;if(t.forEach(((e,t)=>{o.hasOwnProperty(t)||this.setRgbColorCssVar(`color-${t}`,this.getColorPalette(t))})),o.forEach(((e,t)=>this.setRgbColorCssVar(`color-${t}`,e))),this.screen_.rowsArray.length&&this.screen_.rowsArray[0].rowIndex!=this.scrollbackRows_.length){const e=this.scrollbackRows_.length,t=this.screen_.rowsArray;for(let r=0;r<t.length;r++)t[r].rowIndex=e+r}this.realizeWidth_(this.screenSize.width),this.realizeHeight_(this.screenSize.height),this.scrollPort_.syncScrollHeight(),this.scrollPort_.invalidate(),this.restoreCursor(r),this.scrollPort_.resize()},t.Terminal.prototype.setCursorBlink=function(e){this.options_.cursorBlink=e,!e&&this.timeouts_.cursorBlink&&(clearTimeout(this.timeouts_.cursorBlink),delete this.timeouts_.cursorBlink),this.options_.cursorVisible&&this.setCursorVisible(!0)},t.Terminal.prototype.setCursorVisible=function(e){if(this.options_.cursorVisible=e,!e)return this.timeouts_.cursorBlink&&(clearTimeout(this.timeouts_.cursorBlink),delete this.timeouts_.cursorBlink),void this.cursorNode_.setAttribute("visible","false");if(this.syncCursorPosition_(),this.cursorNode_.setAttribute("visible","true"),this.options_.cursorBlink){if(this.timeouts_.cursorBlink)return;this.onCursorBlink_()}else this.timeouts_.cursorBlink&&(clearTimeout(this.timeouts_.cursorBlink),delete this.timeouts_.cursorBlink)},t.Terminal.prototype.pauseCursorBlink_=function(){this.options_.cursorBlink&&(this.cursorBlinkPause_=!0,this.timeouts_.cursorBlinkPause&&clearTimeout(this.timeouts_.cursorBlinkPause),this.timeouts_.cursorBlinkPause=setTimeout((()=>{delete this.timeouts_.cursorBlinkPause,this.cursorBlinkPause_=!1}),500))},t.Terminal.prototype.syncCursorPosition_=function(){const e=this.scrollPort_.getTopRowIndex(),t=this.scrollPort_.getBottomRowIndex(e),r=this.scrollbackRows_.length+this.screen_.cursorPosition.row;let o=!1;if(this.accessibilityReader_.accessibilityEnabled){const e=this.screen_.cursorPosition.column,t=this.screen_.rowsArray[this.screen_.cursorPosition.row].innerText;o=this.accessibilityReader_.hasUserGesture,this.accessibilityReader_.afterCursorChange(t,r,e)}if(r>t)return this.cursorOffScreen_=!0,this.cursorNode_.style.display="none",!1;if("none"==this.cursorNode_.style.display&&(this.cursorOffScreen_=!1,this.cursorNode_.style.display=""),this.setCssVar("cursor-offset-row",r-e+" + "+`${this.scrollPort_.visibleRowTopMargin}px`),this.setCssVar("cursor-offset-col",this.screen_.cursorPosition.column),this.cursorNode_.setAttribute("title","("+this.screen_.cursorPosition.column+", "+this.screen_.cursorPosition.row+")"),!this.findBar.hasFocus){const e=this.document_.getSelection();e&&(e.isCollapsed||o)&&this.screen_.syncSelectionCaret(e)}return!0},t.Terminal.prototype.restyleCursor_=function(){let e=this.cursorShape_;"false"==this.cursorNode_.getAttribute("focus")&&(e=t.Terminal.cursorShape.BLOCK),this.cursorNode_.setAttribute("shape",e.toLowerCase())},t.Terminal.prototype.scheduleSyncCursorPosition_=function(){if(!this.timeouts_.syncCursor){if(this.accessibilityReader_.accessibilityEnabled){const e=this.scrollbackRows_.length+this.screen_.cursorPosition.row,t=this.screen_.cursorPosition.column,r=this.screen_.rowsArray[this.screen_.cursorPosition.row].innerText;this.accessibilityReader_.beforeCursorChange(r,e,t)}this.timeouts_.syncCursor=setTimeout((()=>{this.syncCursorPosition_(),delete this.timeouts_.syncCursor}))}},t.Terminal.prototype.showOverlay=function(e,t=1500){this.ready_&&this.notifications_&&this.notifications_.show(e,{timeout:t})},t.Terminal.prototype.hideOverlay=function(){this.notifications_.hide()},t.Terminal.prototype.paste=function(){if(!this.alwaysUseLegacyPasting&&navigator.clipboard&&navigator.clipboard.readText)return navigator.clipboard.readText().then((e=>this.onPasteData_(e))),null;try{return this.document_.execCommand("paste")}catch(e){return!1}},t.Terminal.prototype.copyStringToClipboard=function(r){if(this.prefs_.get("enable-clipboard-notice")){if(!this.clipboardNotice_){this.clipboardNotice_=this.document_.createElement("div"),this.clipboardNotice_.style.textAlign="center";const r=e.resource.getData("hterm/images/copy");this.clipboardNotice_.innerHTML=t.sanitizeHtml(`${r}<div>${t.msg("NOTIFY_COPY")}</div>`)}setTimeout((()=>this.showOverlay(this.clipboardNotice_,500)),200)}t.copySelectionToClipboard(this.document_,r)},t.Terminal.prototype.displayImage=function(r,o,s){if(void 0!==r.uri||void 0!==r.buffer||void 0!==r.blob){if(r.name||(r.name=""),!r.type){const e=r.name.split(".");switch(e[e.length-1].trim()){case"svg":case"svgz":r.type="image/svg+xml"}}if(!0!==this.allowImagesInline){if(!1===this.allowImagesInline)return void this.showOverlay(t.msg("POPUP_INLINE_IMAGE_DISABLED",[],"Inline Images Disabled"));let e;const r=this.document_.createElement("span"),o=this.document_.createElement("p");return o.innerText=t.msg("POPUP_INLINE_IMAGE",[],"Inline Images"),o.style.textAlign="center",r.appendChild(o),e=this.document_.createElement("input"),e.type="button",e.value=t.msg("BUTTON_BLOCK",[],"block"),e.addEventListener("click",(()=>{this.prefs_.set("allow-images-inline",!1),this.hideOverlay()})),r.appendChild(e),r.appendChild(new Text(" ")),e=this.document_.createElement("input"),e.type="button",e.value=t.msg("BUTTON_ALLOW_SESSION",[],"allow this session"),e.addEventListener("click",(()=>{this.allowImagesInline=!0,this.hideOverlay()})),r.appendChild(e),r.appendChild(new Text(" ")),e=this.document_.createElement("input"),e.type="button",e.value=t.msg("BUTTON_ALLOW_ALWAYS",[],"always allow"),e.addEventListener("click",(()=>{this.prefs_.set("allow-images-inline",!0),this.hideOverlay()})),r.appendChild(e),void this.showOverlay(r,null)}if(r.inline){const e=this.io.push();e.showOverlay(t.msg("LOADING_RESOURCE_START",[r.name],"Loading $1 ...")),e.onVTKeystroke=e.sendString=()=>{};const i=this.document_.createElement("img");if(void 0!==r.uri)i.src=r.uri;else if(void 0!==r.buffer){const e=new Blob([r.buffer],{type:r.type});i.src=URL.createObjectURL(e)}else{const e=new Blob([r.blob],{type:r.type});i.src=URL.createObjectURL(e)}i.title=i.alt=r.name,this.document_.body.appendChild(i),i.onload=()=>{const t=this.scrollPort_.getScreenSize();i.style.objectFit=r.preserveAspectRatio?"scale-down":"fill",i.style.maxWidth=`${t.width}px`,i.style.maxHeight=`${t.height}px`;const s=(e,t,r)=>{if(!e||"auto"==e)return"";const o=e.match(/^([0-9]+)(px|%)?$/);return o?"%"==o[2]?Math.floor(t*o[1]/100)+"px":"px"==o[2]?e:`calc(${e} * var(${r}))`:""};i.style.width=s(r.width,t.width,"--hterm-charsize-width"),i.style.height=s(r.height,t.height,"--hterm-charsize-height");const n=Math.ceil(i.clientHeight/this.scrollPort_.characterSize.height);for(let e=0;e<n;++e)this.newLine();i.style.maxHeight=`calc(${n} * var(--hterm-charsize-height))`,this.document_.body.removeChild(i);const a=this.document_.createElement("div");a.style.position="relative",a.style.textAlign=r.align||"",i.style.position="absolute",i.style.bottom="calc(0px - var(--hterm-charsize-height))",a.appendChild(i);this.getRowNode(this.scrollbackRows_.length+this.getCursorRow()-1).appendChild(a),void 0===r.uri&&URL.revokeObjectURL(i.src),e.hideOverlay(),e.pop(),o&&o()},i.onerror=o=>{this.document_.body.removeChild(i),e.showOverlay(t.msg("LOADING_RESOURCE_FAILED",[r.name],"Loading $1 failed")),e.pop(),s&&s(o)}}else{const t=this.document_.createElement("a");if(void 0!==r.uri)t.href=r.uri;else if(void 0!==r.buffer){const e=new Blob([r.buffer]);t.href=URL.createObjectURL(e)}else t.href=URL.createObjectURL(e.notNull(r.blob));t.download=r.name,this.document_.body.appendChild(t),t.click(),t.remove(),void 0===r.uri&&URL.revokeObjectURL(t.href)}}},t.Terminal.prototype.getSelectionText=function(){const r=this.scrollPort_.selection;if(r.sync(),r.isCollapsed)return null;let o=r.startOffset,s=r.startNode;if(!s)return null;if("X-ROW"!=s.nodeName)for("#text"==s.nodeName&&"SPAN"==s.parentNode.nodeName&&(s=s.parentNode);s.previousSibling;)s=s.previousSibling,o+=t.TextAttributes.nodeWidth(s);let i=t.TextAttributes.nodeWidth(e.notNull(r.endNode))-r.endOffset;if(s=r.endNode,"X-ROW"!=s.nodeName)for("#text"==s.nodeName&&"SPAN"==s.parentNode.nodeName&&(s=s.parentNode);s.nextSibling;)s=s.nextSibling,i+=t.TextAttributes.nodeWidth(s);const n=this.getRowsText(r.startRow.rowIndex,r.endRow.rowIndex+1);return t.wc.substring(n,o,t.wc.strWidth(n)-i)},t.Terminal.prototype.copySelectionToClipboard=function(){const e=this.getSelectionText();null!=e&&this.copyStringToClipboard(e)},t.Terminal.prototype.overlaySize=function(){this.prefs_.get("enable-resize-status")&&this.showOverlay(`${this.screenSize.width} × ${this.screenSize.height}`)},t.Terminal.prototype.onVTKeystroke=function(e){this.scrollOnKeystroke_&&this.scrollPort_.scrollRowToBottom(this.getRowCount()),this.pauseCursorBlink_(),this.io.onVTKeystroke(e)},t.Terminal.prototype.openSelectedUrl_=function(){let e=this.getSelectionText();if((null!=e||(this.screen_.expandSelectionForUrl(this.document_.getSelection()),e=this.getSelectionText(),null!=e))&&!(e.length>2048||e.search(/[\s[\](){}<>"'\\^`]/)>=0)){if(e.search("^[a-zA-Z][a-zA-Z0-9+.-]*://")<0)if("mailto"===e.split(":",1)[0]);else e="http://"+e;t.openUrl(e)}},t.Terminal.prototype.setAutomaticMouseHiding=function(e=null){null===e&&(e="cros"!=t.os&&"mac"!=t.os),this.mouseHideWhileTyping_=!!e},t.Terminal.prototype.onKeyboardActivity_=function(e){this.mouseHideWhileTyping_&&!this.mouseHideDelay_&&this.setCssVar("mouse-cursor-style","none")},t.Terminal.prototype.onMouse_=function(t){if(t.processedByTerminalHandler_)return;t.button>2&&t.preventDefault();const r=!this.defeatMouseReports_&&this.vt.mouseReport!=this.vt.MOUSE_REPORT_DISABLED;t.processedByTerminalHandler_=!0,this.mouseHideWhileTyping_&&!this.mouseHideDelay_&&(this.syncMouseStyle(),this.mouseHideDelay_=setTimeout((()=>this.mouseHideDelay_=null),1e3));const o=this.scrollPort_.screenPaddingSize;if(t.terminalRow=Math.floor((t.clientY-this.scrollPort_.visibleRowTopMargin-o)/this.scrollPort_.characterSize.height)+1,t.terminalColumn=Math.floor((t.clientX-o)/this.scrollPort_.characterSize.width)+1,t.terminalRow=e.f.clamp(t.terminalRow,1,this.screenSize.height),t.terminalColumn=e.f.clamp(t.terminalColumn,1,this.screenSize.width),!("mousedown"==t.type&&t.clientX>=this.scrollPort_.getScrollbarX())){if(!this.options_.cursorVisible||r||this.cursorOffScreen_||(t.terminalRow-1==this.screen_.cursorPosition.row&&t.terminalColumn-1==this.screen_.cursorPosition.column?this.cursorNode_.style.display="none":"none"==this.cursorNode_.style.display&&(this.cursorNode_.style.display="")),"mousedown"==t.type&&(this.contextMenu.hide(),t.altKey||!r?(this.defeatMouseReports_=!0,this.setSelectionEnabled(!0)):(this.defeatMouseReports_=!1,this.document_.getSelection().collapseToEnd(),this.setSelectionEnabled(!1),t.preventDefault()),0===t.button&&this.scrollPort_.selection.setAutoScrollEnabled(!0)),r)this.scrollBlockerNode_.engaged||("mousedown"==t.type?(this.scrollBlockerNode_.engaged=!0,this.scrollBlockerNode_.style.top=t.clientY-5+"px",this.scrollBlockerNode_.style.left=t.clientX-5+"px"):"mousemove"==t.type&&(this.document_.getSelection().collapseToEnd(),t.preventDefault())),this.onMouse(t);else{if("dblclick"==t.type&&(this.screen_.expandSelection(this.document_.getSelection()),this.copyOnSelect&&this.copySelectionToClipboard()),"click"==t.type&&!t.shiftKey&&(t.ctrlKey||t.metaKey)){if("uri-node"===t.target.className)return;return clearTimeout(this.timeouts_.openUrl),void(this.timeouts_.openUrl=setTimeout(this.openSelectedUrl_.bind(this),500))}if("mousedown"==t.type&&(t.ctrlKey&&2==t.button?(t.preventDefault(),this.contextMenu.show(t,this)):(t.button==this.mousePasteButton||this.mouseRightClickPaste&&2==t.button)&&!1===this.paste()&&console.warn("Could not paste manually due to web restrictions")),"mouseup"==t.type&&0==t.button&&this.copyOnSelect&&!this.document_.getSelection().isCollapsed&&this.copySelectionToClipboard(),"mousemove"!=t.type&&"mouseup"!=t.type||!this.scrollBlockerNode_.engaged||(this.scrollBlockerNode_.engaged=!1,this.scrollBlockerNode_.style.top="-99px"),this.scrollWheelArrowKeys_&&!t.shiftKey&&this.keyboard.applicationCursor&&!this.isPrimaryScreen()&&"wheel"==t.type){const r=this.scrollPort_.scrollWheelDelta(t),o=(t,r,o,s)=>{if(0==t)return"";const i=e.f.smartFloorDivide(Math.abs(t),r);return("O"+(t<0?s:o)).repeat(i)};this.io.sendString(o(r.y,this.scrollPort_.characterSize.height,"A","B")+o(r.x,this.scrollPort_.characterSize.width,"C","D")),t.preventDefault()}}"mouseup"==t.type&&(this.document_.getSelection().isCollapsed&&(this.defeatMouseReports_=!1),0===t.button&&this.scrollPort_.selection.setAutoScrollEnabled(!1))}},t.Terminal.prototype.onMouse=function(e){},t.Terminal.prototype.onFocusChange_=function(e){this.cursorNode_.setAttribute("focus",e),this.restyleCursor_(),this.reportFocus&&this.io.sendString(!0===e?"[I":"[O"),!0===e&&this.closeBellNotifications_()},t.Terminal.prototype.onScroll_=function(){this.scheduleSyncCursorPosition_()},t.Terminal.prototype.onPaste_=function(e){this.onPasteData_(e.text)},t.Terminal.prototype.onPasteData_=function(e){if(e=e.replace(/\n/gm,"\r"),this.options_.bracketedPaste){const t=e=>e.replace(/[\x00-\x07\x0b-\x0c\x0e-\x1f]/g,"");e="[200~"+t(e)+"[201~"}this.io.sendString(e)},t.Terminal.prototype.onCopy_=function(e){this.useDefaultWindowCopy||(e.preventDefault(),setTimeout(this.copySelectionToClipboard.bind(this),0))},t.Terminal.prototype.onResize_=function(){const t=Math.floor(this.scrollPort_.getScreenWidth()/this.scrollPort_.characterSize.width)||0,r=e.f.smartFloorDivide(this.scrollPort_.getScreenHeight(),this.scrollPort_.characterSize.height)||0;if(t<=0||r<=0)return;const o=t!=this.screenSize.width||r!=this.screenSize.height,s=this.scrollPort_.isScrolledEnd;this.realizeSize_(t,r),this.updateCssCharsize_(),o&&this.overlaySize(),this.restyleCursor_(),this.scheduleSyncCursorPosition_(),s&&this.scrollEnd()},t.Terminal.prototype.onCursorBlink_=function(){this.options_.cursorBlink?"false"==this.cursorNode_.getAttribute("focus")||"false"==this.cursorNode_.getAttribute("visible")||this.cursorBlinkPause_?(this.cursorNode_.setAttribute("visible","true"),this.timeouts_.cursorBlink=setTimeout(this.myOnCursorBlink_,this.cursorBlinkCycle_[0])):(this.cursorNode_.setAttribute("visible","false"),this.timeouts_.cursorBlink=setTimeout(this.myOnCursorBlink_,this.cursorBlinkCycle_[1])):delete this.timeouts_.cursorBlink},t.Terminal.prototype.setScrollbarVisible=function(e){this.scrollPort_.setScrollbarVisible(e)},t.Terminal.prototype.setScrollWheelMoveMultipler=function(e){this.scrollPort_.setScrollWheelMoveMultipler(e)},t.Terminal.prototype.closeBellNotifications_=function(){this.bellNotificationList_.forEach((function(e){e.close()})),this.bellNotificationList_.length=0},t.Terminal.prototype.onScrollportFocus_=function(){const e=this.scrollPort_.getTopRowIndex(),t=this.scrollPort_.getBottomRowIndex(e),r=this.document_.getSelection();!this.syncCursorPosition_()&&r&&r.collapse(this.getRowNode(t))},t.Terminal.prototype.onOpenOptionsPage=function(){},t.Terminal.prototype.onOpenOptionsPage_=function(){this.onOpenOptionsPage()},t.Terminal.prototype.onOpenNewSession=function(){e.f.openWindow(globalThis.location.href,"",`chrome=no,close=yes,resize=yes,scrollbars=yes,minimizable=yes,width=${globalThis.outerWidth},height=${globalThis.outerHeight}`)},t.Terminal.prototype.onTmuxControlModeLine=function(e){},t.Terminal.IO=function(e){this.terminal_=e,this.previousIO_=null,this.buffered_="",this.textDecoder_=new TextDecoder},t.Terminal.IO.prototype.showOverlay=function(e,t=void 0){this.terminal_.showOverlay(e,t)},t.Terminal.IO.prototype.hideOverlay=function(){this.terminal_.hideOverlay()},t.Terminal.IO.prototype.setTerminalProfile=function(e){this.terminal_.setProfile(e)},t.Terminal.IO.prototype.push=function(){const e=new this.constructor(this.terminal_);return e.columnCount=this.columnCount,e.rowCount=this.rowCount,e.previousIO_=this.terminal_.io,this.terminal_.io=e,e},t.Terminal.IO.prototype.pop=function(){this.terminal_.io=this.previousIO_,this.previousIO_.flush()},t.Terminal.IO.prototype.flush=function(){this.buffered_&&(this.terminal_.interpret(this.buffered_),this.buffered_="")},t.Terminal.IO.prototype.sendString=function(e){console.log("Unhandled sendString: "+e)},t.Terminal.IO.prototype.onVTKeystroke=function(e){console.log("Unobserverd VT keystroke: "+JSON.stringify(e))},t.Terminal.IO.prototype.onTerminalResize_=function(e,t){let r=this;for(;r;)r.columnCount=e,r.rowCount=t,r=r.previousIO_;this.onTerminalResize(e,t)},t.Terminal.IO.prototype.onTerminalResize=function(e,t){},t.Terminal.IO.prototype.writeUTF8=function(e){const t=new Uint8Array(e),r=this.textDecoder_.decode(t,{stream:!0});this.print(r)},t.Terminal.IO.prototype.writelnUTF8=function(e){this.writeUTF8(e),this.writeUTF8([13,10])},t.Terminal.IO.prototype.print=t.Terminal.IO.prototype.writeUTF16=function(e){this.terminal_.io==this?this.terminal_.interpret(e):this.buffered_+=e},t.Terminal.IO.prototype.println=t.Terminal.IO.prototype.writelnUTF16=function(e){this.print(e+"\r\n")};const n=2147483647,a=/[^\0-\x7F]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=Math.floor,u=String.fromCharCode;function d(e){throw new RangeError(c[e])}const p=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},f=function(e,t,r){let o=0;for(e=r?h(e/700):e>>1,e+=h(e/t);e>455;o+=36)e=h(e/35);return h(o+36*e/(e+38))},g=function(e){return function(e,t){const r=e.split("@");let o="";r.length>1&&(o=r[0]+"@",e=r[1]);const s=function(e,t){const r=[];let o=e.length;for(;o--;)r[o]=t(e[o]);return r}((e=e.replace(l,".")).split("."),t).join(".");return o+s}(e,(function(e){return a.test(e)?"xn--"+function(e){const t=[];e=function(e){const t=[];let r=0;const o=e.length;for(;r<o;){const s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<o){const o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&s)<<10)+(1023&o)+65536):(t.push(s),r--)}else t.push(s)}return t}(e);const r=e.length;let o=128,s=0,i=72;for(const r of e)r<128&&t.push(u(r));const a=t.length;let l=a;for(a&&t.push("-");l<r;){let r=n;for(const t of e)t>=o&&t<r&&(r=t);const c=l+1;r-o>h((n-s)/c)&&d("overflow"),s+=(r-o)*c,o=r;for(const r of e)if(r<o&&++s>n&&d("overflow"),r===o){let e=s;for(let r=36;;r+=36){const o=r<=i?1:r>=i+26?26:r-i;if(e<o)break;const s=e-o,n=36-o;t.push(u(p(o+s%n,0))),e=h(s/n)}t.push(u(p(e,0))),i=f(s,c,l===a),s=0,++l}++s,++o}return t.join("")}(e):e}))};t.TextAttributes=function(e){this.document_=e,this.foregroundSource=this.SRC_DEFAULT,this.backgroundSource=this.SRC_DEFAULT,this.underlineSource=this.SRC_DEFAULT,this.foreground=this.DEFAULT_COLOR,this.background=this.DEFAULT_COLOR,this.underlineColor=this.DEFAULT_COLOR,this.defaultForeground="rgb(var(--hterm-foreground-color))",this.defaultBackground="rgb(var(--hterm-background-color))",this.bold=!1,this.faint=!1,this.italic=!1,this.blink=!1,this.underline=!1,this.strikethrough=!1,this.inverse=!1,this.invisible=!1,this.wcNode=!1,this.asciiNode=!0,this.tileData=null,this.uri=null,this.uriId=null,this.colorPaletteOverrides=[]},t.TextAttributes.prototype.enableBold=!0,t.TextAttributes.prototype.enableBoldAsBright=!0,t.TextAttributes.prototype.DEFAULT_COLOR=Symbol("DEFAULT_COLOR"),t.TextAttributes.prototype.SRC_DEFAULT=Symbol("SRC_DEFAULT"),t.TextAttributes.prototype.setDocument=function(e){this.document_=e},t.TextAttributes.prototype.clone=function(){const e=new t.TextAttributes;for(const t in this)e[t]=this[t];return e.colorPaletteOverrides=this.colorPaletteOverrides.concat(),e},t.TextAttributes.prototype.reset=function(){this.foregroundSource=this.SRC_DEFAULT,this.backgroundSource=this.SRC_DEFAULT,this.underlineSource=this.SRC_DEFAULT,this.foreground=this.DEFAULT_COLOR,this.background=this.DEFAULT_COLOR,this.underlineColor=this.DEFAULT_COLOR,this.bold=!1,this.faint=!1,this.italic=!1,this.blink=!1,this.underline=!1,this.strikethrough=!1,this.inverse=!1,this.invisible=!1,this.wcNode=!1,this.asciiNode=!0,this.uri=null,this.uriId=null},t.TextAttributes.prototype.isDefault=function(){return this.foregroundSource==this.SRC_DEFAULT&&this.backgroundSource==this.SRC_DEFAULT&&!this.bold&&!this.faint&&!this.italic&&!this.blink&&!this.underline&&!this.strikethrough&&!this.inverse&&!this.invisible&&!this.wcNode&&this.asciiNode&&null==this.tileData&&null==this.uri},t.TextAttributes.prototype.createContainer=function(e=""){if(this.isDefault()){const t=this.document_.createTextNode(e);return t.asciiNode=!0,t}const r=this.document_.createElement("span"),o=r.style,s=[];this.foreground!=this.DEFAULT_COLOR&&(o.color=this.foreground.toString()),this.background!=this.DEFAULT_COLOR&&(o.backgroundColor=this.background.toString(),o.display="inline-block"),this.enableBold&&this.bold&&(o.fontWeight="bold"),this.faint&&(r.faint=!0),this.italic&&(o.fontStyle="italic"),this.blink&&(s.push("blink-node"),r.blinkNode=!0);let i="";if(r.underline=this.underline,this.underline&&(i+=" underline",o.textDecorationStyle=this.underline),this.underlineColor!=this.DEFAULT_COLOR&&(o.textDecorationColor=this.underlineColor),this.strikethrough&&(i+=" line-through",r.strikethrough=!0),i&&(o.textDecorationLine=i),this.wcNode&&(s.push("wc-node"),r.wcNode=!0),r.asciiNode=this.asciiNode,null!=this.tileData&&(s.push("tile"),s.push("tile_"+this.tileData),r.tileNode=!0),e&&(r.textContent=e),this.uri){s.push("uri-node"),r.uriId=this.uriId,r.title=this.uri;try{const e=new URL(this.uri),t=g(e.host),o=t===e.host?e.host:t;o&&(r.title+=`\n(${o})`)}catch(e){}r.addEventListener("click",t.openUrl.bind(this,this.uri))}return s.length&&(r.className=s.join(" ")),r},t.TextAttributes.prototype.matchesContainer=function(e){if("string"==typeof e||e.nodeType==Node.TEXT_NODE)return this.isDefault();const t=e.style;return!(this.wcNode||e.wcNode||this.asciiNode!=e.asciiNode||null!=this.tileData||e.tileNode||this.uriId!=e.uriId||this.foreground!=this.DEFAULT_COLOR||""!=t.color||this.background!=this.DEFAULT_COLOR||""!=t.backgroundColor||this.underlineColor!=this.DEFAULT_COLOR||""!=t.textDecorationColor||(this.enableBold&&this.bold)!=!!t.fontWeight||this.blink!=!!e.blinkNode||this.italic!=!!t.fontStyle||this.underline!=e.underline||!!this.strikethrough!=!!e.strikethrough)},t.TextAttributes.prototype.syncColors=function(){const t=(e,t)=>e==this.DEFAULT_COLOR?t:e;this.enableBoldAsBright&&this.bold&&"number"==typeof this.foregroundSource&&Number.isInteger(this.foregroundSource)&&(this.foregroundSource=function(e){return e<8?e+8:e}(this.foregroundSource));const r=e=>e==this.SRC_DEFAULT?this.DEFAULT_COLOR:"number"==typeof e&&Number.isInteger(e)?`rgb(var(--hterm-color-${e}))`:e.toString();if(this.foreground=r(this.foregroundSource),this.faint&&(this.foreground==this.DEFAULT_COLOR?this.foreground="rgba(var(--hterm-foreground-color), 0.67)":"number"==typeof this.foregroundSource&&Number.isInteger(this.foregroundSource)?this.foreground=`rgba(var(--hterm-color-${this.foregroundSource}), 0.67)`:this.foreground=e.colors.setAlpha(this.foreground.toString(),.67)),this.background=r(this.backgroundSource),this.inverse){const e=t(this.foreground,this.defaultForeground);this.foreground=t(this.background,this.defaultBackground),this.background=e}this.invisible&&(this.foreground=this.background),this.underlineColor=r(this.underlineSource)},t.TextAttributes.containersMatch=function(e,r){if("string"==typeof e)return t.TextAttributes.containerIsDefault(r);if(e.nodeType!=r.nodeType)return!1;if(e.nodeType==Node.TEXT_NODE)return!0;const o=e.style,s=r.style;return o.color==s.color&&o.backgroundColor==s.backgroundColor&&o.backgroundColor==s.backgroundColor&&o.fontWeight==s.fontWeight&&o.fontStyle==s.fontStyle&&o.textDecoration==s.textDecoration&&o.textDecorationColor==s.textDecorationColor&&o.textDecorationStyle==s.textDecorationStyle&&o.textDecorationLine==s.textDecorationLine},t.TextAttributes.containerIsDefault=function(e){return"string"==typeof e||e.nodeType==Node.TEXT_NODE},t.TextAttributes.nodeWidth=function(e){return e.asciiNode?e.textContent.length:t.wc.strWidth(e.textContent)},t.TextAttributes.nodeSubstr=function(e,r,o){return e.asciiNode?e.textContent.substr(r,o):t.wc.substr(e.textContent,r,o)},t.TextAttributes.nodeSubstring=function(e,r,o){return e.asciiNode?e.textContent.substring(r,o):t.wc.substring(e.textContent,r,o)},t.TextAttributes.splitWidecharString=function(e){const r=new RegExp("^[ -]*$");if(r.test(e))return[{str:e,wcNode:!1,asciiNode:!0,wcStrWidth:e.length}];const o=new Intl.Segmenter(void 0,{type:"grapheme"}).segment(e),s=[];for(const e of o){const o=e.segment,i=r.test(o),n=i?1:t.wc.strWidth(o),a=!i&&2==t.wc.charWidth(o.codePointAt(0)),l=s[s.length-1];!l||a||l.wcNode?s.push({str:o,wcNode:a,asciiNode:i,wcStrWidth:n}):(l.str+=o,l.wcStrWidth+=n,l.asciiNode=l.asciiNode&&i)}return s},t.VT=function(e){this.terminal=e,e.onMouse=this.onTerminalMouse_.bind(this),this.mouseReport=this.MOUSE_REPORT_DISABLED,this.mouseCoordinates=this.MOUSE_COORDINATES_X10,this.lastMouseDragResponse_=null,this.parseState_=new t.VT.ParseState(this.parseUnknown_),this.leadingModifier_="",this.trailingModifier_="",this.allowColumnWidthChanges_=!1,this.oscTimeLimit_=2e4,this.enable8BitControl=!1,this.enableClipboardWrite=!0,this.enableDec12=!1,this.enableCsiJ3=!0,this.warnUnimplemented=!1,this.characterMaps=new t.VT.CharacterMaps,this.G0=this.G1=this.G2=this.G3=this.characterMaps.getMap("B"),this.GL="G0",this.GR="G0",this.codingSystemUtf8_=!1,this.codingSystemLocked_=!1,this.cc1Pattern_=null,this.updateEncodingState_()},t.VT.prototype.MOUSE_REPORT_DISABLED=0,t.VT.prototype.MOUSE_REPORT_PRESS=1,t.VT.prototype.MOUSE_REPORT_CLICK=2,t.VT.prototype.MOUSE_REPORT_DRAG=3,t.VT.prototype.MOUSE_COORDINATES_X10=0,t.VT.prototype.MOUSE_COORDINATES_UTF8=1,t.VT.prototype.MOUSE_COORDINATES_SGR=2,t.VT.ParseState=function(e,t=null){this.defaultFunction=e,this.buf=t,this.pos=0,this.func=e,this.args=[],this.subargs=null},t.VT.ParseState.prototype.reset=function(e=""){this.resetParseFunction(),this.resetBuf(e),this.resetArguments()},t.VT.ParseState.prototype.resetParseFunction=function(){this.func=this.defaultFunction},t.VT.ParseState.prototype.resetBuf=function(e=null){this.buf=e,this.pos=0},t.VT.ParseState.prototype.resetArguments=function(e=void 0){this.args.length=0,void 0!==e&&(this.args[0]=e)},t.VT.ParseState.prototype.parseInt=function(e,t){if(void 0===t&&(t=0),e){const r=parseInt(e,10);return 0==r?t:r}return t},t.VT.ParseState.prototype.iarg=function(e,t){return this.parseInt(this.args[e],t)},t.VT.ParseState.prototype.argHasSubargs=function(e){return!(!this.subargs||!this.subargs[e])},t.VT.ParseState.prototype.argSetSubargs=function(e){null===this.subargs&&(this.subargs={}),this.subargs[e]=!0},t.VT.ParseState.prototype.advance=function(e){this.pos+=e},t.VT.ParseState.prototype.peekRemainingBuf=function(){return this.buf.substr(this.pos)},t.VT.ParseState.prototype.peekChar=function(){return this.buf.substr(this.pos,1)},t.VT.ParseState.prototype.consumeChar=function(){return this.buf.substr(this.pos++,1)},t.VT.ParseState.prototype.isComplete=function(){return null==this.buf||this.buf.length<=this.pos},t.VT.prototype.resetParseState=function(){this.parseState_.reset()},t.VT.prototype.reset=function(){this.G0=this.G1=this.G2=this.G3=this.characterMaps.getMap("B"),this.GL="G0",this.GR="G0",this.mouseReport=this.MOUSE_REPORT_DISABLED,this.mouseCoordinates=this.MOUSE_COORDINATES_X10,this.lastMouseDragResponse_=null},t.VT.prototype.onTerminalMouse_=function(t){if(this.mouseReport==this.MOUSE_REPORT_DISABLED)return;if(this.mouseReport!=this.MOUSE_REPORT_DRAG&&"mousemove"==t.type)return;let r,o,s,i=0;this.mouseReport!=this.MOUSE_REPORT_PRESS&&(t.shiftKey&&(i|=4),(t.metaKey||this.terminal.keyboard.altIsMeta&&t.altKey)&&(i|=8),t.ctrlKey&&(i|=16));let n,a=127;switch(this.mouseCoordinates){case this.MOUSE_COORDINATES_UTF8:a=2047;case this.MOUSE_COORDINATES_X10:o=String.fromCharCode(e.f.clamp(t.terminalColumn+32,32,a)),s=String.fromCharCode(e.f.clamp(t.terminalRow+32,32,a));break;case this.MOUSE_COORDINATES_SGR:o=t.terminalColumn,s=t.terminalRow}switch(t.type){case"wheel":n=64+(-1*t.deltaY>0?0:1),n|=i,r=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?`[<${n};${o};${s}M`:"[M"+String.fromCharCode(n+32)+o+s,t.preventDefault();break;case"mousedown":n=Math.min(t.button,2),this.mouseCoordinates!=this.MOUSE_COORDINATES_SGR&&(n+=32),n|=i,r=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?`[<${n};${o};${s}M`:"[M"+String.fromCharCode(n)+o+s;break;case"mouseup":this.mouseReport!=this.MOUSE_REPORT_PRESS&&(r=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?`[<${t.button};${o};${s}m`:"[M#"+o+s);break;case"mousemove":this.mouseReport==this.MOUSE_REPORT_DRAG&&t.buttons&&(n=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?0:32,1&t.buttons?n+=0:4&t.buttons?n+=1:2&t.buttons?n+=2:n+=3,n+=32,n|=i,r=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?`[<${n};${o};${s}M`:"[M"+String.fromCharCode(n)+o+s,this.lastMouseDragResponse_==r?r="":this.lastMouseDragResponse_=r);break;case"click":case"dblclick":break;default:console.error("Unknown mouse event: "+t.type,t)}r&&this.terminal.io.sendString(r)},t.VT.prototype.interpret=function(e){for(this.parseState_.resetBuf(e);!this.parseState_.isComplete();){const e=this.parseState_.func,t=this.parseState_.pos,r=this.parseState_.buf;if(this.parseState_.func.call(this,this.parseState_),this.parseState_.func==e&&this.parseState_.pos==t&&this.parseState_.buf==r)throw new Error("Parser did not alter the state!")}},t.VT.prototype.setEncoding=function(e){switch(e){default:console.warn('Invalid value for "terminal-encoding": '+e);case"iso-2022":this.codingSystemUtf8_=!1,this.codingSystemLocked_=!1;break;case"utf-8-locked":this.codingSystemUtf8_=!0,this.codingSystemLocked_=!0;break;case"utf-8":this.codingSystemUtf8_=!0,this.codingSystemLocked_=!1}this.updateEncodingState_()},t.VT.prototype.updateEncodingState_=function(){const r=Object.keys(t.VT.CC1).filter((e=>!this.codingSystemUtf8_||e.charCodeAt()<128)).map((t=>"\\x"+e.f.zpad(t.charCodeAt().toString(16),2))).join("");this.cc1Pattern_=new RegExp(`[${r}]`)},t.VT.prototype.parseUnknown_=function(e){const t=e=>{!this.codingSystemUtf8_&&this[this.GL].GL&&(e=this[this.GL].GL(e)),this.terminal.print(e)},r=e.peekRemainingBuf(),o=r.search(this.cc1Pattern_);return 0==o?(this.dispatch("CC1",r.substr(0,1),e),void e.advance(1)):-1==o?(t(r),void e.reset()):(t(r.substr(0,o)),this.dispatch("CC1",r.substr(o,1),e),void e.advance(o+1))},t.VT.prototype.parseCSI_=function(e){const t=e.peekChar(),r=e.args,o=()=>{e.resetArguments(),e.subargs=null,e.resetParseFunction()};t>="@"&&t<="~"?(this.dispatch("CSI",this.leadingModifier_+this.trailingModifier_+t,e),o()):";"==t?this.trailingModifier_?o():(r.length||r.push(""),r.push("")):t>="0"&&t<="9"||":"==t?this.trailingModifier_?o():(r.length?r[r.length-1]+=t:r[0]=t,":"==t&&e.argSetSubargs(r.length-1)):t>=" "&&t<="?"?r.length?this.trailingModifier_+=t:this.leadingModifier_+=t:this.cc1Pattern_.test(t)?this.dispatch("CC1",t,e):o(),e.advance(1)},t.VT.prototype.parseDCS_=function(e){const t=e.peekChar(),r=e.args,o=()=>{e.resetArguments(),e.resetParseFunction()};if(t>="@"&&t<="~")return e.advance(1),this.dispatch("DCS",this.leadingModifier_+this.trailingModifier_+t,e),void(e.func===this.parseDCS_&&(e.func=this.parseUntilStringTerminator_));";"===t?this.trailingModifier_?o():(r.length||r.push(""),r.push("")):t>="0"&&t<="9"?this.trailingModifier_?o():r.length?r[r.length-1]+=t:r[0]=t:t>=" "&&t<="?"?r.length?this.trailingModifier_+=t:this.leadingModifier_+=t:this.cc1Pattern_.test(t)?this.dispatch("CC1",t,e):o(),e.advance(1)},t.VT.prototype.parseTmuxControlModeData_=function(e){const t=e.args;for(t.length||(t[0]="");;){const r=t[0].length,o=t[0]+e.peekRemainingBuf();t[0]="";const s=o.search(/\x1b\\|\r\n/);if(-1===s)return e.args[0]=o,void e.resetBuf();const i=o.slice(0,s);if(e.advance(s+2-r),""===o[s])return i&&console.error(`unexpected data before ST: ${i}`),this.terminal.onTmuxControlModeLine(null),e.resetArguments(),void e.resetParseFunction();this.terminal.onTmuxControlModeLine(i)}},t.VT.prototype.parseUntilStringTerminator_=function(e){let t=e.peekRemainingBuf();const r=e.args;let o=0;r.length?""==r[0].slice(-1)&&(r[0]=r[0].slice(0,-1),t=""+t,o=1):(r[0]="",r[1]=(new Date).getTime());const s=t.search(/[\x1b\x07]/),i=t[s];let n;if(n=(""!=i||"\\"==t[s+1])&&-1!=s,!n){let n;r[0]+=t,""==i&&s!=t.length-1&&(n="embedded escape: "+s);const a=(new Date).getTime()-r[1];return a>this.oscTimeLimit_&&(n=`timeout expired: ${a}s`),n?(this.warnUnimplemented&&console.log("parseUntilStringTerminator_: aborting: "+n,r[0]),e.reset(r[0]),!1):(e.advance(t.length-o),!0)}return r[0]+=t.substr(0,s),e.resetParseFunction(),e.advance(s+(""==i?2:1)-o),!0},t.VT.prototype.dispatch=function(e,r,o){const s=t.VT[e][r];s?s!=t.VT.ignore?!o.subargs||s.supportsSubargs?"CC1"==e&&r>""&&!this.enable8BitControl?console.warn("Ignoring 8-bit control code: 0x"+r.charCodeAt(0).toString(16)):s.apply(this,[o,r]):this.warnUnimplemented&&console.warn(`Ignored ${e} code w/subargs: ${JSON.stringify(r)}`):this.warnUnimplemented&&console.warn(`Ignored ${e} code: ${JSON.stringify(r)}`):this.warnUnimplemented&&console.warn(`Unknown ${e} code: ${JSON.stringify(r)}`)},t.VT.prototype.setANSIMode=function(e,t){4==e?this.terminal.setInsertMode(t):20==e?this.terminal.setAutoCarriageReturn(t):this.warnUnimplemented&&console.warn("Unimplemented ANSI Mode: "+e)},t.VT.prototype.setDECMode=function(e,t){switch(parseInt(e,10)){case 1:this.terminal.keyboard.applicationCursor=t;break;case 3:this.allowColumnWidthChanges_&&(this.terminal.setWidth(t?132:80),this.terminal.clearHome(),this.terminal.setVTScrollRegion(null,null));break;case 5:this.terminal.setReverseVideo(t);break;case 6:this.terminal.setOriginMode(t);break;case 7:this.terminal.setWraparound(t);break;case 9:this.mouseReport=t?this.MOUSE_REPORT_PRESS:this.MOUSE_REPORT_DISABLED,this.terminal.syncMouseStyle();break;case 12:this.enableDec12&&this.terminal.setCursorBlink(t);break;case 25:this.terminal.setCursorVisible(t);break;case 30:this.terminal.setScrollbarVisible(t);break;case 40:this.terminal.allowColumnWidthChanges_=t;break;case 45:this.terminal.setReverseWraparound(t);break;case 67:this.terminal.keyboard.backspaceSendsBackspace=t;break;case 1e3:this.mouseReport=t?this.MOUSE_REPORT_CLICK:this.MOUSE_REPORT_DISABLED,this.terminal.syncMouseStyle();break;case 1002:this.mouseReport=t?this.MOUSE_REPORT_DRAG:this.MOUSE_REPORT_DISABLED,this.terminal.syncMouseStyle();break;case 1004:this.terminal.reportFocus=t;break;case 1005:this.mouseCoordinates=t?this.MOUSE_COORDINATES_UTF8:this.MOUSE_COORDINATES_X10;break;case 1006:this.mouseCoordinates=t?this.MOUSE_COORDINATES_SGR:this.MOUSE_COORDINATES_X10;break;case 1007:this.terminal.scrollWheelArrowKeys_=t;break;case 1010:this.terminal.scrollOnOutput=t;break;case 1011:this.terminal.scrollOnKeystroke=t;break;case 1036:this.terminal.keyboard.metaSendsEscape=t;break;case 1039:t?this.terminal.keyboard.previousAltSendsWhat_||(this.terminal.keyboard.previousAltSendsWhat_=this.terminal.keyboard.altSendsWhat,this.terminal.keyboard.altSendsWhat="escape"):this.terminal.keyboard.previousAltSendsWhat_&&(this.terminal.keyboard.altSendsWhat=this.terminal.keyboard.previousAltSendsWhat_,this.terminal.keyboard.previousAltSendsWhat_=null);break;case 47:case 1047:this.terminal.setAlternateMode(t);break;case 1048:t?this.terminal.saveCursorAndState():this.terminal.restoreCursorAndState();break;case 1049:t?(this.terminal.saveCursorAndState(),this.terminal.setAlternateMode(t),this.terminal.clear()):(this.terminal.setAlternateMode(t),this.terminal.restoreCursorAndState());break;case 2004:this.terminal.setBracketedPaste(t);break;default:this.warnUnimplemented&&console.warn("Unimplemented DEC Private Mode: "+e)}},t.VT.ignore=function(){},t.VT.CC1={},t.VT.ESC={},t.VT.CSI={},t.VT.DCS={},t.VT.OSC={},t.VT.VT52={},t.VT.CC1["\0"]=t.VT.ignore,t.VT.CC1[""]=t.VT.ignore,t.VT.CC1[""]=function(){this.terminal.ringBell()},t.VT.CC1["\b"]=function(){this.terminal.cursorLeft(1)},t.VT.CC1["\t"]=function(){this.terminal.forwardTabStop()},t.VT.CC1["\n"]=function(){this.terminal.formFeed()},t.VT.CC1["\v"]=t.VT.CC1["\n"],t.VT.CC1["\f"]=t.VT.CC1["\n"],t.VT.CC1["\r"]=function(){this.terminal.setCursorColumn(0)},t.VT.CC1[""]=function(){this.GL="G1"},t.VT.CC1[""]=function(){this.GL="G0"},t.VT.CC1[""]=t.VT.ignore,t.VT.CC1[""]=t.VT.ignore,t.VT.CC1[""]=function(e){"G1"==this.GL&&(this.GL="G0"),e.resetParseFunction(),this.terminal.print("?")},t.VT.CC1[""]=t.VT.CC1[""],t.VT.CC1[""]=function(e){e.func=function e(t){const r=t.consumeChar();""!=r&&(this.dispatch("ESC",r,t),t.func==e&&t.resetParseFunction())}},t.VT.CC1[""]=t.VT.ignore,t.VT.CC1[""]=t.VT.ESC.D=function(){this.terminal.lineFeed()},t.VT.CC1[""]=t.VT.ESC.E=function(){this.terminal.setCursorColumn(0),this.terminal.cursorDown(1)},t.VT.CC1[""]=t.VT.ESC.H=function(){this.terminal.setTabStop(this.terminal.getCursorColumn())},t.VT.CC1[""]=t.VT.ESC.M=function(){this.terminal.reverseLineFeed()},t.VT.CC1[""]=t.VT.ESC.N=t.VT.ignore,t.VT.CC1[""]=t.VT.ESC.O=t.VT.ignore,t.VT.CC1[""]=t.VT.ESC.P=function(e){e.resetArguments(),this.leadingModifier_="",this.trailingModifier_="",e.func=this.parseDCS_},t.VT.CC1[""]=t.VT.ESC.V=t.VT.ignore,t.VT.CC1[""]=t.VT.ESC.W=t.VT.ignore,t.VT.CC1[""]=t.VT.ESC.X=t.VT.ignore,t.VT.CC1[""]=t.VT.ESC.Z=function(){this.terminal.io.sendString("[?1;2c")},t.VT.CC1[""]=t.VT.ESC["["]=function(e){e.resetArguments(),this.leadingModifier_="",this.trailingModifier_="",e.func=this.parseCSI_},t.VT.CC1[""]=t.VT.ESC["\\"]=t.VT.ignore,t.VT.CC1[""]=t.VT.ESC["]"]=function(e){e.resetArguments(),e.func=function e(t){if(!this.parseUntilStringTerminator_(t))return;if(t.func==e)return;const r=t.args[0].match(/^(\d+);?(.*)$/);r?(t.args[0]=r[2],this.dispatch("OSC",r[1],t)):console.warn("Invalid OSC: "+JSON.stringify(t.args[0])),t.resetArguments()}},t.VT.CC1[""]=t.VT.ESC["^"]=function(e){e.resetArguments(),e.func=this.parseUntilStringTerminator_},t.VT.CC1[""]=t.VT.ESC._=function(e){e.resetArguments(),e.func=this.parseUntilStringTerminator_},t.VT.ESC[" "]=function(e){e.func=function(e){const t=e.consumeChar();this.warnUnimplemented&&console.warn("Unimplemented sequence: ESC 0x20 "+t),e.resetParseFunction()}},t.VT.ESC["#"]=function(e){e.func=function(e){"8"==e.consumeChar()&&(this.terminal.setCursorPosition(0,0),this.terminal.fill("E")),e.resetParseFunction()}},t.VT.ESC["%"]=function(e){e.func=function(e){let t=e.consumeChar();if(this.codingSystemLocked_)return"/"==t&&e.consumeChar(),void e.resetParseFunction();switch(t){case"@":this.setEncoding("iso-2022");break;case"G":this.setEncoding("utf-8");break;case"/":switch(t=e.consumeChar(),t){case"G":case"H":case"I":this.setEncoding("utf-8-locked");break;default:this.warnUnimplemented&&console.warn("Unknown ESC % / argument: "+JSON.stringify(t))}break;default:this.warnUnimplemented&&console.warn("Unknown ESC % argument: "+JSON.stringify(t))}e.resetParseFunction()}},t.VT.ESC["("]=t.VT.ESC[")"]=t.VT.ESC["*"]=t.VT.ESC["+"]=t.VT.ESC["-"]=t.VT.ESC["."]=t.VT.ESC["/"]=function(e,t){e.func=function(e){if(""===e.peekChar())return void e.resetParseFunction();const r=e.consumeChar(),o=this.characterMaps.getMap(r);void 0!==o?"("==t?this.G0=o:")"==t||"-"==t?this.G1=o:"*"==t||"."==t?this.G2=o:"+"!=t&&"/"!=t||(this.G3=o):this.warnUnimplemented&&console.log('Invalid character set for "'+t+'": '+r),e.resetParseFunction()}},t.VT.ESC[6]=t.VT.ignore,t.VT.ESC[7]=function(){this.terminal.saveCursorAndState()},t.VT.ESC[8]=function(){this.terminal.restoreCursorAndState()},t.VT.ESC[9]=t.VT.ignore,t.VT.ESC["="]=function(){this.terminal.keyboard.applicationKeypad=!0},t.VT.ESC[">"]=function(){this.terminal.keyboard.applicationKeypad=!1},t.VT.ESC.F=t.VT.ignore,t.VT.ESC.c=function(){this.terminal.reset()},t.VT.ESC.k=function(e){e.resetArguments(),e.func=function e(t){this.parseUntilStringTerminator_(t)&&t.func!==e&&(this.terminal.setWindowName(t.args[0]),t.resetArguments())}},t.VT.ESC.l=t.VT.ESC.m=t.VT.ignore,t.VT.ESC.n=function(){this.GL="G2"},t.VT.ESC.o=function(){this.GL="G3"},t.VT.ESC["|"]=function(){this.GR="G3"},t.VT.ESC["}"]=function(){this.GR="G2"},t.VT.ESC["~"]=function(){this.GR="G1"},t.VT.DCS.p=function(e){1===e.args.length&&"1000"===e.args[0]&&(e.resetArguments(),e.func=this.parseTmuxControlModeData_)},t.VT.OSC[0]=function(e){this.terminal.setWindowTitle(e.args[0])},t.VT.OSC[2]=t.VT.OSC[0],t.VT.OSC[4]=function(t){const r=t.args[0].split(";"),o=Math.floor(r.length/2),s=[];for(let t=0;t<o;++t){const o=parseInt(r[2*t],10);let i=r[2*t+1];o>=e.colors.stockPalette.length||("?"!=i?(i=e.colors.x11ToCSS(i),i&&this.terminal.setColorPalette(o,i)):(i=e.colors.rgbToX11(this.terminal.getColorPalette(o)),i&&s.push(o+";"+i)))}s.length&&this.terminal.io.sendString("]4;"+s.join(";")+"")},t.VT.OSC[8]=function(e){const t=e.args[0].split(";");let r=null,o=null;if(2===t.length&&t[1].length){const e=t[0].split(":");r="",e.forEach((e=>{const t=e.indexOf("=");if(-1==t)return;const o=e.slice(0,t),s=e.slice(t+1);if("id"===o)r=s})),o=t[1]}const s=this.terminal.getTextAttributes();s.uri=o,s.uriId=r},t.VT.OSC[9]=function(e){t.notify({body:e.args[0]})},t.VT.OSC[10]=function(r){const o=r.args[0].split(";");if(!o)return;const s=e.colors.x11ToCSS(o.shift());s&&this.terminal.setForegroundColor(s),o.length>0&&(r.args[0]=o.join(";"),t.VT.OSC[11].apply(this,[r]))},t.VT.OSC[11]=function(r){const o=r.args[0].split(";");if(!o)return;const s=e.colors.x11ToCSS(o.shift());s&&this.terminal.setBackgroundColor(s),o.length>0&&(r.args[0]=o.join(";"),t.VT.OSC[12].apply(this,[r]))},t.VT.OSC[12]=function(t){const r=t.args[0].split(";");if(!r)return;const o=e.colors.x11ToCSS(r.shift());if(o){const t=e.colors.crackRGB(this.terminal.getCursorColor())[3];this.terminal.setCursorColor(e.colors.setAlpha(o,t))}},t.VT.OSC[50]=function(e){const r=e.args[0].match(/CursorShape=(.)/i);if(r)switch(r[1]){case"1":this.terminal.setCursorShape(t.Terminal.cursorShape.BEAM);break;case"2":this.terminal.setCursorShape(t.Terminal.cursorShape.UNDERLINE);break;default:this.terminal.setCursorShape(t.Terminal.cursorShape.BLOCK)}else console.warn("Could not parse OSC 50 args: "+e.args[0])},t.VT.OSC[52]=function(t){if(!this.enableClipboardWrite)return;const r=t.args[0].match(/^[cps01234567]*;(.*)/);if(!r)return;let o;try{o=globalThis.atob(r[1])}catch(e){return}const s=new TextDecoder,i=e.codec.stringToCodeUnitArray(o);o=s.decode(i),o&&this.terminal.copyStringToClipboard(o)},t.VT.OSC[104]=function(e){if(!e.args[0])return void this.terminal.resetColorPalette();e.args[0].split(";").forEach((e=>this.terminal.resetColor(e)))},t.VT.OSC[110]=function(e){this.terminal.setForegroundColor()},t.VT.OSC[111]=function(e){this.terminal.setBackgroundColor()},t.VT.OSC[112]=function(e){this.terminal.setCursorColor()},t.VT.OSC[1337]=function(t){const r=t.args[0].match(/^File=([^:]*):([\s\S]*)$/m);if(!r)return void(this.warnUnimplemented&&console.log(`iTerm2 1337: unsupported sequence: ${r[1]}`));const o={name:"",size:0,preserveAspectRatio:!0,inline:!1,width:"auto",height:"auto",align:"left",type:"",buffer:e.codec.stringToCodeUnitArray(atob(r[2])).buffer};if(r[1].split(";").forEach((e=>{const t=e.match(/^([^=]+)=(.*)$/m);if(t)switch(t[1]){case"name":try{o.name=globalThis.atob(t[2])}catch(e){}break;case"size":try{o.size=parseInt(t[2],10)}catch(e){}break;case"width":o.width=t[2];break;case"height":o.height=t[2];break;case"preserveAspectRatio":o.preserveAspectRatio=!("0"==t[2]);break;case"inline":o.inline=!("0"==t[2]);break;case"align":o.align=t[2];break;case"type":o.type=t[2]}})),o.inline){const e=this.terminal.io,r=t.peekRemainingBuf();t.advance(r.length),this.terminal.displayImage(o),e.print(r)}else this.terminal.displayImage(o)},t.VT.OSC[777]=function(e){let r;switch(e.args[0].split(";",1)[0]){case"notify":{let o,s;r=e.args[0].match(/^[^;]+;([^;]*)(;([\s\S]*))?$/),r&&(o=r[1],s=r[3]),t.notify({title:o,body:s});break}default:console.warn("Unknown urxvt module: "+e.args[0])}},t.VT.CSI["@"]=function(e){this.terminal.insertSpace(e.iarg(0,1))},t.VT.CSI.A=function(e){this.terminal.cursorUp(e.iarg(0,1))},t.VT.CSI.B=function(e){this.terminal.cursorDown(e.iarg(0,1))},t.VT.CSI.C=function(e){this.terminal.cursorRight(e.iarg(0,1))},t.VT.CSI.D=function(e){this.terminal.cursorLeft(e.iarg(0,1))},t.VT.CSI.E=function(e){this.terminal.cursorDown(e.iarg(0,1)),this.terminal.setCursorColumn(0)},t.VT.CSI.F=function(e){this.terminal.cursorUp(e.iarg(0,1)),this.terminal.setCursorColumn(0)},t.VT.CSI.G=function(e){this.terminal.setCursorColumn(e.iarg(0,1)-1)},t.VT.CSI.H=function(e){this.terminal.setCursorPosition(e.iarg(0,1)-1,e.iarg(1,1)-1)},t.VT.CSI.I=function(t){let r=t.iarg(0,1);r=e.f.clamp(r,1,this.terminal.screenSize.width);for(let e=0;e<r;e++)this.terminal.forwardTabStop()},t.VT.CSI.J=t.VT.CSI["?J"]=function(e){const t=e.args[0];t&&0!=t?1==t?this.terminal.eraseAbove():2==t?this.terminal.clear():3==t&&this.enableCsiJ3&&this.terminal.clearScrollback():this.terminal.eraseBelow()},t.VT.CSI.K=t.VT.CSI["?K"]=function(e){const t=e.args[0];t&&0!=t?1==t?this.terminal.eraseToLeft():2==t&&this.terminal.eraseLine():this.terminal.eraseToRight()},t.VT.CSI.L=function(e){this.terminal.insertLines(e.iarg(0,1))},t.VT.CSI.M=function(e){this.terminal.deleteLines(e.iarg(0,1))},t.VT.CSI.P=function(e){this.terminal.deleteChars(e.iarg(0,1))},t.VT.CSI.S=function(e){this.terminal.vtScrollUp(e.iarg(0,1))},t.VT.CSI.T=function(e){e.args.length<=1&&this.terminal.vtScrollDown(e.iarg(0,1))},t.VT.CSI[">T"]=t.VT.ignore,t.VT.CSI.X=function(e){this.terminal.eraseToRight(e.iarg(0,1))},t.VT.CSI.Z=function(t){let r=t.iarg(0,1);r=e.f.clamp(r,1,this.terminal.screenSize.width);for(let e=0;e<r;e++)this.terminal.backwardTabStop()},t.VT.CSI["`"]=t.VT.CSI.G,t.VT.CSI.a=function(e){this.terminal.setCursorColumn(this.terminal.getCursorColumn()+e.iarg(0,1))},t.VT.CSI.b=t.VT.ignore,t.VT.CSI.c=function(e){e.args[0]&&0!=e.args[0]||this.terminal.io.sendString("[?1;2c")},t.VT.CSI[">c"]=function(e){this.terminal.io.sendString("[>0;256;0c")},t.VT.CSI.d=function(e){this.terminal.setAbsoluteCursorRow(e.iarg(0,1)-1)},t.VT.CSI.f=t.VT.CSI.H,t.VT.CSI.g=function(e){e.args[0]&&0!=e.args[0]?3==e.args[0]&&this.terminal.clearAllTabStops():this.terminal.clearTabStopAtCursor()},t.VT.CSI.h=function(e){for(let t=0;t<e.args.length;t++)this.setANSIMode(e.args[t],!0)},t.VT.CSI["?h"]=function(e){for(let t=0;t<e.args.length;t++)this.setDECMode(e.args[t],!0)},t.VT.CSI.i=t.VT.CSI["?i"]=t.VT.ignore,t.VT.CSI.l=function(e){for(let t=0;t<e.args.length;t++)this.setANSIMode(e.args[t],!1)},t.VT.CSI["?l"]=function(e){for(let t=0;t<e.args.length;t++)this.setDECMode(e.args[t],!1)},t.VT.prototype.parseSgrExtendedColors=function(t,r,o){let s,i;if(t.argHasSubargs(r))s=t.args[r].split(":"),s.shift(),i=!0;else{if(t.argHasSubargs(r+1))return{skipCount:0};s=t.args.slice(r+1),i=!1}switch(parseInt(s[0],10)){default:case 0:return{skipCount:0};case 1:return i?{color:"rgba(0, 0, 0, 0)",skipCount:0}:{skipCount:0};case 2:{let e;if(e=i?4==s.length?1:2:1,s.length<e+3)return{skipCount:0};return{color:`rgb(${t.parseInt(s[e+0])}, ${t.parseInt(s[e+1])}, ${t.parseInt(s[e+2])})`,skipCount:i?0:4}}case 3:case 4:return i?(s.length,{skipCount:0}):{skipCount:0};case 5:{if(s.length<2)return{skipCount:0};const r={skipCount:i?0:2},o=t.parseInt(s[1]);return o<e.colors.stockPalette.length&&(r.color=o),r}}},t.VT.CSI.m=function(e){const t=this.terminal.getTextAttributes();if(e.args.length){for(let r=0;r<e.args.length;r++){const o=e.iarg(r,0);if(o<30)if(0==o)t.reset();else if(1==o)t.bold=!0;else if(2==o)t.faint=!0;else if(3==o)t.italic=!0;else if(4==o)if(e.argHasSubargs(r)){const o=e.args[r].split(":")[1];0==o?t.underline=!1:1==o?t.underline="solid":2==o?t.underline="double":3==o?t.underline="wavy":4==o?t.underline="dotted":5==o&&(t.underline="dashed")}else t.underline="solid";else 5==o?t.blink=!0:7==o?t.inverse=!0:8==o?t.invisible=!0:9==o?t.strikethrough=!0:21==o?t.underline="double":22==o?(t.bold=!1,t.faint=!1):23==o?t.italic=!1:24==o?t.underline=!1:25==o?t.blink=!1:27==o?t.inverse=!1:28==o?t.invisible=!1:29==o&&(t.strikethrough=!1);else if(o<50)if(o<38)t.foregroundSource=o-30;else if(38==o){const o=this.parseSgrExtendedColors(e,r,t);void 0!==o.color&&(t.foregroundSource=o.color),r+=o.skipCount}else if(39==o)t.foregroundSource=t.SRC_DEFAULT;else if(o<48)t.backgroundSource=o-40;else if(48==o){const o=this.parseSgrExtendedColors(e,r,t);void 0!==o.color&&(t.backgroundSource=o.color),r+=o.skipCount}else t.backgroundSource=t.SRC_DEFAULT;else if(58==o){const o=this.parseSgrExtendedColors(e,r,t);void 0!==o.color&&(t.underlineSource=o.color),r+=o.skipCount}else 59==o?t.underlineSource=t.SRC_DEFAULT:o>=90&&o<=97?t.foregroundSource=o-90+8:o>=100&&o<=107&&(t.backgroundSource=o-100+8)}t.syncColors()}else t.reset()},t.VT.CSI.m.supportsSubargs=!0,t.VT.CSI[">m"]=t.VT.ignore,t.VT.CSI.n=function(e){if(5==e.args[0])this.terminal.io.sendString("0n");else if(6==e.args[0]){const e=this.terminal.getCursorRow()+1,t=this.terminal.getCursorColumn()+1;this.terminal.io.sendString("["+e+";"+t+"R")}},t.VT.CSI[">n"]=t.VT.ignore,t.VT.CSI["?n"]=function(e){if(6==e.args[0]){const e=this.terminal.getCursorRow()+1,t=this.terminal.getCursorColumn()+1;this.terminal.io.sendString("["+e+";"+t+"R")}else 15==e.args[0]?this.terminal.io.sendString("[?11n"):25==e.args[0]?this.terminal.io.sendString("[?21n"):26==e.args[0]?this.terminal.io.sendString("[?12;1;0;0n"):53==e.args[0]&&this.terminal.io.sendString("[?50n")},t.VT.CSI[">p"]=t.VT.ignore,t.VT.CSI["!p"]=function(){this.terminal.softReset()},t.VT.CSI.$p=t.VT.ignore,t.VT.CSI["?$p"]=t.VT.ignore,t.VT.CSI['"p']=t.VT.ignore,t.VT.CSI.q=t.VT.ignore,t.VT.CSI[" q"]=function(e){const r=e.args[0];0==r||1==r?(this.terminal.setCursorShape(t.Terminal.cursorShape.BLOCK),this.terminal.setCursorBlink(!0)):2==r?(this.terminal.setCursorShape(t.Terminal.cursorShape.BLOCK),this.terminal.setCursorBlink(!1)):3==r?(this.terminal.setCursorShape(t.Terminal.cursorShape.UNDERLINE),this.terminal.setCursorBlink(!0)):4==r?(this.terminal.setCursorShape(t.Terminal.cursorShape.UNDERLINE),this.terminal.setCursorBlink(!1)):5==r?(this.terminal.setCursorShape(t.Terminal.cursorShape.BEAM),this.terminal.setCursorBlink(!0)):6==r?(this.terminal.setCursorShape(t.Terminal.cursorShape.BEAM),this.terminal.setCursorBlink(!1)):console.warn("Unknown cursor style: "+r)},t.VT.CSI['"q']=t.VT.ignore,t.VT.CSI.r=function(e){const t=e.args,r=t[0]?parseInt(t[0],10):0,o=t[1]?parseInt(t[1],10):this.terminal.screenSize.height;r<0||o>this.terminal.screenSize.height||o<=r||(this.terminal.setVTScrollRegion(0===r?null:r-1,o-1),this.terminal.setCursorPosition(0,0))},t.VT.CSI["?r"]=t.VT.ignore,t.VT.CSI.$r=t.VT.ignore,t.VT.CSI.s=function(){this.terminal.saveCursorAndState()},t.VT.CSI["?s"]=t.VT.ignore,t.VT.CSI.t=function(e){const t=e.args;switch(t[0]?parseInt(t[0],10):0){case 16:{const e=Math.floor(this.terminal.scrollPort_.characterSize.height),t=Math.floor(this.terminal.scrollPort_.characterSize.width);this.terminal.io.sendString(`[6;${e};${t}t`);break}}},t.VT.CSI.$t=t.VT.ignore,t.VT.CSI[">t"]=t.VT.ignore,t.VT.CSI[" t"]=t.VT.ignore,t.VT.CSI.u=function(){this.terminal.restoreCursorAndState()},t.VT.CSI[" u"]=t.VT.ignore,t.VT.CSI.$v=t.VT.ignore,t.VT.CSI["'w"]=t.VT.ignore,t.VT.CSI.x=t.VT.ignore,t.VT.CSI["*x"]=t.VT.ignore,t.VT.CSI.$x=t.VT.ignore,t.VT.CSI.z=function(e){if(e.args.length<1)return;const t=e.args[0];if(0==t){if(e.args.length<2)return;this.terminal.getTextAttributes().tileData=e.args[1]}else 1==t&&(this.terminal.getTextAttributes().tileData=null)},t.VT.CSI["'z"]=t.VT.ignore,t.VT.CSI.$z=t.VT.ignore,t.VT.CSI["'{"]=t.VT.ignore,t.VT.CSI["'|"]=t.VT.ignore,t.VT.CSI["'}"]=t.VT.ignore,t.VT.CSI["'~"]=t.VT.ignore,t.VT.CharacterMap=function(e,t){this.description=e,this.GL=null,this.glmapBase_=t,this.sync_()},t.VT.CharacterMap.prototype.sync_=function(t=void 0){if(!this.glmapBase_&&!t)return this.GL=null,delete this.glmap_,void delete this.glre_;this.glmap_=t?Object.assign({},this.glmapBase_,t):this.glmapBase_;const r=Object.keys(e.notNull(this.glmap_)).map((t=>"\\x"+e.f.zpad(t.charCodeAt(0).toString(16),2)));this.glre_=new RegExp("["+r.join("")+"]","g"),this.GL=e=>e.replace(this.glre_,(e=>this.glmap_[e]))},t.VT.CharacterMap.prototype.reset=function(){this.glmap_!==this.glmapBase_&&this.sync_()},t.VT.CharacterMap.prototype.setOverrides=function(e){this.sync_(e)},t.VT.CharacterMap.prototype.clone=function(){const e=new t.VT.CharacterMap(this.description,this.glmapBase_);return this.glmap_!==this.glmapBase_&&e.setOverrides(this.glmap_),e},t.VT.CharacterMaps=function(){this.maps_=t.VT.CharacterMaps.DefaultMaps,this.mapsBase_=this.maps_},t.VT.CharacterMaps.prototype.getMap=function(e){return this.maps_.hasOwnProperty(e)?this.maps_[e]:void 0},t.VT.CharacterMaps.prototype.addMap=function(e,t){this.maps_===this.mapsBase_&&(this.maps_=Object.assign({},this.mapsBase_)),this.maps_[e]=t},t.VT.CharacterMaps.prototype.reset=function(){this.maps_!==t.VT.CharacterMaps.DefaultMaps&&(this.maps_=t.VT.CharacterMaps.DefaultMaps)},t.VT.CharacterMaps.prototype.setOverrides=function(e){this.maps_===this.mapsBase_&&(this.maps_=Object.assign({},this.mapsBase_));for(const r in e){const o=this.getMap(r);void 0!==o?(this.maps_[r]=o.clone(),this.maps_[r].setOverrides(e[r])):this.addMap(r,new t.VT.CharacterMap("user "+r,e[r]))}},t.VT.CharacterMaps.DefaultMaps={},t.VT.CharacterMaps.DefaultMaps[0]=new t.VT.CharacterMap("graphic",{"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"}),t.VT.CharacterMaps.DefaultMaps.A=new t.VT.CharacterMap("british",{"#":"£"}),t.VT.CharacterMaps.DefaultMaps.B=new t.VT.CharacterMap("us",null),t.VT.CharacterMaps.DefaultMaps[4]=new t.VT.CharacterMap("dutch",{"#":"£","@":"¾","[":"Ĳ","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"}),t.VT.CharacterMaps.DefaultMaps.C=t.VT.CharacterMaps.DefaultMaps[5]=new t.VT.CharacterMap("finnish",{"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"}),t.VT.CharacterMaps.DefaultMaps.R=new t.VT.CharacterMap("french",{"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"}),t.VT.CharacterMaps.DefaultMaps.Q=new t.VT.CharacterMap("french canadian",{"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"}),t.VT.CharacterMaps.DefaultMaps.K=new t.VT.CharacterMap("german",{"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"}),t.VT.CharacterMaps.DefaultMaps.Y=new t.VT.CharacterMap("italian",{"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"}),t.VT.CharacterMaps.DefaultMaps.E=t.VT.CharacterMaps.DefaultMaps[6]=new t.VT.CharacterMap("norwegian/danish",{"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"}),t.VT.CharacterMaps.DefaultMaps.Z=new t.VT.CharacterMap("spanish",{"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"}),t.VT.CharacterMaps.DefaultMaps[7]=t.VT.CharacterMaps.DefaultMaps.H=new t.VT.CharacterMap("swedish",{"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"}),t.VT.CharacterMaps.DefaultMaps["="]=new t.VT.CharacterMap("swiss",{"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"});var m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};!function(e){if("Intl"in e&&"Segmenter"in e.Intl)return;e.Intl=e.Intl||{};const t=["grapheme","word","sentence","line"],r={grapheme:{grapheme:/^(.|\n)/},word:{letter:/^[a-z](?:'?[a-z])*/i,number:/^\d+([,.]\d+)*/},sentence:{terminator:/^[^.?!\r\n]+[.?!]+[\r\n]?/,separator:/^[^.?!\r\n]+[\r\n]?/},line:{hard:/^\S*[\r\n]/,soft:/^\S*\s*/}};function o(e,t){const r={none:0,number:100,letter:200,kana:300,ideo:400,unknown:-1}[e]||0;switch(t){case"character":return;case"word":default:return e;case"sentence":return{0:"terminator",100:"separator"}[r]||e;case"line":return{0:"soft",100:"hard"}[r]||e}}class s{constructor(e,t){this._cur=-1,this._type=void 0,this._breaks=t}[Symbol.iterator](){return this}next(){return this._cur<this._breaks.length&&++this._cur,this._cur>=this._breaks.length?(this._type=void 0,{done:!0,value:void 0}):(this._type=this._breaks[this._cur].breakType,{done:!1,value:{segment:this._breaks[this._cur].segment,breakType:this._breaks[this._cur].breakType}})}following(e=void 0){if(!this._breaks.length)return!0;if(void 0===e)this._cur<this._breaks.length&&++this._cur;else for(this._cur=0;this._cur<this._breaks.length&&this._breaks[this._cur].pos<e;++this._cur);return this._type=this._cur<this._breaks.length?this._breaks[this._cur].breakType:void 0,this._cur+1>=this._breaks.length}preceding(e=void 0){if(!this._breaks.length)return!0;if(void 0===e)this._cur>=this._breaks.length&&--this._cur,this._cur>=0&&--this._cur;else for(this._cur=this._breaks.length-1;this._cur>=0&&this._breaks[this._cur].pos>=e;--this._cur);return this._type=this._cur+1>=this._breaks.length?void 0:this._breaks[this._cur+1].breakType,this._cur<0}get position(){return this._cur<0||!this._breaks.length?0:this._cur>=this._breaks.length?this._breaks[this._breaks.length-1].pos:this._breaks[this._cur].pos}get breakType(){return this._type}}e.Intl.Segmenter=class{constructor(e,{localeMatcher:r,granularity:o="grapheme"}={}){this._locale=Array.isArray(e)?e.map((e=>String(e))):String(e||navigator.language),this._granularity=t.includes(o)?o:"grapheme"}segment(t){return new s(t,function(t,s,i){const n=[];if("v8BreakIterator"in e.Intl){"grapheme"===s&&(s="character");const r=new e.Intl.v8BreakIterator(t,{type:s});r.adoptText(i);let a=0,l=r.next();for(;-1!==l;)n.push({pos:r.current(),segment:i.slice(a,l),breakType:o(r.breakType(),s)}),a=l,l=r.next()}else{const e=r[s];let t=0;for(;t<i.length;){let r=!1;for(const o of Object.keys(e)){const a=e[o],l=i.slice(t).match(a);if(l){t+=l[0].length,n.push({pos:t,segment:l[0],breakType:"grapheme"===s?void 0:o}),r=!0;break}}r||n.push({pos:t+1,segment:i.slice(t,++t),breakType:"none"})}}return n}(this._locale,this._granularity,t))}}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==m?m:{}),t.wc={},t.wc.nulWidth=0,t.wc.controlWidth=0,t.wc.regardCjkAmbiguous=!1,t.wc.cjkAmbiguousWidth=2,t.wc.combining=[[173,173],[768,879],[1155,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1552,1562],[1564,1564],[1611,1631],[1648,1648],[1750,1756],[1759,1764],[1767,1768],[1770,1773],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2045,2045],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2200,2207],[2250,2273],[2275,2306],[2362,2362],[2364,2364],[2369,2376],[2381,2381],[2385,2391],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2558,2558],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2641,2641],[2672,2673],[2677,2677],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2810,2815],[2817,2817],[2876,2876],[2879,2879],[2881,2884],[2893,2893],[2901,2902],[2914,2915],[2946,2946],[3008,3008],[3021,3021],[3072,3072],[3076,3076],[3132,3132],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3201],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],[3405,3405],[3426,3427],[3457,3457],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3772],[3784,3790],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],[4226,4226],[4229,4230],[4237,4237],[4253,4253],[4448,4607],[4957,4959],[5906,5908],[5938,5939],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6159],[6277,6278],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6683,6683],[6742,6742],[6744,6750],[6752,6752],[6754,6754],[6757,6764],[6771,6780],[6783,6783],[6832,6862],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],[7142,7142],[7144,7145],[7149,7149],[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],[7405,7405],[7412,7412],[7416,7417],[7616,7679],[8203,8207],[8234,8238],[8288,8292],[8294,8303],[8400,8432],[11503,11505],[11647,11647],[11744,11775],[12330,12333],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],[43010,43010],[43014,43014],[43019,43019],[43045,43046],[43052,43052],[43204,43205],[43232,43249],[43263,43263],[43302,43309],[43335,43345],[43392,43394],[43443,43443],[43446,43449],[43452,43453],[43493,43493],[43561,43566],[43569,43570],[43573,43574],[43587,43587],[43596,43596],[43644,43644],[43696,43696],[43698,43700],[43703,43704],[43710,43711],[43713,43713],[43756,43757],[43766,43766],[44005,44005],[44008,44008],[44013,44013],[64286,64286],[65024,65039],[65056,65071],[65279,65279],[65529,65531],[66045,66045],[66272,66272],[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[68325,68326],[68900,68903],[69291,69292],[69373,69375],[69446,69456],[69506,69509],[69633,69633],[69688,69702],[69744,69744],[69747,69748],[69759,69761],[69811,69814],[69817,69818],[69826,69826],[69888,69890],[69927,69931],[69933,69940],[70003,70003],[70016,70017],[70070,70078],[70089,70092],[70095,70095],[70191,70193],[70196,70196],[70198,70199],[70206,70206],[70209,70209],[70367,70367],[70371,70378],[70400,70401],[70459,70460],[70464,70464],[70502,70508],[70512,70516],[70712,70719],[70722,70724],[70726,70726],[70750,70750],[70835,70840],[70842,70842],[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],[71229,71229],[71231,71232],[71339,71339],[71341,71341],[71344,71349],[71351,71351],[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[71995,71996],[71998,71998],[72003,72003],[72148,72151],[72154,72155],[72160,72160],[72193,72202],[72243,72248],[72251,72254],[72263,72263],[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],[72767,72767],[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],[73018,73018],[73020,73021],[73023,73029],[73031,73031],[73104,73105],[73109,73109],[73111,73111],[73459,73460],[73472,73473],[73526,73530],[73536,73536],[73538,73538],[78896,78912],[78919,78933],[92912,92916],[92976,92982],[94031,94031],[94095,94098],[94180,94180],[113821,113822],[113824,113827],[118528,118573],[118576,118598],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],[121461,121461],[121476,121476],[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[123023,123023],[123184,123190],[123566,123566],[123628,123631],[124140,124143],[125136,125142],[125252,125258],[917505,917505],[917536,917631],[917760,917999]],t.wc.ambiguous=[[161,161],[164,164],[167,168],[170,170],[173,174],[176,180],[182,186],[188,191],[198,198],[208,208],[215,216],[222,225],[230,230],[232,234],[236,237],[240,240],[242,243],[247,250],[252,252],[254,254],[257,257],[273,273],[275,275],[283,283],[294,295],[299,299],[305,307],[312,312],[319,322],[324,324],[328,331],[333,333],[338,339],[358,359],[363,363],[462,462],[464,464],[466,466],[468,468],[470,470],[472,472],[474,474],[476,476],[593,593],[609,609],[708,708],[711,711],[713,715],[717,717],[720,720],[728,731],[733,733],[735,735],[768,879],[913,929],[931,937],[945,961],[963,969],[1025,1025],[1040,1103],[1105,1105],[4352,4447],[8208,8208],[8211,8214],[8216,8217],[8220,8221],[8224,8226],[8228,8231],[8240,8240],[8242,8243],[8245,8245],[8251,8251],[8254,8254],[8308,8308],[8319,8319],[8321,8324],[8364,8364],[8451,8451],[8453,8453],[8457,8457],[8467,8467],[8470,8470],[8481,8482],[8486,8486],[8491,8491],[8531,8532],[8539,8542],[8544,8555],[8560,8569],[8585,8585],[8592,8601],[8632,8633],[8658,8658],[8660,8660],[8679,8679],[8704,8704],[8706,8707],[8711,8712],[8715,8715],[8719,8719],[8721,8721],[8725,8725],[8730,8730],[8733,8736],[8739,8739],[8741,8741],[8743,8748],[8750,8750],[8756,8759],[8764,8765],[8776,8776],[8780,8780],[8786,8786],[8800,8801],[8804,8807],[8810,8811],[8814,8815],[8834,8835],[8838,8839],[8853,8853],[8857,8857],[8869,8869],[8895,8895],[8978,8978],[8986,8987],[9001,9002],[9193,9196],[9200,9200],[9203,9203],[9312,9449],[9451,9547],[9552,9587],[9600,9615],[9618,9621],[9632,9633],[9635,9641],[9650,9651],[9654,9655],[9660,9661],[9664,9665],[9670,9672],[9675,9675],[9678,9681],[9698,9701],[9711,9711],[9725,9726],[9733,9734],[9737,9737],[9742,9743],[9748,9749],[9756,9756],[9758,9758],[9792,9792],[9794,9794],[9800,9811],[9824,9825],[9827,9829],[9831,9834],[9836,9837],[9839,9839],[9855,9855],[9875,9875],[9886,9887],[9889,9889],[9898,9899],[9917,9919],[9924,9953],[9955,9955],[9960,9983],[9989,9989],[9994,9995],[10024,10024],[10045,10045],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10102,10111],[10133,10135],[10160,10160],[10175,10175],[11035,11036],[11088,11088],[11093,11097],[11904,12255],[12272,12350],[12352,19903],[19968,42191],[43360,43391],[44032,55203],[57344,64255],[65024,65049],[65072,65135],[65281,65376],[65504,65510],[65533,65533],[94176,94180],[94192,94193],[94208,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110895],[110898,110898],[110928,110930],[110933,110933],[110948,110951],[110960,111359],[126980,126980],[127183,127183],[127232,127242],[127248,127277],[127280,127337],[127344,127404],[127488,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],[127988,127988],[127992,128062],[128064,128064],[128066,128252],[128255,128317],[128331,128334],[128336,128359],[128378,128378],[128405,128406],[128420,128420],[128507,128591],[128640,128709],[128716,128716],[128720,128722],[128725,128727],[128732,128735],[128747,128748],[128756,128764],[128992,129003],[129008,129008],[129292,129338],[129340,129349],[129351,129535],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[131072,196605],[196608,262141],[917760,917999],[983040,1048573],[1048576,1114109]],t.wc.unambiguous=[[4352,4447],[8986,8987],[9001,9002],[9193,9196],[9200,9200],[9203,9203],[9725,9726],[9748,9749],[9800,9811],[9855,9855],[9875,9875],[9889,9889],[9898,9899],[9917,9918],[9924,9925],[9934,9934],[9940,9940],[9962,9962],[9970,9971],[9973,9973],[9978,9978],[9981,9981],[9989,9989],[9994,9995],[10024,10024],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10133,10135],[10160,10160],[10175,10175],[11035,11036],[11088,11088],[11093,11093],[11904,12255],[12272,12350],[12352,12871],[12880,19903],[19968,42191],[43360,43391],[44032,55203],[63744,64255],[65040,65049],[65072,65135],[65281,65376],[65504,65510],[94176,94180],[94192,94193],[94208,101589],[101632,101640],[110576,110579],[110581,110587],[110589,110590],[110592,110895],[110898,110898],[110928,110930],[110933,110933],[110948,110951],[110960,111359],[126980,126980],[127183,127183],[127374,127374],[127377,127386],[127488,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],[127988,127988],[127992,128062],[128064,128064],[128066,128252],[128255,128317],[128331,128334],[128336,128359],[128378,128378],[128405,128406],[128420,128420],[128507,128591],[128640,128709],[128716,128716],[128720,128722],[128725,128727],[128732,128735],[128747,128748],[128756,128764],[128992,129003],[129008,129008],[129292,129338],[129340,129349],[129351,129535],[129648,129660],[129664,129672],[129680,129725],[129727,129733],[129742,129755],[129760,129768],[129776,129784],[131072,196605],[196608,262141]],t.wc.binaryTableSearch_=function(e,t){let r,o=0,s=t.length-1;if(e<t[o][0]||e>t[s][1])return!1;for(;s>=o;)if(r=Math.floor((o+s)/2),e>t[r][1])o=r+1;else{if(!(e<t[r][0]))return!0;s=r-1}return!1},t.wc.isSpace=function(e){return t.wc.binaryTableSearch_(e,t.wc.combining)},t.wc.isCjkAmbiguous=function(e){return t.wc.binaryTableSearch_(e,t.wc.ambiguous)},t.wc.charWidth=function(e){return t.wc.regardCjkAmbiguous?t.wc.charWidthRegardAmbiguous(e):t.wc.charWidthDisregardAmbiguous(e)},t.wc.charWidthDisregardAmbiguous=function(e){return e<127?e>=32?1:0==e?t.wc.nulWidth:t.wc.controlWidth:e<160?t.wc.controlWidth:t.wc.isSpace(e)?0:t.wc.binaryTableSearch_(e,t.wc.unambiguous)?2:1},t.wc.charWidthRegardAmbiguous=function(e){return t.wc.isCjkAmbiguous(e)?t.wc.cjkAmbiguousWidth:t.wc.charWidthDisregardAmbiguous(e)},t.wc.strWidth=function(e){let r=0;for(let o=0;o<e.length;){const s=e.codePointAt(o),i=t.wc.charWidth(s);if(i<0)return-1;r+=i,o+=s<=65535?1:2}return r},t.wc.substr=function(e,r,o=void 0){let s=0;if(r)for(let o=0;s<e.length;){const i=e.codePointAt(s);if(o+=t.wc.charWidth(i),o>r)break;s+=i<=65535?1:2}if(void 0!==o){let r=s;for(let s=0;r<e.length;){const i=e.codePointAt(r);if(s+=t.wc.charWidth(i),s>o)break;r+=i<=65535?1:2}return e.substring(s,r)}return e.substr(s)},t.wc.substring=function(e,r,o){return t.wc.substr(e,r,o-r)};export{t as hterm};
